<!doctype html>
<html lang="ro">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Raluca Korean ‚Äî Exerci»õii</title>

<style>
:root{
  --bg:#070617;
  --card: rgba(16,14,40,.75);
  --stroke: rgba(255,255,255,.12);
  --text:#f3f4ff;
  --muted: rgba(243,244,255,.7);
  --accent:#7c3aed;
  --accent2:#22d3ee;
  --good:#22c55e;
  --bad:#ef4444;
  --radius:22px;
  --shadow:0 18px 50px rgba(0,0,0,.45);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(135deg,#090818,#071425);
  color:var(--text);
}

.app{max-width:1000px;margin:0 auto;padding:20px}
.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--radius);
  padding:18px;
  margin-bottom:18px;
  box-shadow:var(--shadow);
}

h1,h2,h3{margin:0 0 10px}
h1{font-size:24px}
h2{font-size:20px}
h3{font-size:16px}
.sub{color:var(--muted);font-size:13px}

.grid{
  display:grid;
  grid-template-columns:320px 1fr;
  gap:16px;
}
@media(max-width:820px){ .grid{grid-template-columns:1fr} }

.badge{
  display:inline-block;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(124,58,237,.15);
  border:1px solid rgba(124,58,237,.35);
  font-weight:900;
  font-size:12px;
}

.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{
  padding:8px 10px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:rgba(10,8,28,.55);
  cursor:pointer;
  font-weight:800;
  font-size:12px;
}
.pill.active{
  background:rgba(34,211,238,.12);
  border-color:rgba(34,211,238,.35);
}

.btn{
  padding:10px 16px;
  border-radius:999px;
  border:none;
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  font-weight:900;
  cursor:pointer;
  color:var(--text);
}
.btn.ghost{
  background:transparent;
  border:1px solid var(--stroke);
}
.btn.small{padding:8px 12px;font-size:12px}

.qbox{
  background:rgba(10,8,28,.55);
  border:1px solid var(--stroke);
  border-radius:16px;
  padding:14px;
}
.qTitle{font-weight:950;font-size:18px;margin-bottom:6px}
.qHint{color:var(--muted);font-size:13px;margin-bottom:10px}

.opts{display:grid;gap:10px;margin-top:12px}
.opt{
  padding:12px 12px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:rgba(10,8,28,.55);
  cursor:pointer;
  font-weight:850;
  transition:.12s;
}
.opt:hover{border-color:rgba(34,211,238,.35)}
.opt.correct{border-color:rgba(34,197,94,.65); background:rgba(34,197,94,.12)}
.opt.wrong{border-color:rgba(239,68,68,.65); background:rgba(239,68,68,.12)}
.opt.disabled{opacity:.65;cursor:not-allowed}

.hr{height:1px;background:rgba(255,255,255,.08);margin:14px 0}

.kv{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center}
.kv .k{color:var(--muted);font-size:12px}
.kv .v{font-weight:900}

.toast{
  margin-top:12px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:rgba(10,8,28,.55);
  color:var(--muted);
  font-size:13px;
}
.toast.good{border-color:rgba(34,197,94,.55); color:rgba(232,255,241,.92)}
.toast.bad{border-color:rgba(239,68,68,.55); color:rgba(255,235,235,.92)}
</style>
</head>

<body>
<div class="app">

  <!-- HEADER -->
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <div>
        <h1>Exerci»õii</h1>
        <div class="sub" id="subtitle">Se √ÆncarcƒÉ‚Ä¶</div>
      </div>
      <div class="row">
        <button class="btn ghost small" onclick="goBack()">‚Üê √énapoi la lec»õii</button>
      </div>
    </div>

    <div class="hr"></div>

    <div class="row">
      <span class="badge" id="lessonBadge">TOPIK</span>

      <div class="pill active" id="modeKORO" onclick="setMode('KO-RO')">KO ‚Üí RO</div>
      <div class="pill" id="modeROKO" onclick="setMode('RO-KO')">RO ‚Üí KO</div>

      <button class="btn ghost small" onclick="toggleShuffle()" id="shuffleBtn">Shuffle: OFF</button>
      <button class="btn ghost small" onclick="restart()">Restart</button>
    </div>
  </div>

  <div class="grid">

    <!-- LEFT / STATS -->
    <div class="card">
      <h3>Status</h3>
      <div class="kv"><div class="k">Lec»õie</div><div class="v" id="lessonTitle">‚Äî</div></div>
      <div class="kv"><div class="k">Exerci»õii disponibile</div><div class="v" id="totalEx">0</div></div>
      <div class="kv"><div class="k">Progres</div><div class="v" id="progress">0 / 0</div></div>
      <div class="kv"><div class="k">Scor</div><div class="v" id="score">0</div></div>

      <div class="hr"></div>

      <div class="sub" style="line-height:1.4">
        Filtrare automatƒÉ dupƒÉ lec»õia din URL:<br>
        <b>?lesson=T1-01</b> etc.
      </div>

      <div class="hr"></div>

      <div class="row">
        <button class="btn" onclick="next()" id="nextBtn">UrmƒÉtorul ‚Üí</button>
      </div>
    </div>

    <!-- RIGHT / QUESTION -->
    <div class="card">
      <div class="qbox">
        <div class="qHint" id="qHint">‚Äî</div>
        <div class="qTitle" id="qText">Se √ÆncarcƒÉ‚Ä¶</div>

        <div class="opts" id="opts"></div>

        <div id="feedback" class="toast" style="display:none"></div>
      </div>
    </div>

  </div>
</div>

<script>
/* =========================
   HELPERS URL
========================= */
function getParam(name){
  return new URLSearchParams(window.location.search).get(name);
}
function goBack(){
  window.location.href = "lessons.html";
}

/* =========================
   LEC»öII (acela»ôi mapping ca √Æn lessons.html)
========================= */
const LESSON_CONTENT = {
  "T1-01":{ topik:1, title:"ÏùÄ / Îäî ‚Äî topic" },
  "T1-02":{ topik:1, title:"Ïù¥ / Í∞Ä ‚Äî subiect" },
  "T2-01":{ topik:2, title:"-(Ïúº)Î†§Í≥† ÌïòÎã§ ‚Äî inten»õie" },
  "T3-01":{ topik:3, title:"-ÏïÑ/Ïñ¥ÏÑú ‚Äî cauzƒÉ" },
  "T4-01":{ topik:4, title:"-(Ïúº)„Ñ¥/Îäî Í≤É Í∞ôÎã§ ‚Äî opinie" }
};

/* =========================
   DATA EXERCI»öII (EXEMPLU COMPLET + EXTENSIBIL)
   StructurƒÉ:
   { id, lessonId, dir:"KO-RO"|"RO-KO", q, opts:[...], a }
========================= */
const EXERCISES = [
  // -------- T1-01 (topic) ‚Äî KO‚ÜíRO
  {id:"E-T1-01-001", lessonId:"T1-01", dir:"KO-RO", q:"Ï†ÄÎäî ÌöåÏÇ¨ÏõêÏù¥ÏóêÏöî.", opts:["Sunt angajat.","Sunt student.","Sunt profesor."], a:"Sunt angajat."},
  {id:"E-T1-01-002", lessonId:"T1-01", dir:"KO-RO", q:"Ïò§ÎäòÏùÄ Î∞îÎπ†Ïöî.", opts:["AstƒÉzi sunt ocupat.","AstƒÉzi sunt liber.","AstƒÉzi sunt bolnav."], a:"AstƒÉzi sunt ocupat."},
  {id:"E-T1-01-003", lessonId:"T1-01", dir:"KO-RO", q:"Ï£ºÎßêÏóêÎäî Ïâ¨Ïñ¥Ïöî.", opts:["MƒÉ odihnesc √Æn weekend.","Lucrez √Æn weekend.","CƒÉlƒÉtoresc zilnic."], a:"MƒÉ odihnesc √Æn weekend."},
  {id:"E-T1-01-004", lessonId:"T1-01", dir:"KO-RO", q:"Ï†ÄÎÖÅÏóê ÏÇ∞Ï±ÖÌï¥Ïöî.", opts:["MƒÉ plimb seara.","Dorm seara.","Lucrez toatƒÉ seara."], a:"MƒÉ plimb seara."},
  {id:"E-T1-01-005", lessonId:"T1-01", dir:"KO-RO", q:"ÏßëÏóêÏÑú Ïâ¨Ïñ¥Ïöî.", opts:["MƒÉ odihnesc acasƒÉ.","Lucrez acasƒÉ.","Studiez afarƒÉ."], a:"MƒÉ odihnesc acasƒÉ."},

  // -------- T1-02 (subject) ‚Äî KO‚ÜíRO
  {id:"E-T1-02-001", lessonId:"T1-02", dir:"KO-RO", q:"ÎπÑÍ∞Ä ÏôÄÏöî.", opts:["PlouƒÉ.","Ninge.","Este foarte cald."], a:"PlouƒÉ."},
  {id:"E-T1-02-002", lessonId:"T1-02", dir:"KO-RO", q:"ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥Ïöî.", opts:["Nu am timp.","Am mult timp.","Sunt √Æn vacan»õƒÉ."], a:"Nu am timp."},
  {id:"E-T1-02-003", lessonId:"T1-02", dir:"KO-RO", q:"Î∞ñÏóê ÏÇ¨ÎûåÏù¥ ÎßéÏïÑÏöî.", opts:["Sunt mul»õi oameni afarƒÉ.","Nu este nimeni.","Este foarte lini»ôte."], a:"Sunt mul»õi oameni afarƒÉ."},
  {id:"E-T1-02-004", lessonId:"T1-02", dir:"KO-RO", q:"ÌöåÏùòÍ∞Ä ÏûàÏñ¥Ïöî.", opts:["Este o »ôedin»õƒÉ.","Este o petrecere.","Este o pauzƒÉ."], a:"Este o »ôedin»õƒÉ."},
  {id:"E-T1-02-005", lessonId:"T1-02", dir:"KO-RO", q:"Ï°∞Í∏à ÌîºÍ≥§Ìï¥Ïöî.", opts:["Sunt pu»õin obosit.","Sunt foarte energic.","Sunt bolnav."], a:"Sunt pu»õin obosit."},

  // -------- T3-01 (cauzƒÉ ÏïÑ/Ïñ¥ÏÑú) ‚Äî KO‚ÜíRO
  {id:"E-T3-01-001", lessonId:"T3-01", dir:"KO-RO", q:"ÎπÑÍ∞Ä ÏôÄÏÑú ÏïΩÏÜçÏóê Îä¶ÏóàÏñ¥Ïöî.", opts:[
    "Am √Ænt√¢rziat la √Ænt√¢lnire pentru cƒÉ a plouat.",
    "Am √Ænt√¢rziat la √Ænt√¢lnire de»ôi ploua.",
    "Am ajuns la timp pentru cƒÉ ploaia s-a oprit."
  ], a:"Am √Ænt√¢rziat la √Ænt√¢lnire pentru cƒÉ a plouat."},
  {id:"E-T3-01-002", lessonId:"T3-01", dir:"KO-RO", q:"ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥ÏÑú ÌÉùÏãúÎ•º ÌÉîÏñ¥Ïöî.", opts:[
    "Am luat taxiul pentru cƒÉ nu aveam timp.",
    "Am luat taxiul de»ôi aveam timp.",
    "Nu am luat taxiul pentru cƒÉ aveam timp."
  ], a:"Am luat taxiul pentru cƒÉ nu aveam timp."},
  {id:"E-T3-01-003", lessonId:"T3-01", dir:"KO-RO", q:"ÏïÑÌååÏÑú Î≥ëÏõêÏóê Í∞îÏñ¥Ïöî.", opts:[
    "Am mers la spital pentru cƒÉ eram bolnav.",
    "Am mers la serviciu.",
    "Nu m-am sim»õit rƒÉu."
  ], a:"Am mers la spital pentru cƒÉ eram bolnav."},

  // -------- RO‚ÜíKO (exemple) ‚Äî legate de lec»õii
  // T1-01 (topic)
  {id:"E-T1-01-RK-001", lessonId:"T1-01", dir:"RO-KO", q:"Eu sunt student.", opts:["Ï†ÄÎäî ÌïôÏÉùÏù¥ÏóêÏöî.","Ï†ÄÎäî ÏÑ†ÏÉùÎãòÏù¥ÏóêÏöî.","Ï†ÄÎäî ÌöåÏÇ¨ÏõêÏù¥ÏóêÏöî."], a:"Ï†ÄÎäî ÌïôÏÉùÏù¥ÏóêÏöî."},
  {id:"E-T1-01-RK-002", lessonId:"T1-01", dir:"RO-KO", q:"AstƒÉzi sunt ocupat.", opts:["Ïò§ÎäòÏùÄ Î∞îÎπ†Ïöî.","Ïò§ÎäòÏùÄ Ï¢ãÏïÑÏöî.","Ïò§ÎäòÏùÄ ÎπÑÍ∞Ä ÏôÄÏöî."], a:"Ïò§ÎäòÏùÄ Î∞îÎπ†Ïöî."},

  // T1-02 (subject)
  {id:"E-T1-02-RK-001", lessonId:"T1-02", dir:"RO-KO", q:"PlouƒÉ.", opts:["ÎπÑÍ∞Ä ÏôÄÏöî.","ÎààÏù¥ ÏôÄÏöî.","Î∞îÎπ†Ïöî."], a:"ÎπÑÍ∞Ä ÏôÄÏöî."},
  {id:"E-T1-02-RK-002", lessonId:"T1-02", dir:"RO-KO", q:"Nu am timp.", opts:["ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥Ïöî.","ÏãúÍ∞ÑÏù¥ ÎßéÏïÑÏöî.","Ï†ÄÎäî ÌïôÏÉùÏù¥ÏóêÏöî."], a:"ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥Ïöî."},

  // T3-01 (cauzƒÉ)
  {id:"E-T3-01-RK-001", lessonId:"T3-01", dir:"RO-KO", q:"Am √Ænt√¢rziat pentru cƒÉ a plouat.", opts:[
    "ÎπÑÍ∞Ä ÏôÄÏÑú Îä¶ÏóàÏñ¥Ïöî.",
    "ÎπÑÍ∞Ä Ïò§ÏßÄÎßå Îä¶ÏóàÏñ¥Ïöî.",
    "ÎπÑÍ∞Ä ÏôÄÏÑú ÏùºÏ∞ç ÏôîÏñ¥Ïöî."
  ], a:"ÎπÑÍ∞Ä ÏôÄÏÑú Îä¶ÏóàÏñ¥Ïöî."},
  {id:"E-T3-01-RK-002", lessonId:"T3-01", dir:"RO-KO", q:"Am luat taxiul pentru cƒÉ nu aveam timp.", opts:[
    "ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥ÏÑú ÌÉùÏãúÎ•º ÌÉîÏñ¥Ïöî.",
    "ÏãúÍ∞ÑÏù¥ ÏûàÏñ¥ÏÑú ÌÉùÏãúÎ•º ÌÉîÏñ¥Ïöî.",
    "ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥ÏÑú Í±∏ÏóàÏñ¥Ïöî."
  ], a:"ÏãúÍ∞ÑÏù¥ ÏóÜÏñ¥ÏÑú ÌÉùÏãúÎ•º ÌÉîÏñ¥Ïöî."}
];

/* =========================
   STATE
========================= */
let mode = "KO-RO";          // "KO-RO" | "RO-KO"
let shuffleOn = false;
let lessonId = getParam("lesson") || ""; // ex: T1-01
let pool = [];               // filtered exercises
let index = 0;
let locked = false;
let score = 0;

/* =========================
   DOM
========================= */
const subtitleEl = document.getElementById("subtitle");
const badgeEl = document.getElementById("lessonBadge");
const lessonTitleEl = document.getElementById("lessonTitle");
const totalExEl = document.getElementById("totalEx");
const progressEl = document.getElementById("progress");
const scoreEl = document.getElementById("score");
const qHintEl = document.getElementById("qHint");
const qTextEl = document.getElementById("qText");
const optsEl = document.getElementById("opts");
const feedbackEl = document.getElementById("feedback");
const modeKOROEl = document.getElementById("modeKORO");
const modeROKOEl = document.getElementById("modeROKO");
const shuffleBtn = document.getElementById("shuffleBtn");
const nextBtn = document.getElementById("nextBtn");

/* =========================
   CORE
========================= */
function setMode(newMode){
  mode = newMode;
  modeKOROEl.classList.toggle("active", mode==="KO-RO");
  modeROKOEl.classList.toggle("active", mode==="RO-KO");
  restart();
}

function toggleShuffle(){
  shuffleOn = !shuffleOn;
  shuffleBtn.textContent = `Shuffle: ${shuffleOn ? "ON" : "OFF"}`;
  restart();
}

function restart(){
  score = 0;
  index = 0;
  locked = false;
  feedbackEl.style.display = "none";
  buildPool();
  if (shuffleOn) pool = shuffle(pool);
  render();
}

function buildPool(){
  // FiltreazƒÉ dupƒÉ lec»õie (dacƒÉ existƒÉ) + direc»õie
  let arr = EXERCISES.filter(x => x.dir === mode);

  if (lessonId){
    arr = arr.filter(x => x.lessonId === lessonId);
  }

  pool = arr;
}

function renderHeader(){
  const l = LESSON_CONTENT[lessonId] || null;

  if (lessonId && l){
    subtitleEl.textContent = `Lec»õie selectatƒÉ: ${lessonId} ‚Ä¢ ${l.title} ‚Ä¢ Mod: ${mode}`;
    badgeEl.textContent = `TOPIK ${l.topik}`;
    lessonTitleEl.textContent = `${lessonId} ¬∑ ${l.title}`;
  }else if (lessonId && !l){
    subtitleEl.textContent = `Lec»õie: ${lessonId} (necunoscutƒÉ) ‚Ä¢ Mod: ${mode}`;
    badgeEl.textContent = `TOPIK`;
    lessonTitleEl.textContent = lessonId;
  }else{
    subtitleEl.textContent = `Toate lec»õiile ‚Ä¢ Mod: ${mode}`;
    badgeEl.textContent = `TOPIK`;
    lessonTitleEl.textContent = "Toate";
  }

  totalExEl.textContent = String(pool.length);
  progressEl.textContent = `${Math.min(index+1, pool.length)} / ${pool.length}`;
  scoreEl.textContent = String(score);
}

function render(){
  buildPool();
  renderHeader();

  if (!pool.length){
    qHintEl.textContent = "Nu existƒÉ exerci»õii pentru acest filtru.";
    qTextEl.textContent = "AdaugƒÉ exerci»õii √Æn EXERCISES pentru aceastƒÉ lec»õie/mod.";
    optsEl.innerHTML = "";
    nextBtn.disabled = true;
    nextBtn.classList.add("disabled");
    return;
  }

  if (index >= pool.length) index = pool.length - 1;

  const ex = pool[index];
  locked = false;

  feedbackEl.style.display = "none";
  feedbackEl.className = "toast";
  feedbackEl.textContent = "";

  qHintEl.textContent = mode === "KO-RO" ? "Alege traducerea corectƒÉ (KO ‚Üí RO)" : "Alege varianta corectƒÉ (RO ‚Üí KO)";
  qTextEl.textContent = ex.q;

  optsEl.innerHTML = "";
  ex.opts.forEach(opt=>{
    const b = document.createElement("div");
    b.className = "opt";
    b.textContent = opt;
    b.onclick = ()=>choose(opt);
    optsEl.appendChild(b);
  });

  nextBtn.disabled = true;
  nextBtn.style.opacity = 0.6;

  renderHeader();
}

function choose(selected){
  if (locked) return;
  locked = true;

  const ex = pool[index];
  const isCorrect = (selected === ex.a);

  // mark options
  [...optsEl.children].forEach(el=>{
    const t = el.textContent;
    el.classList.add("disabled");
    if (t === ex.a) el.classList.add("correct");
    if (t === selected && !isCorrect) el.classList.add("wrong");
  });

  if (isCorrect){
    score += 1;
    feedbackEl.style.display = "block";
    feedbackEl.className = "toast good";
    feedbackEl.textContent = "Corect ‚úÖ";
  }else{
    feedbackEl.style.display = "block";
    feedbackEl.className = "toast bad";
    feedbackEl.textContent = `Gre»ôit ‚ùå Corect este: ${ex.a}`;
  }

  nextBtn.disabled = false;
  nextBtn.style.opacity = 1;

  renderHeader();
}

function next(){
  if (!pool.length) return;

  // dacƒÉ nu a rƒÉspuns √ÆncƒÉ, nu avanseazƒÉ
  if (!locked) return;

  index += 1;

  if (index >= pool.length){
    // final
    qHintEl.textContent = "Gata üéâ";
    qTextEl.textContent = `Ai terminat setul. Scor: ${score} / ${pool.length}`;
    optsEl.innerHTML = "";
    feedbackEl.style.display = "block";
    feedbackEl.className = "toast";
    feedbackEl.textContent = "ApasƒÉ Restart pentru a relua (sau schimbƒÉ modul / shuffle).";
    nextBtn.disabled = true;
    nextBtn.style.opacity = 0.6;
    renderHeader();
    return;
  }

  render();
}

/* =========================
   UTILS
========================= */
function shuffle(arr){
  const a = arr.slice();
  for (let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

/* =========================
   INIT
========================= */
(function init(){
  // set pills
  modeKOROEl.classList.toggle("active", mode==="KO-RO");
  modeROKOEl.classList.toggle("active", mode==="RO-KO");
  shuffleBtn.textContent = `Shuffle: ${shuffleOn ? "ON" : "OFF"}`;

  // dacƒÉ vine din lessons.html -> avem lesson param
  // default: KO-RO
  restart();
})();
</script>
</body>
</html>
