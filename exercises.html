<!doctype html>
<html lang="ro">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Raluca Korean ‚Äî Exercises</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:#f7f3ff;
  color:#1b1630;
}
.app{
  max-width:900px;
  margin:0 auto;
  padding:16px;
}
.header{
  background:#fff;
  border-radius:18px;
  padding:16px;
  box-shadow:0 12px 30px rgba(0,0,0,.1);
  margin-bottom:16px;
}
.header h1{margin:0;font-size:20px}
.header p{margin:4px 0 0;font-size:13px;color:#666}

.exercise-type{
  background:#fff;
  border-radius:18px;
  padding:16px;
  box-shadow:0 12px 30px rgba(0,0,0,.1);
  margin-bottom:16px;
}
.exercise-type label{font-weight:700;font-size:14px}
select{
  width:100%;
  margin-top:8px;
  padding:10px;
  font-size:15px;
  border-radius:12px;
  border:1px solid #ccc;
}

.exercise-card{
  background:#fff;
  border-radius:18px;
  padding:18px;
  box-shadow:0 12px 30px rgba(0,0,0,.1);
}
.question{
  font-size:22px;
  font-weight:800;
  margin-bottom:6px;
}
.sub{
  font-size:13px;
  color:#666;
  margin-bottom:16px;
}
.answers{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
  margin-bottom:16px;
}

.answer{
  padding: 10px 14px;
  border-radius: 14px;
  border: 1px solid #ddd;
  background: #fff;
  cursor: pointer;
  transition: 0.15s ease;
  font-weight:800;
  text-align:left;
}

/* üîµ SELECTAT */
.answer.selected {
  background: #e8ddff;
  border-color: #9b7cff;
  box-shadow: 0 0 0 3px rgba(155,124,255,0.25);
}

/* ‚úÖ CORECT */
.answer.correct {
  background: #d4f7d4;
  border-color: #4caf50;
}

/* ‚ùå GRE»òIT */
.answer.wrong {
  background: #ffd6d6;
  border-color: #e53935;
}

.answer:disabled{
  opacity:.95;
  cursor:default;
}

.feedback{
  min-height:28px;
  font-weight:800;
  margin-bottom:12px;
  white-space:pre-line;
}
.controls{
  display:flex;
  gap:10px;
}
button{
  padding:10px 14px;
  border-radius:999px;
  border:1px solid #ccc;
  background:#fff;
  font-weight:900;
  cursor:pointer;
}
.primary{
  background:#8b5cf6;
  color:#fff;
  border:none;
}
</style>
</head>

<body>
<div class="app">

  <div class="header">
    <h1>Exerci»õii TOPIK</h1>
    <p id="subheader">Tip 1 ¬∑ CoreeanƒÉ ‚Üí Rom√¢nƒÉ</p>
  </div>

  <div class="exercise-type">
    <label>Tip exerci»õiu</label>
    <select disabled>
      <option>KO ‚Üí RO (Quiz)</option>
    </select>
  </div>

  <div class="exercise-card">
    <div class="question" id="question">‚Äî</div>
    <div class="sub">Alege traducerea corectƒÉ</div>

    <div class="answers" id="answers"></div>

    <div class="feedback" id="feedback"></div>

    <div class="controls">
      <button class="primary" id="checkBtn">VerificƒÉ</button>
      <button id="nextBtn">√éntrebare nouƒÉ</button>
    </div>
  </div>

</div>

<script>
/* ===========================
   TIP 1: KO ‚Üí RO QUIZ
   - compatibil 1:1 cu HTML-ul tƒÉu (question/answers/feedback/checkBtn/nextBtn)
   - folose»ôte window.TOPIK4_QUIZ_500 dacƒÉ existƒÉ
   =========================== */

(function(){
  const questionEl = document.getElementById("question");
  const answersEl  = document.getElementById("answers");
  const feedbackEl = document.getElementById("feedback");
  const checkBtn   = document.getElementById("checkBtn");
  const nextBtn    = document.getElementById("nextBtn");
  const subheader  = document.getElementById("subheader");

  // Fallback minimal dacƒÉ nu existƒÉ banca globalƒÉ
  const FALLBACK = [
    { ko:"Ï†ÄÎäî ÌïôÍµêÏóê Í∞ÄÏöî.", ro:"Eu merg la »ôcoalƒÉ." },
    { ko:"Ïò§Îäò Ïª§ÌîºÎ•º ÎßàÏÖîÏöî.", ro:"Azi beau cafea." },
    { ko:"ÏßÄÍ∏à ÌïúÍµ≠Ïñ¥Î•º Í≥µÎ∂ÄÌï¥Ïöî.", ro:"Acum studiez coreeanƒÉ." },
    { ko:"ÎÇ¥Ïùº ÏÑúÏö∏Ïóê Í∞ÄÏöî.", ro:"M√¢ine merg √Æn Seoul." }
  ];

  const BANK = Array.isArray(window.TOPIK4_QUIZ_500) && window.TOPIK4_QUIZ_500.length
    ? window.TOPIK4_QUIZ_500
    : FALLBACK;

  const LS_KEY = "rk_ex_tip1_state_v1";
  const state = loadState();

  let current = null;          // {q, correct, opts}
  let selectedIndex = -1;
  let locked = false;

  function safeParse(json, fallback){ try { return JSON.parse(json); } catch { return fallback; } }
  function loadState(){
    const base = { idx:0, correct:0, total:0 };
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return base;
    return Object.assign(base, safeParse(raw, base));
  }
  function saveState(){
    localStorage.setItem(LS_KEY, JSON.stringify(state));
  }

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]]=[a[j],a[i]];
    }
    return a;
  }

  function render(){
    if(!BANK.length){
      questionEl.textContent = "Nu existƒÉ √ÆntrebƒÉri.";
      answersEl.innerHTML = "";
      feedbackEl.textContent = "";
      return;
    }

    if(state.idx >= BANK.length) state.idx = 0;

    const q = BANK[state.idx];
    const correct = q.ro;

    // 3 gre»ôite
    const wrong = shuffle(BANK.filter(x => x.ro !== correct)).slice(0,3).map(x=>x.ro);
    const opts = shuffle([correct, ...wrong]);

    current = { q, correct, opts };
    selectedIndex = -1;
    locked = false;

    questionEl.textContent = q.ko;
    feedbackEl.textContent = "";
    answersEl.innerHTML = "";

    subheader.textContent = `Tip 1 ¬∑ KO‚ÜíRO ¬∑ √éntrebarea ${state.idx+1}/${BANK.length} ¬∑ Scor ${state.correct}/${state.total}`;

    opts.forEach((text, idx)=>{
      const b = document.createElement("button");
      b.type = "button";
      b.className = "answer";
      b.textContent = text;

      b.addEventListener("click", ()=>{
        if(locked) return;

        // selectare vizibilƒÉ
        selectedIndex = idx;
        answersEl.querySelectorAll(".answer").forEach(x=>x.classList.remove("selected"));
        b.classList.add("selected");
      });

      answersEl.appendChild(b);
    });
  }

  function lockAndMark(){
    locked = true;
    answersEl.querySelectorAll(".answer").forEach(x=>x.disabled = true);

    const btns = Array.from(answersEl.querySelectorAll(".answer"));
    const chosen = (selectedIndex >= 0) ? current.opts[selectedIndex] : null;

    // marcheazƒÉ corectul mereu
    btns.forEach((b, i)=>{
      if(current.opts[i] === current.correct){
        b.classList.add("correct");
      }
    });

    if(chosen === null){
      feedbackEl.textContent = "Alege un rƒÉspuns √Ænainte sƒÉ verifici.";
      locked = false;
      answersEl.querySelectorAll(".answer").forEach(x=>x.disabled = false);
      return;
    }

    const ok = chosen === current.correct;
    state.total += 1;
    if(ok){
      state.correct += 1;
      feedbackEl.textContent = "‚úÖ Corect.";
    }else{
      // marcheazƒÉ alesul gre»ôit
      btns[selectedIndex].classList.add("wrong");
      feedbackEl.textContent = `‚ùå Gre»ôit.\nCorect: ${current.correct}`;
    }

    saveState();
    subheader.textContent = `Tip 1 ¬∑ KO‚ÜíRO ¬∑ √éntrebarea ${state.idx+1}/${BANK.length} ¬∑ Scor ${state.correct}/${state.total}`;
  }

  checkBtn.addEventListener("click", ()=>{
    if(!current) return;
    lockAndMark();
  });

  nextBtn.addEventListener("click", ()=>{
    state.idx += 1;
    saveState();
    render();
  });

  render();
})();
</script>
</body>
</html>
