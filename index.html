<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Raluca Korean ‚Äì Study App v2.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* ========= Tema pastel simplificatƒÉ ========= */

    :root {
      --bg1: #dff3ff;
      --bg2: #ffe9ff;
      --bg3: #f4fffc;
      --bg4: #e8f0ff;

      --card-bg: #ffffffee;
      --accent: #6b8cff;
      --accent-strong: #4b607d;
      --text-main: #2f343b;
      --text-soft: #7a8088;
      --border: #e3dacb;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(120deg, var(--bg1), var(--bg2), var(--bg3), var(--bg4));
      background-size: 380% 380%;
      animation: bgFlow 28s ease-in-out infinite;
      color: var(--text-main);
    }

    @keyframes bgFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .app {
      max-width: 1040px;
      margin: 0 auto;
      padding: 16px 14px 80px;
    }

    /* ========= HEADER ========= */

    .rk-header {
      padding: 10px 16px 14px;
      border-radius: 24px;
      background: linear-gradient(120deg, #9fd6ff, #c6a7ff, #ff9acb);
      color: #0b1b3c;
      position: relative;
      overflow: visible;
      box-shadow: 0 18px 45px rgba(77, 93, 255, 0.4);
      background-size: 220% 220%;
      animation: headerGradient 18s ease-in-out infinite;
    }

    @keyframes headerGradient {
      0% { background-position: 0% 40%; }
      50% { background-position: 100% 60%; }
      100% { background-position: 0% 40%; }
    }

    .rk-header::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 100%;
      width: 260px;
      height: 70px;
      transform: translateX(-50%);
      border-radius: 50%;
      background: radial-gradient(
        circle,
        rgba(255, 170, 255, 0.35),
        rgba(120, 160, 255, 0.18),
        rgba(255, 255, 255, 0)
      );
      filter: blur(22px);
      animation: rkGlow 6s ease-in-out infinite alternate;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes rkGlow {
      0% {
        opacity: 0.45;
        transform: translateX(-50%) translateY(6px) scale(1.0);
      }
      100% {
        opacity: 0.85;
        transform: translateX(-50%) translateY(2px) scale(1.08);
      }
    }

    .rk-header-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .rk-header-main h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .rk-badge {
      font-size: 11px;
      font-weight: 600;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.18);
      color: #13213c;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(185, 145, 84, 0.25);
    }

    #subtitle {
      margin: 4px 0 0;
      font-size: 12px;
      color: #f7f7ff;
      font-weight: 500;
    }

    /* ========= ECRANE ========= */

    main {
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .screen {
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .screen.active {
      display: flex;
    }

    /* ========= CARD GENERAL ========= */

    .card {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.92), rgba(255, 220, 255, 0.88));
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.7);
      box-shadow:
        0 18px 40px rgba(40, 0, 80, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
      padding: 18px 16px 16px;
      transition: transform 0.18s ease-out, box-shadow 0.18s ease-out;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 22px 45px rgba(0,0,0,0.14);
    }

    .card h2 {
      margin: 0 0 8px;
      font-size: 15px;
      font-weight: 800;
      letter-spacing: 0.03em;
      color: var(--accent-strong);
    }

    /* ========= BUILDER ‚Äì Rom√¢nƒÉ ‚Üí CoreeanƒÉ ========= */

    #roInput {
      width: 100%;
      border-radius: 18px;
      border: none;
      padding: 10px 14px;
      font-size: 14px;
      font-weight: 600;
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 8px 20px rgba(135, 130, 200, 0.25);
      resize: vertical;
      min-height: 70px;
    }

    #roInput:focus {
      outline: none;
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.9),
        0 0 0 3px rgba(149, 120, 255, 0.7),
        0 0 16px rgba(149, 120, 255, 0.7);
      background-color: rgba(255,255,255,0.98);
    }

    .builder-buttons {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    button {
      border-radius: 16px;
      border: none;
      padding: 8px 14px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.02em;
      cursor: pointer;
      color: #fff;
      background: linear-gradient(135deg, #6b8cff, #9b6bff);
      box-shadow:
        0 10px 24px rgba(108, 110, 210, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.7) inset;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, filter 0.12s ease-out;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.18);
      filter: brightness(1.03);
    }

    button:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 5px 12px rgba(0, 0, 0, 0.24);
      filter: brightness(0.98);
    }

    button.secondary {
      background: linear-gradient(135deg, #ffaf6b, #ff72b4);
    }

    /* ========= TABEL PƒÇR»öI DE PROPOZI»öIE ========= */

    .table-block {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.92), rgba(255, 245, 255, 0.9));
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.7);
      box-shadow:
        0 12px 28px rgba(80, 90, 160, 0.35),
        0 0 0 1px rgba(255, 255, 255, 0.9) inset;
      padding: 10px 10px 12px;
      margin-top: 10px;
    }

    .table-title {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--accent-strong);
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .table-horizontal {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 4px;
    }

    .col {
      min-width: 110px;
      max-width: 140px;
      flex: 0 0 auto;
      border-radius: 16px;
      border: 1px solid #e2d7c8;
      box-shadow: 0 10px 22px rgba(95,78,58,0.16);
      padding: 7px 7px 8px;
      background: radial-gradient(circle at top left,#fdfbf7,#f2ebde);
    }

    .col-header {
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent-strong);
      margin-bottom: 3px;
      border-bottom: 1px solid rgba(208,196,255,0.8);
      padding-bottom: 2px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .col-header::before {
      content: "";
      width: 16px;
      height: 16px;
      border-radius: 6px;
      background: rgba(255,255,255,0.8);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 1px 3px rgba(0,0,0,0.06);
    }

    .col[data-key="subject"] .col-header::before { content: "üë§"; }
    .col[data-key="time"]    .col-header::before { content: "‚è∞"; }
    .col[data-key="place"]   .col-header::before { content: "üìç"; }
    .col[data-key="mod"]     .col-header::before { content: "‚ú®"; }
    .col[data-key="object"]  .col-header::before { content: "üéØ"; }
    .col[data-key="numeral"] .col-header::before { content: "#Ô∏è‚É£"; }
    .col[data-key="counter"] .col-header::before { content: "üî¢"; }
    .col[data-key="verb"]    .col-header::before { content: "üöÄ"; }

    .col-body-label {
      font-size: 10px;
      color: #8a849d;
      margin-bottom: 2px;
    }

    .col-body-main {
      font-size: 15px;
      font-weight: 700;
      color: #2f343b;
      min-height: 20px;
    }

    /* ========= Preview propozi»õie ========= */

    .preview-card {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 20px;
      background: linear-gradient(145deg, #ffffffee, #f7f0ff);
      box-shadow:
        0 14px 30px rgba(120,96,190,0.18),
        0 0 0 1px rgba(255,255,255,0.9) inset;
    }

    .preview-title {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--accent-strong);
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .preview-sentence {
      font-size: 26px;
      font-weight: 800;
      line-height: 1.7;
      letter-spacing: 0.3px;
      color: #2f2948;
      min-height: 34px;
    }

    .preview-note {
      margin-top: 4px;
      font-size: 11px;
      color: var(--text-soft);
    }

    /* ========= ECRANE PLACEHOLDER (Exerci»õii, Lec»õii, Glosar) ========= */

    .placeholder {
      font-size: 13px;
      color: var(--text-soft);
    }

    /* ========= NAVBAR JOS ========= */

    .bottom-nav {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 8px 10px 10px;
      display: flex;
      justify-content: space-around;
      gap: 8px;
      background: linear-gradient(120deg,#f3e6ff,#ffe8fb);
      box-shadow: 0 -10px 25px rgba(110, 120, 190, 0.25);
      backdrop-filter: blur(18px);
    }

    .nav-btn {
      flex: 1;
      max-width: 140px;
      border: none;
      border-radius: 999px;
      padding: 8px 18px 6px;
      background: linear-gradient(120deg,#f4e4ff,#fdf3ff);
      color: #4a3b73;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.10);
      cursor: pointer;
      transform: translateY(0);
      transition: transform 0.16s ease, box-shadow 0.16s ease, background 0.16s ease;
    }

    .nav-btn span.icon {
      font-size: 17px;
    }

    .nav-btn.active {
      background: linear-gradient(120deg,#8fd3ff,#c798ff);
      color: #fff;
      box-shadow: 0 14px 32px rgba(123, 104, 238, 0.5);
      transform: translateY(-2px);
    }

    .nav-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.18);
    }

    .nav-btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 5px 12px rgba(0, 0, 0, 0.24);
    }

    @media (max-width: 600px) {
      .card { padding: 14px 12px; }
      .preview-sentence { font-size: 22px; }
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- HEADER -->
    <header class="rk-header">
      <div class="rk-header-main">
        <h1>Raluca Korean</h1>
        <div class="rk-badge">Study App v2.0</div>
      </div>
      <p id="subtitle">Scrii √Æn rom√¢nƒÉ ‚Üí se umple automat builder-ul »ôi vezi propozi»õia √Æn coreeanƒÉ.</p>
    </header>

    <main>
      <!-- ===== SCREEN: BUILDER ===== -->
      <section id="screen-builder" class="screen active">
        <div class="card">
          <h2>Rom√¢nƒÉ ‚Üí CoreeanƒÉ (Builder automat)</h2>
          <p style="font-size:12px; margin-top:0; color:var(--text-soft);">
            Scrie o propozi»õie foarte simplƒÉ √Æn rom√¢nƒÉ (ex: <i>AstƒÉzi merg la cafenea »ôi beau o cafea.</i>), apoi apasƒÉ pe buton.
          </p>
          <textarea id="roInput" placeholder="Scrie aici propozi»õia ta √Æn rom√¢nƒÉ..."></textarea>

          <div class="builder-buttons">
            <button id="autoFillBtn">CompleteazƒÉ automat builder-ul</button>
            <button id="clearBtn" class="secondary">CurƒÉ»õƒÉ tot</button>
          </div>
        </div>

        <!-- TABEL P1 -->
        <div class="table-block">
          <div class="table-title">
            <span>Propozi»õia 1 ‚Äì PƒÉr»õi de vorbire</span>
            <span style="font-size:10px;color:var(--text-soft);">se pot edita manual dupƒÉ</span>
          </div>
          <div id="tableP1" class="table-horizontal">
            <div class="col" data-key="subject">
              <div class="col-header">SUBJECT</div>
              <div class="col-body-label">eu, tu, el/ea...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="time">
              <div class="col-header">TIME</div>
              <div class="col-body-label">azi, m√¢ine, ieri...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="place">
              <div class="col-header">PLACE</div>
              <div class="col-body-label">acasƒÉ, la »ôcoalƒÉ...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="mod">
              <div class="col-header">MOD</div>
              <div class="col-body-label">cum? (bine, √Æncet...)</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="object">
              <div class="col-header">OBJECT</div>
              <div class="col-body-label">ce? (cafea, carte...)</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="numeral">
              <div class="col-header">NUMERAL</div>
              <div class="col-body-label">unƒÉ, douƒÉ, trei...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="counter">
              <div class="col-header">COUNTER</div>
              <div class="col-body-label">Í∞ú, Í∂å...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
            <div class="col" data-key="verb">
              <div class="col-header">VERB</div>
              <div class="col-body-label">Í∞ÄÏöî, ÏôÄÏöî...</div>
              <div class="col-body-main" contenteditable="true"></div>
            </div>
          </div>
        </div>

        <!-- PREVIEW -->
        <div class="preview-card">
          <div class="preview-title">
            <span>Propozi»õia finalƒÉ √Æn coreeanƒÉ</span>
            <span style="font-size:10px;color:var(--text-soft);">se actualizeazƒÉ dupƒÉ builder</span>
          </div>
          <div id="previewSentence" class="preview-sentence"></div>
          <div class="preview-note">
            Po»õi modifica manual sloturile din tabel (SUBJECT / TIME / PLACE etc.), apoi apasƒÉ iar pe
            <b>CompleteazƒÉ automat builder-ul</b> ca sƒÉ refacƒÉ propozi»õia.
          </div>
        </div>
      </section>

      <!-- ===== SCREEN: EXERCI»öII ===== -->
      <section id="screen-exercises" class="screen">
        <div class="card">
          <h2>Exerci»õii TOPIK ‚Äì √Æn cur√¢nd</h2>
          <p class="placeholder">
            Aici vor fi exerci»õiile TOPIK (grilƒÉ, completƒÉri etc.). DeocamdatƒÉ focusul este pe Builder.
          </p>
        </div>
      </section>

      <!-- ===== SCREEN: LEC»öII ===== -->
      <section id="screen-lessons" class="screen">
        <div class="card">
          <h2>Lec»õii gramaticƒÉ ‚Äì √Æn cur√¢nd</h2>
          <p class="placeholder">
            Aici vei avea lec»õiile tale de gramaticƒÉ, structurate frumos. Momentan lƒÉsƒÉm doar placeholder simplu.
          </p>
        </div>
      </section>

      <!-- ===== SCREEN: GLOSAR ===== -->
      <section id="screen-glossary" class="screen">
        <div class="card">
          <h2>Glosar personal ‚Äì √Æn cur√¢nd</h2>
          <p class="placeholder">
            Aici vei putea salva cuvinte »ôi expresii preferate. Acum ne ocupƒÉm √Ænt√¢i de Builderul automat.
          </p>
        </div>
      </section>
    </main>
  </div>

  <!-- NAVBAR -->
  <nav class="bottom-nav">
    <button class="nav-btn active" data-target="screen-builder">
      <span class="icon">üèóÔ∏è</span>
      <span>Builder</span>
    </button>
    <button class="nav-btn" data-target="screen-exercises">
      <span class="icon">üìù</span>
      <span>Exerci»õii</span>
    </button>
    <button class="nav-btn" data-target="screen-lessons">
      <span class="icon">üìí</span>
      <span>Lec»õii</span>
    </button>
    <button class="nav-btn" data-target="screen-glossary">
      <span class="icon">üìö</span>
      <span>Glosar</span>
    </button>
  </nav>

  <script>
    /* ========= NAVBAR ‚Äì trecere √Æntre ecrane ========= */

    const screens = document.querySelectorAll(".screen");
    const navBtns = document.querySelectorAll(".nav-btn");

    navBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-target");

        screens.forEach(sc => {
          sc.classList.toggle("active", sc.id === targetId);
        });

        navBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    /* ========= PARSER Rom√¢nƒÉ ‚Üí sloturi ========= */

    function normalizeRo(text) {
      if (!text) return "";
      let t = text.toLowerCase();
      t = t.replace(/≈ü/g, "»ô").replace(/≈£/g, "»õ");
      t = t.replace(/[.,!?;:]/g, " ");
      t = t.replace(/\s+/g, " ").trim();
      return t;
    }

    const RO_RULES = {
      subject: [
        { re: /\beu\s*\(formal\)|eu\s*-\s*formal\b/, value: "Ï†Ä" },
        { re: /\beu\s*\(informal\)|eu\s*-\s*informal\b/, value: "ÎÇò" },
        { re: /\beu\b/, value: "Ï†Ä" },
        { re: /\btu\b/, value: "ÎÑà" }
      ],
      time: [
        { re: /\bazi\b|\bastƒÉzi\b/, value: "Ïò§Îäò" },
        { re: /\bm√¢ine\b/, value: "ÎÇ¥Ïùº" },
        { re: /\bieri\b/, value: "Ïñ¥Ï†ú" },
        { re: /\bacum\b/, value: "ÏßÄÍ∏à" }
      ],
      place: [
        { re: /\bacas[ƒÉa]\b/, value: "Ïßë" },
        { re: /la\s+»ôcoal[ƒÉa]|la\s+scoala|»ôcoal[ƒÉa]\b|scoala\b/, value: "ÌïôÍµê" },
        { re: /la\s+firm[ƒÉa]|la\s+serviciu|la\s+companie|firm[ƒÉa]\b|serviciu\b|companie\b/, value: "ÌöåÏÇ¨" },
        { re: /la\s+banc[ƒÉa]|banc[ƒÉa]\b/, value: "ÏùÄÌñâ" },
        { re: /cafenea|cafene[al]/, value: "Ïπ¥Ìéò" }
      ],
      mod: [
        { re: /\bbine\b|frumos\b|ok\b/, value: "Ïûò" },
        { re: /√Æn\s+lini»ôte|in\s+liniste|lini»ôte|liniste/, value: "Ï°∞Ïö©Ìûà" },
        { re: /cu\s+s√¢rguint[ƒÉa]|cu\s+sarguinta|harnic|cu\s+mult\s+efort/, value: "Ïó¥Ïã¨Ìûà" },
        { re: /√Æncet|incet/, value: "Ï≤úÏ≤úÌûà" },
        { re: /repede|rapid/, value: "Îπ®Î¶¨" }
      ],
      object: [
        { re: /cafea/, value: "Ïª§Ìîº" },
        { re: /\bap[ƒÉa]\b|ap[ƒÉa]\s+mineral[ƒÉa]?/, value: "Î¨º" },
        { re: /carte|cƒÉr»õi|carti/, value: "Ï±Ö" },
        { re: /m√¢ncare|mancare|pr√¢nzul|cina|mic\s+dejun/, value: "ÏùåÏãù" },
        { re: /ceai\b/, value: "Ï∞®" }
      ],
      numeral: [
        { re: /\bo\s+carte\b|\bun[ƒÉa]\s+carte\b|\bo\s+cafea\b|\bun[ƒÉa]\s+cafea\b/, value: "Ìïú" },
        { re: /\bdou[ƒÉa]\s+car»õi|\bdou[ƒÉa]\s+cafele/, value: "Îëê" },
        { re: /\btrei\s+car»õi|\btrei\s+cafele/, value: "ÏÑ∏" }
      ],
      counter: [
        { re: /carte|cƒÉr»õi|carti/, value: "Í∂å" },
        { re: /cafea|ap[ƒÉa]\b|ceai\b|m√¢ncare|mancare/, value: "Í∞ú" }
      ],
      verb: [
        { re: /merg\b|a merge|sƒÉ merg|sa merg/, value: "Í∞ÄÏöî" },
        { re: /vin\b|a veni|sƒÉ vin|sa vin/, value: "ÏôÄÏöî" },
        { re: /beau\b|a bea|sƒÉ beau|sa beau/, value: "ÎßàÏÖîÏöî" },
        { re: /mƒÉn√¢nc|mananc|a m√¢nca|a manca/, value: "Î®πÏñ¥Ïöî" },
        { re: /citesc|a citi|sƒÉ citesc|sa citesc/, value: "ÏùΩÏñ¥Ïöî" },
        { re: /lucrez|a lucra/, value: "ÏùºÌï¥Ïöî" }
      ]
    };

    function matchSlot(rules, text) {
      if (!rules) return null;
      for (const rule of rules) {
        if (rule.re.test(text)) return rule.value;
      }
      return null;
    }

    function parseRomanianToSlots(text) {
      const t = normalizeRo(text);
      const slots = {
        subject: matchSlot(RO_RULES.subject, t),
        time:    matchSlot(RO_RULES.time, t),
        place:   matchSlot(RO_RULES.place, t),
        mod:     matchSlot(RO_RULES.mod, t),
        object:  matchSlot(RO_RULES.object, t),
        numeral: matchSlot(RO_RULES.numeral, t),
        counter: matchSlot(RO_RULES.counter, t),
        verb:    matchSlot(RO_RULES.verb, t)
      };
      return slots;
    }

    function applySlotsToBuilderP1(slots) {
      const table = document.getElementById("tableP1");
      if (!table || !slots) return;

      const setCol = (key, value) => {
        if (!value) return;
        const col = table.querySelector('.col[data-key="' + key + '"] .col-body-main');
        if (col) {
          col.textContent = value;
        }
      };

      setCol("subject", slots.subject);
      setCol("time",    slots.time);
      setCol("place",   slots.place);
      setCol("mod",     slots.mod);
      setCol("object",  slots.object);
      setCol("numeral", slots.numeral);
      setCol("counter", slots.counter);

      const verbCol = table.querySelector('.col[data-key="verb"] .col-body-main');
      if (verbCol && slots.verb) {
        verbCol.textContent = slots.verb;
      }
    }

    function rebuildPreviewFromBuilderP1(slotsFromParser) {
      const table = document.getElementById("tableP1");
      if (!table) return;

      const pick = (key) => {
        const col = table.querySelector('.col[data-key="' + key + '"] .col-body-main');
        return col ? col.textContent.trim() : "";
      };

      const subject = pick("subject") || "Ï†Ä";
      const time    = pick("time");
      const place   = pick("place");
      const mod     = pick("mod");
      const numeral = pick("numeral");
      const counter = pick("counter");
      const object  = pick("object");
      const verb    = pick("verb") || (slotsFromParser && slotsFromParser.verb) || "Í∞ÄÏöî";

      let objectChunk = "";
      if (object && numeral && counter) {
        objectChunk = object + " " + numeral + " " + counter;
      } else if (object) {
        objectChunk = object;
      }

      const pieces = [subject, time, place, mod, objectChunk, verb].filter(Boolean);
      const sentence = pieces.join(" ");

      const out = document.getElementById("previewSentence");
      if (out) out.textContent = sentence;
    }

    // Butoane
    const autoFillBtn = document.getElementById("autoFillBtn");
    const clearBtn    = document.getElementById("clearBtn");
    const roInput     = document.getElementById("roInput");

    if (autoFillBtn) {
      autoFillBtn.addEventListener("click", () => {
        const text = roInput.value;
        const slots = parseRomanianToSlots(text);
        applySlotsToBuilderP1(slots);
        rebuildPreviewFromBuilderP1(slots);
      });
    }

    if (clearBtn) {
      clearBtn.addEventListener("click", () => {
        roInput.value = "";
        document.querySelectorAll("#tableP1 .col-body-main").forEach(el => el.textContent = "");
        document.getElementById("previewSentence").textContent = "";
      });
    }
  </script>
</body>
</html>
