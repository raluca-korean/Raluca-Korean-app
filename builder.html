Bb23

Bb17
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Raluca Korean ‚Äì Study App v2.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
   
    header{text-align:center;padding:4px 8px 4px;}
    header h1{font-size:18px;margin:2px 0;font-weight:700;color:var(--accent-strong);}
    header p{margin:0;font-size:11px;color:var(--text-soft);}

    .screen{display:none;flex-direction:column;gap:10px;flex:1;min-height:0;}
    .screen.active{display:flex;}

    .mode-panel{
      background:var(--card-bg);border-radius:12px;border:1px solid var(--border);
      padding:6px 8px;font-size:11px;display:flex;flex-direction:column;gap:4px;
      box-shadow:0 4px 12px rgba(120,96,190,0.08);
    }
    .mode-row{
      display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;
    }
    .mode-row label{font-size:11px;display:flex;align-items:center;gap:4px;}
    .part-toggles{display:flex;flex-wrap:wrap;gap:6px;}
    .chip{
      display:inline-flex;align-items:center;gap:3px;
      padding:3px 8px;border-radius:999px;background:#ede7ff;color:var(--accent-strong);
      font-size:10px;cursor:pointer;
    }
    .chip input{margin:0;}
    .section-label{font-size:11px;font-weight:600;color:var(--accent-strong);margin-top:2px;}

    .small-mode-btn{
      padding:3px 8px;
      font-size:10px;
    }
    .small-mode-btn.active{
      background:var(--accent-strong);
      color:#fff;
    }

    .table-block{
      background:var(--card-bg);border-radius:14px;padding:8px;
      box-shadow:0 6px 16px rgba(120,96,190,0.12);border:1px solid var(--border);
      display:flex;flex-direction:column;gap:6px;flex:1;min-height:0;
    }
    .table-title{
      font-size:11px;font-weight:600;color:var(--text-soft);
      display:flex;justify-content:space-between;align-items:center;
    }
    .table-horizontal{
      display:flex;flex-direction:row;overflow-x:auto;padding-bottom:4px;gap:6px;
    }
    .col{
      min-width:110px;max-width:140px;flex:0 0 auto;background:#faf8ff;border-radius:10px;
      border:1px solid var(--border);display:flex;flex-direction:column;
      padding:6px 6px 8px;transition:0.2s;cursor:pointer;
      touch-action:manipulation;
    }
    .col-header{
      font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;
      color:var(--accent-strong);margin-bottom:4px;border-bottom:1px solid var(--border);
      padding-bottom:3px;
    }
    /* Header de coloanƒÉ cu titlu + bifƒÉ ON/OFF */
.col-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:4px;
}

.col-header input.col-toggle{
  width:14px;
  height:14px;
  accent-color: var(--accent-strong);
  flex-shrink:0;
}
    .col-body-label{font-size:10px;color:var(--text-soft);margin-bottom:2px;}
    .col-body-main{font-size:15px;font-weight:600;margin-bottom:2px;}
    .col-body-extra{font-size:11px;color:var(--text-soft);}
    .dimmed{
      opacity:0.35;background-image:repeating-linear-gradient(
        -45deg,var(--dimmed-bg),var(--dimmed-bg) 4px,#fdfbff 4px,#fdfbff 8px
      );
    }

    .controls{
      display:flex;justify-content:space-between;align-items:center;gap:8px;
      padding-top:4px;border-top:1px dashed var(--border);
    }
    .btn-group{display:flex;gap:6px;}
    button{
      border-radius:999px;border:none;padding:6px 10px;font-size:12px;font-weight:600;
      cursor:pointer;background:var(--accent);color:#fff;display:inline-flex;
      align-items:center;gap:4px;box-shadow:0 2px 6px rgba(90,70,160,0.25);
    }
    button.secondary{background:#ede7ff;color:var(--accent-strong);box-shadow:none;}
    button:disabled{opacity:0.4;box-shadow:none;cursor:default;}
    .page-indicator{font-size:11px;color:var(--text-soft);}
    .legend{font-size:10px;color:var(--text-soft);text-align:center;padding:2px 4px 0;}
    .hidden{display:none !important;}
.preview-card{
  margin-top: 6px;
  padding: 8px;
  border-radius: 12px;
  background: #f9f7ff;
  border: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  gap: 4px;
}

    .preview-title{
      font-size:11px;font-weight:600;color:var(--accent-strong);
      display:flex;justify-content:space-between;align-items:center;
    }

    .preview-natural{
      font-size:11px;
      color:#8e6cff;
      margin-top:2px;
    }
    .preview-buttons{
      display:flex;gap:6px;margin-top:4px;flex-wrap:wrap;
    }
  
  
    .overlay{
      position:fixed;inset:0;background:var(--overlay-bg);
      display:flex;justify-content:center;align-items:flex-end;z-index:1000;
    }
    .panel{
      width:100%;max-width:900px;background:var(--card-bg);
      border-radius:18px 18px 0 0;box-shadow:0 -6px 18px rgba(0,0,0,0.15);
      padding:10px 12px 14px;animation:slideUp 0.18s ease-out;
    }
    @keyframes slideUp{
      from{transform:translateY(40px);opacity:0;}
      to{transform:translateY(0);opacity:1;}
    }
    .panel-header{
      display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;
    }
    .panel-title{font-size:13px;font-weight:600;color:var(--accent-strong);}
    .panel-sub{font-size:11px;color:var(--text-soft);}
    .panel-close{
      background:transparent;color:var(--text-soft);box-shadow:none;
      padding:4px 6px;font-size:14px;
    }
    .panel-input-row{display:flex;gap:6px;margin-bottom:6px;}
    .panel-input-row input{
      flex:1;border-radius:999px;border:1px solid var(--border);
      padding:6px 10px;font-size:12px;
    }
    .panel-list{
      max-height:260px;overflow-y:auto;border-radius:10px;
      border:1px solid var(--border);background:#faf8ff;padding:4px;
    }
    .panel-item{
      padding:4px 8px;border-radius:8px;display:flex;justify-content:space-between;
      align-items:center;font-size:13px;cursor:pointer;
    }
    .panel-item:hover{background:#ede7ff;}
    .panel-item-main{font-weight:600;}
    .panel-item-extra{
      display:flex;flex-direction:column;align-items:flex-end;gap:2px;
    }
    .panel-item-tag{font-size:10px;color:var(--accent-strong);}

   

    .card{
      background:var(--card-bg);border-radius:14px;padding:10px;
      box-shadow:0 4px 12px rgba(120,96,190,0.12);border:1px solid var(--border);
      display:flex;flex-direction:column;gap:6px;
    }
    .card h2{
      margin:0;font-size:14px;color:var(--accent-strong);
    }
    .small-label{font-size:11px;color:var(--text-soft);}
    select{
      border-radius:999px;border:1px solid var(--border);
      padding:4px 10px;font-size:12px;background:#fff;
    }
   
   


    /* CARD GENERAL ‚Äì Rom√¢nƒÉ ‚Üí CoreeanƒÉ, Exerci»õii, Glosar */
.card{
  background: linear-gradient(145deg, #ffffff, #f5f0ff);
  border-radius: 18px;
  padding: 12px 14px;
  box-shadow: 0 10px 24px rgba(120,96,190,0.18);
  border: 1px solid rgba(201,181,255,0.6);
}

/* Titlurile cardurilor */
.card h2{
  margin: 0 0 6px;
  font-size: 15px;
  font-weight: 700;
  color: #7b5fff;
  letter-spacing: 0.03em;
}

/* Textarea rom√¢nƒÉ */
textarea#roInput{
  border-radius: 14px;
  border: 1px solid #d7c9ff;
  background: #fbf9ff;
  padding: 10px 12px;
  font-size: 13px;
  line-height: 1.45;
  box-shadow: 0 0 0 1px rgba(255,255,255,0.7);
}

/* Buton ‚ÄûTradu √Æn coreeanƒÉ‚Äù */
#roTranslateBtn{
  margin-top: 6px;
  border-radius: 999px;
  padding: 7px 14px;
  font-size: 12px;
  font-weight: 600;
  background: linear-gradient(120deg, #b391ff, #8a6bff);
  color: #fff;
  border: none;
  box-shadow: 0 6px 14px rgba(125,99,210,0.35);
}
#roTranslateBtn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
}

.translate-icon{
  font-size:14px;
  transform:translateY(0.5px);
}
    /* Rezultat KO + rom√¢na corectatƒÉ */
#roToKoResult{
  margin-top: 8px;
  font-size: 15px;
  font-weight: 700;
  color: #3a295d;
}

#roCorrected{
  margin-top: 2px;
  font-size: 12px;
  color: #7b7496;
}

/* Coloanele SUBJ/TIME/PLACE etc. */
.col{
  min-width: 110px;
  max-width: 140px;
  flex: 0 0 auto;
  background: radial-gradient(circle at top left,#fdfbff,#f1ecff);
  border-radius: 14px;
  border: 1px solid #ddd2ff;
  padding: 7px 7px 9px;
  box-shadow: 0 6px 16px rgba(118,95,205,0.16);
  transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s;
}

/* Efect la tap / hover (desktop) */
.col:active,
.col:hover{
  transform: translateY(-1px);
  box-shadow: 0 9px 20px rgba(118,95,205,0.24);
  border-color: #b09bff;
}

/* Headerul coloanei */
.col-header{
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #9a80ff;
  margin-bottom: 3px;
  border-bottom: 1px solid rgba(208,196,255,0.8);
  padding-bottom: 2px;
}

/* Cuv√¢ntul ales √Æn coloanƒÉ */
.col-body-main{
  font-size: 15px;
  font-weight: 700;
  color: #372449;
}

/* Hintul gri mic din coloanƒÉ */
.col-body-label{
  font-size: 10px;
  color: #8a849d;
}

/* Propozi»õia KO mare de jos */
#previewKo{
  font-size:22px;
  font-weight:700;
  text-align:center;
  line-height:1.6;
  white-space:normal;
}
    /* Traducere rom√¢nƒÉ */
#previewRo{
  font-size: 12px;
  color: #746f91;
}

/* Badge ‚Äûnatural‚Äù / aten»õionare */
#naturalHint{
  font-size: 11px;
  margin-top: 3px;
}

    /* =========================================================
   THEME v4 ‚Äì ‚Äûapp desenatƒÉ‚Äù pentru Raluca
   ‚Äì forme de fundal + iconi»õe pe coloane + carduri ilustrate
   (se pune ULTIMUL √Æn <style>)
========================================================= */

/* header cu ‚ÄûbandƒÉ‚Äù de app */
header{
  position:relative;
  padding:10px 10px 14px;
}
header::before{
  content:"";
  position:absolute;
  inset:0 8px auto;
  height:60px;
  border-radius:22px;
  background:linear-gradient(120deg,#fdfbf7,#e4eaf3);
  box-shadow:0 14px 30px rgba(120,111,90,0.18);
  z-index:-1;
}
header h1{
  font-size:17px;
  letter-spacing:0.12em;
  text-transform:uppercase;
}
header p{
  font-size:11px;
}

/* mic ‚Äûbadge‚Äù versiune */
header p::after{
  content:"v2.0";
  display:inline-flex;
  align-items:center;
  justify-content:center;
  margin-left:6px;
  padding:2px 8px;
  border-radius:999px;
  font-size:9px;
  font-weight:600;
  background:rgba(75,104,127,0.09);
  color:#4b687f;
}

/* carduri cu ornament √Æn col»õ */
.card,
.table-block,
.preview-card{
  position:relative;
  overflow:hidden;
}
.card::before,
.table-block::before,
.preview-card::before{
  content:"";
  position:absolute;
  right:-32px;
  top:-32px;
  width:90px;
  height:90px;
  border-radius:50%;
  background:radial-gradient(circle at 30% 30%,rgba(255,255,255,0.9),rgba(178,193,209,0.15));
  pointer-events:none;
}
.card::after,
.table-block::after,
.preview-card::after{
  content:"";
  position:absolute;
  left:-26px;
  bottom:-26px;
  width:70px;
  height:70px;
  border-radius:50%;
  background:radial-gradient(circle at 70% 70%,rgba(255,255,255,0.95),rgba(198,188,166,0.15));
  pointer-events:none;
}

/* con»õinutul cardurilor sƒÉ rƒÉm√¢nƒÉ deasupra ornamentelor */
.card > *,
.table-block > *,
.preview-card > *{
  position:relative;
  z-index:1;
}

/* titluri card cu barƒÉ sub»õire dedesubt */
.card h2{
  position:relative;
  padding-bottom:4px;
}
.card h2::after{
  content:"";
  position:absolute;
  left:0;
  bottom:0;
  width:42px;
  height:2px;
  border-radius:999px;
  background:linear-gradient(90deg,rgba(75,104,127,0.65),rgba(255,255,255,0));
}

/* chips ‚Äì mai ‚Äûtablete‚Äù */
.chip{
  position:relative;
  padding:4px 10px 4px 8px;
}
.chip::before{
  content:"";
  width:6px;
  height:6px;
  border-radius:50%;
  background:#c3b08f;
}

/* ========= ICONI»öE PE COLOANE (SUBJECT/TIME/PLACE etc.) ========= */

.col-header{
  display:flex;
  align-items:center;
  gap:4px;
}

/* icon placeholder */
.col-header::before{
  content:"";
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:16px;
  height:16px;
  border-radius:6px;
  background:rgba(255,255,255,0.8);
  font-size:11px;
  box-shadow:0 1px 3px rgba(0,0,0,0.06);
}

/* SUBJ üë§ */
.col[data-key="subject"] .col-header::before{
  content:"üë§";
}
/* TIME ‚è∞ */
.col[data-key="time"] .col-header::before{
  content:"‚è∞";
}
/* PLACE üìç */
.col[data-key="place"] .col-header::before{
  content:"üìç";
}
/* MOD ‚ú® */
.col[data-key="mod"] .col-header::before{
  content:"‚ú®";
}
/* OBJECT üéØ */
.col[data-key="object"] .col-header::before{
  content:"üéØ";
}
/* NUMERAL #Ô∏è‚É£ */
.col[data-key="numeral"] .col-header::before{
  content:"#Ô∏è‚É£";
}
/* COUNTER üî¢ */
.col[data-key="counter"] .col-header::before{
  content:"üî¢";
}
/* VERB üöÄ */
.col[data-key="verb"] .col-header::before{
  content:"üöÄ";
}
/* CONJUGƒÇRI üîó */
.col[data-key="conjug"] .col-header::before{
  content:"üîó";
}

/* c√¢nd coloana e ‚ÄûstinsƒÉ‚Äù (dimmed) ‚Äì iconi»õa devine gri */
.col.dimmed .col-header::before{
  filter:grayscale(0.9);
  opacity:0.6;
}

/* ========= ACCENTE DIFERITE PE FIECARE ECRAN ========= */

/* üèó Builder ‚Äì bandƒÉ sus de sec»õiune */
#screen-builder .mode-panel{
  border-top:3px solid rgba(186,166,126,0.85);
}
#screen-builder .preview-title span:first-child::before{
  content:"üèó ";
}

/* ========= PREVIEW propozi»õie ========= */

.preview-card{
  margin-top:10px;
}
.preview-title span:first-child{
  display:flex;
  align-items:center;
  gap:6px;
}
.preview-title span:first-child::before{
  content:"üîä";
  width:18px;
  height:18px;
  border-radius:50%;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  background:rgba(75,104,127,0.08);
}

/* hint naturalitate ‚Äì ‚Äûbadge‚Äù */
.preview-natural{
  padding:4px 8px;
  border-radius:999px;
  display:inline-block;
  background:rgba(185,207,192,0.35);
}

/* overlay panel ‚Äì divider subtil sus */
.panel-header{
  border-bottom:1px solid rgba(222,214,200,0.9);
  padding-bottom:6px;
}
    /* === THEME A ‚Äì Korean Minimal Chic & Cozy === */

:root{
  --bg: #f6f1e8;
  --card-bg: #fdfbf7;
  --accent: #6f86a8;          /* albastru-cernealƒÉ */
  --accent-strong: #4b607d;   /* albastru √Ænchis */
  --accent-soft: #f1d3a0;     /* auriu cald */
  --text-main: #2f343b;
  --text-soft: #7a8088;
  --border: #e3dacb;
  --dimmed-bg: #f0e6d7;
  --overlay-bg: rgba(40,32,24,0.25);
}

/* fundal general ‚Äì crem cald, tip ‚Äûcafea cu lapte‚Äù */
body{
  margin:0;
  padding:0;
  font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:
    radial-gradient(circle at top,#fbf4e8 0,#f0ebe3 40%,#e9e2d7 100%);
  color:var(--text-main);
}

/* containerul aplica»õiei ‚Äì u»ôor ‚Äûcard‚Äù pe mijloc */
.app{
  max-width:1040px;
  margin:0 auto;
  padding:18px 14px calc(70px + env(safe-area-inset-bottom));
}
/* header ‚Äì mai ‚Äûbrand‚Äù »ôi mai premium */
header{
  padding:6px 10px 10px;
  text-align:left;
}
header h1{
  font-size:18px;
  font-weight:700;
  letter-spacing:0.03em;
  text-transform:uppercase;
  color:var(--accent-strong);
  display:flex;
  align-items:center;
  gap:6px;
}
header h1::before{
  content:"‚úçÔ∏è";
  font-size:16px;
}
header p{
  margin:2px 0 0;
  font-size:12px;
  color:var(--text-soft);
}

/* carduri mari ‚Äì efect de planner premium */
.card,
.table-block,
.preview-card{
  background:linear-gradient(145deg,#fdfbf7,#f4eee3);
  border-radius:18px;
  border:1px solid rgba(227,218,203,0.9);
  box-shadow:0 14px 30px rgba(80,64,48,0.12);
}

/* card standard (Rom√¢nƒÉ ‚Üí CoreeanƒÉ, Exerci»õii, Glosar) */
.card{
  padding:12px 14px;
}
.card h2{
  font-size:15px;
  color:var(--accent-strong);
  letter-spacing:0.04em;
}

/* bara de introducere propozi»õie */
textarea#roInput{
  background:#fbf8f1;
  border:1px solid #e1d5c5;
  box-shadow:0 0 0 1px rgba(255,255,255,0.7);
}

/* buton mare ‚ÄûTradu √Æn coreeanƒÉ‚Äù */
#roTranslateBtn{
  background:linear-gradient(115deg,#4b607d,#6f86a8);
  box-shadow:0 8px 18px rgba(75,96,125,0.35);
}

/* bara albastrƒÉ lungƒÉ (Tradu / Next etc.) */
button{
  border-radius:999px;
  border:none;
  padding:7px 14px;
  font-size:12px;
  font-weight:600;
  cursor:pointer;
  background:linear-gradient(120deg,#4b607d,#6f86a8);
  color:#fff;
  box-shadow:0 8px 18px rgba(75,96,125,0.32);
}
button.secondary{
  background:#f3ebdd;
  color:var(--accent-strong);
  box-shadow:none;
}
button:disabled{
  opacity:0.45;
  box-shadow:none;
}

/* toggle-urile SUBJECT / TIME / ... ‚Äì chip-uri mai elegante */
.chip{
  background:#f4ece0;
  color:var(--accent-strong);
  border-radius:999px;
  padding:4px 10px;
  box-shadow:0 4px 8px rgba(180,162,136,0.25);
}
.chip input{
  accent-color:var(--accent-strong);
}

/* coloanele din tabel (SUBJECT / TIME / PLACE etc.) */
.col{
  background:radial-gradient(circle at top left,#fdfbf7,#f2ebde);
  border-radius:16px;
  border:1px solid #e2d7c8;
  box-shadow:0 10px 22px rgba(95,78,58,0.16);
  transform:translateY(0);
  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease,
    background 0.15s ease;
}
.col-header{
  color:var(--accent-strong);
}
.col-body-main{
  color:#2f343b;
}
.col-body-label{
  color:#938777;
}
.col:hover{
  transform:translateY(-1px);
  box-shadow:0 14px 28px rgba(95,78,58,0.24);
  border-color:#d0c1aa;
}

/* c√¢nd coloana e dezactivatƒÉ */
.col.dimmed{
  opacity:0.4;
  background-image:none;
  background:#f1e7d8;
}

/* cardul de preview propozi»õie de jos */
.preview-card{
  margin-top:10px;
  padding:10px 12px;
}
.preview-title span{
  color:var(--accent-strong);
}
.preview-natural{
  color:#a97a2e; /* un auriu cald pentru mesajele de naturalitate */
}

/* legendƒÉ explicativƒÉ */
.legend{
  font-size:10px;
  color:#8b8476;
}

/* panelul de overlay (lista de cuvinte) ‚Äì ca un sertar de lemn deschis */
.panel{
  background:linear-gradient(145deg,#fdfbf7,#f2ebde);
  border-radius:20px 20px 0 0;
  border:1px solid #e1d7c7;
}
.panel-item{
  border-radius:12px;
}
.panel-item:hover{
  background:#f3ebdd;
}
    /* === Stepper 3 pa»ôi (Builder) === */

.builder-steps{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin:4px 0 10px;
  font-size:11px;
  color:var(--text-soft);
}

.builder-step{
  display:flex;
  align-items:center;
  gap:6px;
  padding:4px 8px;
  border-radius:999px;
  background:rgba(255,255,255,0.7);
  border:1px solid var(--border);
  box-shadow:0 2px 6px rgba(80,64,48,0.10);
}

.builder-step-number{
  width:16px;
  height:16px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:10px;
  font-weight:700;
  background:var(--accent-strong);
  color:#fff;
}

.builder-step-text{
  white-space:nowrap;
}

/* pasul curent (1) eviden»õiat pu»õin mai mult */
.builder-step.active{
  background:#fff7e4;
  border-color:var(--accent-soft);
}
    /* === HEADER BRAND + TABS DE CAIET === */

/* header general */
.rk-header{
  padding:8px 10px 12px;
  display:flex;
  flex-direction:column;
  gap:4px;
}

.rk-header-main{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.rk-header-main h1{
  margin:0;
  font-size:20px;
  font-weight:700;
  letter-spacing:0.06em;
  text-transform:uppercase;
  color:var(--accent-strong);
}

/* badge mic l√¢ngƒÉ titlu ‚Äì aratƒÉ ca o etichetƒÉ de agendƒÉ */
.rk-badge{
  font-size:11px;
  font-weight:600;
  padding:4px 9px;
  border-radius:999px;
  background:linear-gradient(120deg,#f1d3a0,#f6e3b9);
  color:#514029;
  border:1px solid rgba(210,175,112,0.7);
  box-shadow:0 4px 10px rgba(185,145,84,0.25);
}

/* subtitlu */
.rk-header #subtitle{
  margin:0;
  font-size:12px;
  color:var(--text-soft);
}


/* AdaugƒÉ √Æn <style> */
.legend{
  display:none;
}
   
    /* Chip-uri oprite (SUBJECT/TIME/PLACE etc. nefolosite √Æn propozi»õie) */
#screen-builder .chip-off{
  opacity: 0.45;
  background: #eee2d1;
  box-shadow: none;
  filter: grayscale(0.1);
}
    /* ===== STEPPER pentru Builder (3 pa»ôi vizuali) ===== */

.builder-steps{
  display:flex;
  gap:6px;
  margin-bottom:8px;
  padding:6px 6px 2px;
  border-radius:14px;
  background:rgba(255,252,246,0.9);
  border:1px solid rgba(223,210,190,0.9);
  box-shadow:0 6px 14px rgba(96,78,56,0.12);
}

.builder-step{
  flex:1;
  display:flex;
  align-items:center;
  gap:6px;
  padding:4px 6px;
  border-radius:999px;
  font-size:11px;
  color:var(--text-soft);
  opacity:0.9;
}

.builder-step-number{
  width:18px;
  height:18px;
  border-radius:50%;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  font-weight:700;
  background:#f3ebdd;
  color:#70563a;
}

.builder-step-text{
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* primul pas ‚Äì accent u»ôor (pare ‚Äûactiv‚Äù) */
.builder-step.active{
  background:linear-gradient(120deg,#f6efe3,#f1e2cc);
  color:var(--accent-strong);
  font-weight:600;
}

.builder-step.active .builder-step-number{
  background:var(--accent-strong);
  color:#fff;
}
   
    .example{
  display:inline-block;
  font-size:12px;
  margin-top:2px;
  color:var(--text-soft);
}


    /* Ascund bara veche "Mod afi»ôare / Propozi»õia 1‚Äì2" */
#screen-builder > .mode-panel{
  display:none;
}
  /* ===== Fine tuning pentru Builder ‚Äì Propozi»õia 2 ===== */

/* r√¢ndul cu bifa P2, lipit de tabel, √Æn dreapta */
.builder-enable-p2{
  margin-top: 4px;
  padding-top: 4px;
  display: flex;
  justify-content: flex-end;
  border-top: 1px dashed var(--border);
  font-size: 11px;
  color: var(--text-soft);
}

.builder-enable-p2 label{
  display: flex;
  align-items: center;
  gap: 4px;
}

/* titlul "Propozi»õia 2 (continuare / frazƒÉ)" ‚Äì aratƒÉ ca sub-titlu elegant */
#titleP2{
  margin-top: 6px;
  padding-top: 4px;
  border-top: 1px dashed var(--border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 11px;
  color: var(--text-soft);
}

#titleP2 span::before{
  content: "‚Ü≥ ";
  color: var(--accent-strong);
  font-weight: 600;
}  
 
  /* ===== TEMA PASTEL GLOBALƒÇ (v2.0) ‚Äì Raluca Korean ===== */

/* fundal general aplica»õie */
body.pastel-theme {
  background: radial-gradient(circle at top left, #ffe4ff 0%, #d7f0ff 40%, #f0e5ff 75%, #f3d4ff 100%);
  font-weight: 500;
}

/* header sus */
body.pastel-theme .rk-header {
  background: linear-gradient(120deg, #6fb8ff, #a774ff, #ff7fd1);
  color: #fff;
  box-shadow: 0 18px 45px rgba(77, 93, 255, 0.4);
  border-radius: 26px;
}

body.pastel-theme .rk-header-main h1 {
  font-weight: 900;
  letter-spacing: 0.06em;
  text-shadow: 0 3px 10px rgba(0, 0, 0, 0.25);
}

body.pastel-theme .rk-badge {
  background: rgba(255, 255, 255, 0.18);
  border-radius: 999px;
  padding-inline: 14px;
  font-weight: 600;
}

/* card-urile mari (builder, exerci»õii, lec»õii, glosar) */
body.pastel-theme .card,
body.pastel-theme .table-block,
body.pastel-theme .preview-card {
  background: radial-gradient(circle at top left, #ffffff 5%, #f7f0ff 45%, #ffe9ff 85%);
  border-radius: 26px;
  box-shadow:
    0 18px 40px rgba(70, 85, 155, 0.22),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
  border: none;
}

/* zona Rom√¢nƒÉ ‚Üí CoreeanƒÉ */
body.pastel-theme #roInput,
body.pastel-theme textarea {
  border-radius: 18px;
  border: none;
  box-shadow:
    0 10px 25px rgba(120, 140, 200, 0.18),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
  background: linear-gradient(145deg, #ffffff, #f7f4ff);
}

/* titluri mai groase peste tot */
body.pastel-theme h1,
body.pastel-theme h2,
body.pastel-theme h3 {
  font-weight: 800;
}

/* butoane ‚Äû3D pill‚Äù generale */
body.pastel-theme button,
body.pastel-theme .bottom-nav .nav-btn {
  border-radius: 999px;
  border: none;
  font-weight: 600;
  padding-inline: 18px;
  padding-block: 8px;
  box-shadow:
    0 10px 25px rgba(80, 90, 160, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
  background: linear-gradient(135deg, #4b8bff, #a55dff);
  color: #ffffff;
  transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, filter 0.1s ease-out;
}

/* butoane secundare (gri/galben/roz) ‚Äì folosim clasa existentƒÉ .secondary */
body.pastel-theme button.secondary {
  background: linear-gradient(135deg, #ffaf6b, #ff72b4);
}

/* hover/active 3D */
body.pastel-theme button:hover,
body.pastel-theme .bottom-nav .nav-btn:hover {
  transform: translateY(-1px);
  filter: brightness(1.05);
  box-shadow:
    0 14px 32px rgba(60, 80, 160, 0.42),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
}

body.pastel-theme button:active,
body.pastel-theme .bottom-nav .nav-btn:active {
  transform: translateY(1px);
  box-shadow:
    0 6px 16px rgba(50, 70, 130, 0.5),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
}

/* bara de jos ‚Äì nav */
body.pastel-theme .bottom-nav {
  background: linear-gradient(120deg, #f3e6ff, #ffe8fb);
  box-shadow: 0 -10px 25px rgba(110, 120, 190, 0.25);
  border-radius: 24px 24px 0 0;
}

body.pastel-theme .bottom-nav .nav-btn {
  background: transparent;
  box-shadow: none;
  color: #5860b0;
}

/* buton activ din nav */
body.pastel-theme .bottom-nav .nav-btn.active {
  background: linear-gradient(135deg, #5f8cff, #be6dff);
  color: #fff;
  box-shadow:
    0 8px 20px rgba(90, 90, 190, 0.45),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
}

/* mici iconi»õe rotunde (dacƒÉ folose»ôti .icon / emoji √Æn span) */
body.pastel-theme .icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 0%, #fff, rgba(255, 255, 255, 0));
  box-shadow: 0 6px 15px rgba(70, 70, 140, 0.35);
}  
    /* ===== Carduri 3D pastel pentru Builder (SUBJECT / TIME / PLACE / MOD / OBJECT / NUMERAL / COUNTER / VERB...) ===== */

body.pastel-theme #tableP1 > div {
  position: relative;
  border-radius: 22px;
  padding: 10px 12px;
  margin-bottom: 6px;
  background: radial-gradient(circle at top left, #ffffff 0%, #f3f3ff 55%, #ffe7ff 100%);
  box-shadow:
    0 12px 28px rgba(80, 90, 160, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.9) inset;
  overflow: hidden;
}

/* efect de highlight pe marginea de sus a fiecƒÉrui card */
body.pastel-theme #tableP1 > div::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(120deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0));
  opacity: 0.8;
  pointer-events: none;
}

/* textul din headerul cardului (SUBJECT, TIME, etc.) ‚Äì √Æl √Ængro»ôƒÉm */
body.pastel-theme #tableP1 > div > *:first-child {
  font-weight: 800;
  letter-spacing: 0.02em;
}

/* micƒÉ margine √Æntre header »ôi restul con»õinutului din card */
body.pastel-theme #tableP1 > div > *:nth-child(2) {
  margin-top: 4px;
}

/* nuan»õe diferite pe fiecare card, ca √Æn mockup (pe bazƒÉ de pozi»õie) */
body.pastel-theme #tableP1 > div:nth-child(1) {
  background: radial-gradient(circle at top left, #e0f0ff 0%, #b9d5ff 45%, #e3e6ff 100%);
}

body.pastel-theme #tableP1 > div:nth-child(2) {
  background: radial-gradient(circle at top left, #ffe1ea 0%, #ffc0d7 45%, #ffeaf5 100%);
}

body.pastel-theme #tableP1 > div:nth-child(3) {
  background: radial-gradient(circle at top left, #fff3d6 0%, #ffd68a 45%, #fff0d7 100%);
}

body.pastel-theme #tableP1 > div:nth-child(4) {
  background: radial-gradient(circle at top left, #d9ffe6 0%, #b4f4cf 45%, #e3fff0 100%);
}

body.pastel-theme #tableP1 > div:nth-child(5) {
  background: radial-gradient(circle at top left, #dde6ff 0%, #b5c5ff 45%, #e3e5ff 100%);
}

body.pastel-theme #tableP1 > div:nth-child(6),
body.pastel-theme #tableP1 > div:nth-child(7),
body.pastel-theme #tableP1 > div:nth-child(8) {
  background: radial-gradient(circle at top left, #f4e1ff 0%, #e3c1ff 45%, #f8e7ff 100%);
}
    /* Culori pastel Propozitia 2 (randul de jos) */
body.pastel-theme #tableP2 > div:nth-child(1) {
  background: radial-gradient(circle at top left, #ffe8ef 0%, #ffc7d9 45%, #ffeef5 100%);
}

body.pastel-theme #tableP2 > div:nth-child(2) {
  background: radial-gradient(circle at top left, #fff1da 0%, #ffe0a8 45%, #fff3dd 100%);
}

body.pastel-theme #tableP2 > div:nth-child(3) {
  background: radial-gradient(circle at top left, #e9ffe4 0%, #bfffd3 45%, #efffea 100%);
}

body.pastel-theme #tableP2 > div:nth-child(4) {
  background: radial-gradient(circle at top left, #e8f2ff 0%, #c8dcff 45%, #eef4ff 100%);
}

body.pastel-theme #tableP2 > div:nth-child(5) {
  background: radial-gradient(circle at top left, #f3e7ff 0%, #dcc4ff 45%, #f6ecff 100%);
}

body.pastel-theme #tableP2 > div:nth-child(6) {
  background: radial-gradient(circle at top left, #fff0f0 0%, #ffd6d6 45%, #fff4f4 100%);
}

body.pastel-theme #tableP2 > div:nth-child(7) {
  background: radial-gradient(circle at top left, #f0fff6 0%, #ccffe6 45%, #f2fff8 100%);
}

body.pastel-theme #tableP2 > div:nth-child(8) {
  background: radial-gradient(circle at top left, #f0f5ff 0%, #d6e3ff 45%, #f3f7ff 100%);
}
    /* ===== Butoane pastel 3D ===== */

body.pastel-theme .preview-buttons button,
body.pastel-theme #prevBtn,
body.pastel-theme #nextBtn,
body.pastel-theme #resetBtn,
body.pastel-theme #toggleRoBtn {
  border: none;
  border-radius: 18px;
  padding: 8px 14px;
  font-weight: 700;
  letter-spacing: 0.02em;
  color: #ffffff;
  box-shadow:
    0 10px 22px rgba(80, 80, 140, 0.28),
    0 0 0 1px rgba(255,255,255,.7) inset;
  transition: transform .15s ease, box-shadow .15s ease;
}

/* efect apƒÉsare */
body.pastel-theme .preview-buttons button:active,
body.pastel-theme #prevBtn:active,
body.pastel-theme #nextBtn:active,
body.pastel-theme #resetBtn:active,
body.pastel-theme #toggleRoBtn:active {
  transform: translateY(2px);
  box-shadow:
    0 4px 10px rgba(60, 60, 120, 0.25),
    0 0 0 1px rgba(255,255,255,.6) inset;
}
    /* Random propozi»õie */
body.pastel-theme #randomBtn {
  background: linear-gradient(135deg, #7a6cff, #6cc9ff);
}

/* Audio coreeanƒÉ */
body.pastel-theme #speakBtn {
  background: linear-gradient(135deg, #6cc9ff, #5be6c6);
}

/* SalveazƒÉ propozi»õia */
body.pastel-theme #favBtn {
  background: linear-gradient(135deg, #ff9a6c, #ff5f8c);
}

/* Reset pƒÉr»õi propozi»õie */
body.pastel-theme #resetBtn {
  background: linear-gradient(135deg, #ff6b6b, #ff9a6c);
}

/* Prev / Next */
body.pastel-theme #prevBtn {
  background: linear-gradient(135deg, #8aa4ff, #b1c2ff);
}
body.pastel-theme #nextBtn {
  background: linear-gradient(135deg, #9f77ff, #c188ff);
}

/* Ascunde traducerea */
body.pastel-theme #toggleRoBtn {
  background: linear-gradient(135deg, #ffa3a3, #ffc2a9);
}
    /* ===== Card Rom√¢nƒÉ ‚Üí CoreeanƒÉ ‚Äì glassmorphic ===== */

body.pastel-theme #roInput,
body.pastel-theme #roToKoResult,
body.pastel-theme #roCorrected {
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(14px);
  border-radius: 18px;
  box-shadow:
    0 12px 28px rgba(140, 130, 200, 0.25),
    0 0 0 1px rgba(255,255,255,.6) inset;
  font-weight: 600;
}
   /* Ascund DOAR textul titlului traducerii, pƒÉstrez butonul */
body.pastel-theme .preview-card #previewRoTitle span {
  display: none !important;
} 
   /* ===== Card Rom√¢nƒÉ ‚Üí CoreeanƒÉ ‚Äì glassmorphism pastel ===== */

#roCard {
  margin-top: 16px;
  padding: 16px 20px 20px;
  border-radius: 22px;
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.75),
    rgba(255, 255, 255, 0.45)
  );
  box-shadow:
    0 18px 45px rgba(131, 112, 210, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
  backdrop-filter: blur(18px);
}

#roCard h2 {
  font-size: 16px;
  font-weight: 800;
  letter-spacing: 0.03em;
  margin-bottom: 10px;
}

/* textarea de rom√¢nƒÉ */
#roCard textarea#roInput {
  width: 100%;
  border-radius: 18px;
  border: none;
  padding: 10px 14px;
  font-size: 14px;
  font-weight: 600;
  background: rgba(255, 255, 255, 0.9);
  box-shadow: 0 8px 20px rgba(135, 130, 200, 0.25);
}

/* butonul 'Tradu √Æn coreeanƒÉ' ‚Äì capsulƒÉ pastel 3D */
#roCard #roTranslateBtn {
  margin-top: 10px;
  border-radius: 999px;
  border: none;
  padding: 8px 16px;
  font-weight: 700;
  color: #ffffff;
  cursor: pointer;
  background: linear-gradient(135deg, #6b8cff, #9b6bff);
  box-shadow:
    0 10px 24px rgba(108, 110, 210, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

#roCard #roTranslateBtn:active {
  transform: translateY(2px);
  box-shadow:
    0 5px 12px rgba(108, 110, 210, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.6) inset;
}

/* rezultatul √Æn coreeanƒÉ + varianta corectatƒÉ */
#roCard #roToKoResult,
#roCard #roCorrected {
  margin-top: 10px;
  padding: 8px 12px;
  border-radius: 14px;
  background: rgba(255, 255, 255, 0.9);
  font-weight: 600;
  box-shadow: 0 6px 16px rgba(140, 135, 210, 0.25);
} 
 
   /* ===== Card Rom√¢nƒÉ ‚Üí CoreeanƒÉ ‚Äì glassmorphism pastel ===== */
#screen-builder .card {
  margin-top: 16px;
  padding: 16px 20px 20px;
  border-radius: 22px;
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.8),
    rgba(255, 255, 255, 0.5)
  );
  box-shadow:
    0 18px 45px rgba(131, 112, 210, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
  backdrop-filter: blur(18px);
}

/* titlul Rom√¢nƒÉ ‚Üí CoreeanƒÉ */
#screen-builder .card h2 {
  font-size: 16px;
  font-weight: 800;
  letter-spacing: 0.03em;
  margin-bottom: 10px;
}
/* TEXT MARE & BOLD ‚Äî bloc Rom√¢nƒÉ ‚Üí CoreeanƒÉ */
.translation-output,
#roToKrOutput,
.translation-box {
  font-size: 26px;
  font-weight: 800;
  line-height: 1.9;
  letter-spacing: 0.3px;
}
    /* textarea √Æn care scrii rom√¢na */
#screen-builder .card textarea#roInput {
  width: 100%;
  border-radius: 18px;
  border: none;
  padding: 10px 14px;
  font-size: 14px;
  font-weight: 600;
  background: rgba(255, 255, 255, 0.95);
  box-shadow: 0 8px 20px rgba(135, 130, 200, 0.25);
}

/* butonul 'Tradu √Æn coreeanƒÉ' ‚Äì capsulƒÉ 3D */
#screen-builder .card #roTranslateBtn {
  margin-top: 10px;
  border-radius: 999px;
  border: none;
  padding: 8px 16px;
  font-weight: 700;
  color: #ffffff;
  cursor: pointer;
  background: linear-gradient(135deg, #6b8cff, #9b6bff);
  box-shadow:
    0 10px 24px rgba(108, 110, 210, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

#screen-builder .card #roTranslateBtn:active {
  transform: translateY(2px);
  box-shadow:
    0 5px 12px rgba(108, 110, 210, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.6) inset;
}

/* rezultatul √Æn coreeanƒÉ + varianta corectatƒÉ */
#screen-builder .card #roToKoResult,
#screen-builder .card #roCorrected {
  margin-top: 10px;
  padding: 8px 12px;
  border-radius: 14px;
  background: rgba(255, 255, 255, 0.95);
  font-weight: 600;
  box-shadow: 0 6px 16px rgba(140, 135, 210, 0.25);
} 
    /* Carduri pƒÉr»õi propozi»õie ‚Äì stil capsule 3D */
.table-block .table-title span,
.mode-row span.section-label {
  font-weight: 800;
  letter-spacing: 0.02em;
}

/* Butoane select ‚Äì bordurƒÉ interioarƒÉ + glow fin */
.part-option {
  font-weight: 700;
  box-shadow:
    0 10px 22px rgba(120, 120, 200, 0.25),
    0 0 0 1px rgba(255, 255, 255, 0.8) inset;
  border-radius: 16px;
  backdrop-filter: blur(6px);
}
    /* Butoane principale glossy gradient */
.preview-buttons button,
.btn-group button {
  border-radius: 16px;
  font-weight: 800;
  letter-spacing: 0.02em;
  border: none;
  color: white;
  padding: 8px 14px;

  background: linear-gradient(135deg,
    rgba(140, 170, 255, 1),
    rgba(200, 130, 255, 1)
  );

  box-shadow:
    0 14px 28px rgba(140, 120, 230, 0.45),
    0 0 0 1px rgba(255, 255, 255, 0.7) inset;

  transition: transform .15s ease, box-shadow .15s ease;
}

.preview-buttons button:active,
.btn-group button:active {
  transform: translateY(2px);
  box-shadow:
    0 6px 16px rgba(140, 120, 230, 0.45),
    0 0 0 1px rgba(255, 255, 255, 0.6) inset;
}

/* Dar pƒÉstrez butonul "Ascunde traducerea" vizibil */
.preview-card .preview-title button {
  visibility: visible;
}
    /* ==== 1. FONTURI MAI GROASE PENTRU TITLURI + BUTOANE ==== */

/* Titlul mare + subtitlul de sus */
h1 {
  font-weight: 800;
  letter-spacing: 0.04em;
}

#subtitle {
  font-weight: 500;
}

/* Titlurile de sec»õiune (ex: Rom√¢nƒÉ ‚Üí CoreeanƒÉ, Exerci»õii TOPIK etc.) */
h2,
.table-title span,
.preview-title span {
  font-weight: 700;
}

/* Text pe butoane (inclusiv butoane de jos: Builder / Exerci»õii / Lec»õii / Glosar) */
button,
.nav-btn span {
  font-weight: 600;
  letter-spacing: 0.02em;
}
    /* ==== 2. BUTOANE 3D + ANIMA»öIE ==== */

/* bazƒÉ pentru TOATE butoanele */
button,
.nav-btn {
  transition:
    transform 0.12s ease-out,
    box-shadow 0.12s ease-out,
    filter 0.12s ease-out;
  transform-origin: center;
}

/* efect ‚Äûplutire‚Äù la hover (pe desktop / c√¢nd atingi u»ôor) */
button:hover,
.nav-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(0, 0, 0, 0.18);
  filter: brightness(1.03);
}

/* mic ‚ÄûapƒÉsat‚Äù la click */
button:active,
.nav-btn:active {
  transform: translateY(1px) scale(0.98);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.24);
  filter: brightness(0.98);
}

/* un pic de glow √Æn plus pentru butoanele importante (random / audio / salveazƒÉ etc.) */
button.primary,
button#randomBtn,
button#speakBtn,
button#favBtn {
  box-shadow: 0 12px 28px rgba(255, 160, 220, 0.45);
}

/* tab-ul activ din bara de jos (Builder, Exerci»õii, Lec»õii, Glosar) mai ‚Äûridicat‚Äù */
.bottom-nav .nav-btn.active {
  transform: translateY(-2px);
  box-shadow: 0 14px 32px rgba(73, 46, 180, 0.45);
}/* ==== 3. CARDURI GLOSSY PENTRU EXERCI»öII / LEC»öII / GLOSAR ==== */
#screen-builder .preview-card #previewRoTitle span {
  display: none !important;
}
    :root{
  --glass-bg: linear-gradient(145deg,#ffffff80,#ffffff20);
  --glass-border: 1px solid rgba(255,255,255,0.45);
  --glass-shadow: 0 20px 40px rgba(0,0,0,0.08);

  --grad-top: linear-gradient(120deg,#9fd6ff,#c6a7ff,#ff9acb);
  --grad-bottom: linear-gradient(120deg,#b7e2ff,#e6c8ff,#ffd1e3);
}
   

    button,
.btn {
  border-radius: 14px;
  border: none;
  padding: 10px 16px;
  font-weight: 700;
  backdrop-filter: blur(6px);
  box-shadow: 0 8px 18px rgba(0,0,0,.12);
  transform: translateY(0);
  transition: .18s ease;
}

button:hover {
  transform: translateY(-2px);
}

.btn-blue  { background: linear-gradient(120deg,#82b5ff,#5fa8ff); color:#fff; }
.btn-green { background: linear-gradient(120deg,#8df2c8,#5ed6a8); color:#044; }
.btn-pink  { background: linear-gradient(120deg,#ff9acb,#ff7fae); color:#fff; }
.btn-orange{ background: linear-gradient(120deg,#ffb585,#ff8a46); color:#552200; }
   #screen-builder .card,
#screen-builder .preview-card {
  border-radius: 24px;
}
   
   /* Iconi»õe + micro 3D pe butoanele principale din Builder */
#screen-builder #randomBtn::before,
#screen-builder #speakBtn::before,
#screen-builder #favBtn::before {
  display: inline-block;
  margin-right: 6px;
  transform: translateY(1px);
  transition: transform 0.15s ease, filter 0.15s ease;
}

/* Icon concrete */
#screen-builder #randomBtn::before  { content: "üé≤"; }
#screen-builder #speakBtn::before   { content: "üîä"; }
#screen-builder #favBtn::before     { content: "‚≠ê"; }

/* Micro 3D c√¢nd treci cu mouse-ul / atingi */
#screen-builder #randomBtn:hover::before,
#screen-builder #speakBtn:hover::before,
#screen-builder #favBtn:hover::before {
  transform: translateY(-1px) scale(1.08);
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.25));
}
 
 /* Neon focus pentru c√¢mpuri de text / select */
input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: rgba(255,255,255,0.9);
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.9),
    0 0 0 3px rgba(149, 120, 255, 0.7),
    0 0 16px rgba(149, 120, 255, 0.7);
  background-color: rgba(255,255,255,0.8);
}.bottom-nav {
  backdrop-filter: blur(18px);
}




   /* Header ‚Äì gradient care se mi»ôcƒÉ + glow subtil */
.rk-header {
  position: relative;
  z-index: 2;
  background-size: 220% 220%;          /* permite animarea gradientului existent */
  animation: headerGradient 18s ease-in-out infinite;
}

/* Aura coloratƒÉ moale √Æn jurul header-ului */
.rk-header::after {
  content: "";
  position: absolute;
  inset: -18px -26px;                  /* c√¢t de mare e ‚Äúaura‚Äù √Æn jur */
  border-radius: 32px;
  background: radial-gradient(circle at 0% 0%,  rgba(143,211,255,0.9), transparent 60%),
              radial-gradient(circle at 100% 0%, rgba(255,174,238,0.9), transparent 60%),
              radial-gradient(circle at 50% 100%, rgba(173,255,189,0.9), transparent 65%);
  filter: blur(32px);
  opacity: 0.24;
  pointer-events: none;
  z-index: -1;
  animation: headerGlow 8s ease-in-out infinite;
}

/* anima mi»ôcarea gradientului din header (folose»ôte gradientul pe care √Æl ai deja) */
@keyframes headerGradient {
  0%   { background-position: 0% 40%; }
  50%  { background-position: 100% 60%; }
  100% { background-position: 0% 40%; }
}

/* anima ‚Äúrespira»õia‚Äù aurei */
@keyframes headerGlow {
  0%, 100% {
    opacity: 0.18;
    transform: translateY(0);
  }
  50% {
    opacity: 0.32;
    transform: translateY(3px);
  }
}
    /* Containerul principal ‚Äì √Æl facem ‚Äúsuport‚Äù pentru fundalul animat */
.app {
  position: relative;
  z-index: 0;
  overflow-x: hidden;
}

/* Stratul de fundal animat, foarte subtil (sub toatƒÉ aplica»õia) */
.app::before {
  content: "";
  position: fixed;      /* rƒÉm√¢ne pe loc c√¢nd derulezi */
  inset: 0;
  z-index: -1;
  pointer-events: none;

  background:
    radial-gradient(circle at 0% 0%,     rgba(143,211,255,0.7), transparent 55%),
    radial-gradient(circle at 100% 0%,   rgba(255,174,238,0.75), transparent 55%),
    radial-gradient(circle at 0% 100%,   rgba(173,255,189,0.7), transparent 55%),
    radial-gradient(circle at 100% 100%, rgba(255,214,165,0.75), transparent 60%);
  background-size: 160% 160%;
  animation: appBgDrift 32s ease-in-out infinite alternate;
}

/* mi»ôcare foarte lentƒÉ, ‚Äúrespira»õie‚Äù de culori */
@keyframes appBgDrift {
  0% {
    background-position:
      0%   0%,
      100% 0%,
      0%   100%,
      100% 100%;
  }
  50% {
    background-position:
      12%  8%,
      88%  2%,
      6%   88%,
      94%  96%;
  }
  100% {
    background-position:
      0%   10%,
      100% 6%,
      4%   100%,
      96%  90%;
  }
}  /* Glow animat foarte subtil pe header */
.rk-header {
  position: relative;
  overflow: visible;
}

.rk-header::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 100%;
  width: 260px;
  height: 70px;
  transform: translateX(-50%);
  border-radius: 50%;
  background: radial-gradient(
    circle,
    rgba(255, 170, 255, 0.35),
    rgba(120, 160, 255, 0.18),
    rgba(255, 255, 255, 0)
  );
  filter: blur(22px);
  animation: rkGlow 6s ease-in-out infinite alternate;
  pointer-events: none;
  z-index: -1;
}

@keyframes rkGlow {
  0%   { opacity: 0.45; transform: translateX(-50%) translateY(6px) scale(1.0);}
  100% { opacity: 0.85; transform: translateX(-50%) translateY(2px) scale(1.08);}
}
  /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/* üåà Gradient animat lent pe fundal */
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

body.pastel-theme {
  background: linear-gradient(
    120deg,
    #dff3ff,
    #ffe9ff,
    #f4fffc,
    #e8f0ff
  );
  background-size: 380% 380%;
  animation: bgFlow 28s ease-in-out infinite;
}

@keyframes bgFlow {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/* ‚ú® Glow animat foarte subtil sub header */
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

.rk-header {
  position: relative;
  overflow: visible;
}

.rk-header::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 100%;
  width: 260px;
  height: 70px;
  transform: translateX(-50%);
  border-radius: 50%;
  background: radial-gradient(
    circle,
    rgba(255, 170, 255, 0.35),
    rgba(120, 160, 255, 0.18),
    rgba(255, 255, 255, 0)
  );
  filter: blur(22px);
  animation: rkGlow 6s ease-in-out infinite alternate;
  pointer-events: none;
  z-index: -1;
}

@keyframes rkGlow {
  0% {
    opacity: 0.45;
    transform: translateX(-50%) translateY(6px) scale(1.0);
  }
  100% {
    opacity: 0.85;
    transform: translateX(-50%) translateY(2px) scale(1.08);
  }
}
 /* TEXT MARE & BOLD ‚Äî preview propozi»õie coreeanƒÉ */
.preview-sentence,
#koreanPreview,
.preview-output {
  font-size: 26px;
  font-weight: 800;
  line-height: 1.9;
  letter-spacing: 0.3px;
}
    body.pastel-theme .bottom-nav:last-of-type {
  display: flex !important;
}

/* Scoate plƒÉcu»õa albƒÉ din spatele tab-urilor */
.bottom-nav .nav-btn::before {
  content: none !important;
}
 /* ===== EXTRA CLAUSES VISUAL ===== */
.clause-extra {
  margin-top: 22px;
  padding-top: 14px;
  border-top: 2px dashed rgba(120,120,120,0.25);
}

.clause-extra .table-title span {
  font-weight: 600;
  opacity: 0.85;
}

.preview-ro{
  font-size: 15px;
  opacity: 0.8;
}

.preview-hint{
  font-size: 13px;
  opacity: 0.5;
}
    
 .preview-ko{
  text-align: center;
  font-size: 22px;
  font-weight: 600;
  line-height: 1.6;
  white-space: normal;
  word-break: keep-all;
}
    #previewKo{
  white-space: normal;
}   
    #screen-builder #roCard{
  display: none;
}
    .preview-title,
.preview-ro,
.preview-hint{
  display: none !important;
}
    #screen-builder .table-title,
#screen-builder .panel-sub,
#screen-builder .clause-label {
  display:none !important;
}
    /* Preview KO ‚Äì mai compact, urcat vizual */
#previewKo{
  margin-top: 2px;
  margin-bottom: 4px;
  font-size: 22px;
  line-height: 1.45;
}

/* Mic»ôorƒÉm spa»õiul gol al cardului preview */
.preview-card{
  padding-top: 6px;
  padding-bottom: 8px;
}

/* Butoanele mai apropiate de text */
.preview-buttons{
  margin-top: 2px;
}
    /* ===== Separator Duolingo-style √Æntre propozi»õii ===== */

.story-separator{
  display:flex;
  align-items:center;
  gap:10px;
  margin:14px 0 10px;
  opacity:0.55;
}

.story-separator::before,
.story-separator::after{
  content:"";
  flex:1;
  height:1px;
  background:linear-gradient(
    90deg,
    rgba(120,120,160,0),
    rgba(120,120,160,0.35),
    rgba(120,120,160,0)
  );
}

/* bulinƒÉ soft centralƒÉ */
.story-separator span{
  font-size:10px;
  color:var(--text-soft);
  letter-spacing:0.08em;
  text-transform:uppercase;
}

/* variantƒÉ »ôi mai soft √Æn pastel-theme */
body.pastel-theme .story-separator{
  opacity:0.35;
}
    .story-separator span{
  width:6px;
  height:6px;
  border-radius:999px;
  background:rgba(140,120,255,0.35);
  font-size:0;
}
  /* ===== KO ‚Äì Card principal de lec»õie ===== */

.preview-ko{
  position:relative;
  margin: 6px 0 2px;
  padding: 14px 18px;
  border-radius: 22px;

  font-size: 26px;
  font-weight: 800;
  line-height: 1.75;
  text-align:center;

  background: linear-gradient(145deg,#ffffff,#f5f0ff);
  box-shadow:
    0 18px 38px rgba(90,70,160,0.18),
    0 0 0 1px rgba(255,255,255,0.9) inset;

  transform: translateY(-2px);
}

/* glow subtil */
.preview-ko::before{
  content:"";
  position:absolute;
  inset:-8px -12px;
  border-radius:28px;
  background: radial-gradient(
    circle,
    rgba(180,150,255,0.25),
    rgba(255,255,255,0)
  );
  filter: blur(18px);
  opacity:0.6;
  pointer-events:none;
  z-index:-1;
}

/* fade rest preview */
.preview-ro,
.preview-hint{
  opacity:0.55;
  font-size:13px;
}

/* fade general UI c√¢nd existƒÉ propozi»õie */
.preview-card.has-content ~ *{
  opacity:0.65;
  transition:0.25s ease;
}

/* men»õine butoanele clare */
.preview-buttons{
  opacity:1 !important;
}
  /* ===== Rom√¢nƒÉ ‚Üí CoreeanƒÉ ‚Äì Card modern ===== */

#screen-builder .card{
  margin-top:18px;
  padding:16px 18px 18px;
  border-radius:24px;

  background: linear-gradient(
    135deg,
    rgba(255,255,255,0.85),
    rgba(245,240,255,0.65)
  );

  box-shadow:
    0 16px 34px rgba(120,96,190,0.22),
    0 0 0 1px rgba(255,255,255,0.8) inset;

  backdrop-filter: blur(10px);
}

/* titlu */
#screen-builder .card h2{
  font-size:16px;
  font-weight:800;
  margin-bottom:8px;
  color:var(--accent-strong);
}

/* textarea */
#roInput{
  border-radius:16px;
  border:none;
  padding:10px 12px;
  font-size:14px;
  font-weight:600;

  background:rgba(255,255,255,0.95);
  box-shadow:
    0 6px 14px rgba(120,96,190,0.12),
    0 0 0 1px rgba(255,255,255,0.9) inset;
}

/* buton traducere */
#roTranslateBtn{
  margin-top:10px;
  border-radius:999px;
  padding:8px 16px;
  font-size:13px;
  font-weight:700;

  background: linear-gradient(135deg,#6b8cff,#9b6bff);
  box-shadow:0 10px 22px rgba(108,110,210,0.35);
}

/* rezultat KO */
#roToKoResult{
  margin-top:10px;
  font-size:22px;
  font-weight:800;
  text-align:center;
  line-height:1.6;
}

/* rom√¢nƒÉ corectatƒÉ */
#roCorrected{
  font-size:13px;
  opacity:0.65;
  text-align:center;
  margin-top:2px;
}
    /* compactare builder */
.table-block{
  gap:4px !important;
  padding-bottom:6px;
}

/* preview card mai apropiat */
.preview-card{
  margin-top:4px !important;
  padding-top:6px !important;
}

/* propozi»õia KO */
.preview-ko{
  margin:2px 0 4px !important;
  padding:10px 14px !important;
}

/* butoane preview */
.preview-buttons{
  margin-top:2px !important;
}

/* controls Prev/Next */
.controls{
  margin-top:2px !important;
  padding-top:4px !important;
}
    .builder-enable-p2 label{
  display:none !important;
}
   .preview-card{
  transition: all 0.25s ease;
}

/* c√¢nd existƒÉ propozi»õie */
.preview-card.has-content{
  transform: translateY(-2px);
  box-shadow: 0 10px 26px rgba(90,70,160,0.18);
} 
    .preview-ko-line{
  font-size: 20px;
  font-weight: 500;
  margin-top: 6px;
}

.preview-ro-line{
  font-size: 14px;
  opacity: 0.65;
  margin-top: 2px;
}
    .roko-card{
  margin-top: 10px;
}
.preview-card{
  background: rgba(255,255,255,0.65);
  backdrop-filter: blur(10px);
  border-radius: 26px;
  padding: 26px 28px;
  margin: 18px 0;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

.preview-ko{
  font-size: 26px;
  font-weight: 600;
  text-align: center;
  margin-bottom: 14px;
}

.preview-ro{
  font-size: 18px;
  text-align: center;
  opacity: 0.85;
}

/* textarea stil identic */
.ro-input-card textarea{
  width: 100%;
  min-height: 90px;
  border: none;
  outline: none;
  resize: none;
  font-size: 18px;
  background: transparent;
  text-align: center;
}
    .top-nav-buttons{
  margin-top:12px;
  display:flex;
  gap:10px;
  justify-content:center;
}   
    /* HEADER PREMIUM LAYOUT */

.rk-header-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.rk-header-left{
  display:flex;
  align-items:center;
  gap:12px;
}

.rk-header-actions{
  display:flex;
  gap:10px;
}

.header-btn{
  background:rgba(255,255,255,0.25);
  border:1px solid rgba(255,255,255,0.4);
  backdrop-filter:blur(6px);
  border-radius:12px;
  padding:8px 14px;
  font-size:16px;
  cursor:pointer;
  transition:0.25s;
}

.header-btn:hover{
  transform:translateY(-2px);
  background:rgba(255,255,255,0.4);
}
    /* CONTROLS PREMIUM */

.controls{
  margin:40px 0;
  display:flex;
  justify-content:center;
  gap:20px;
}

.nav-btn{
  padding:10px 22px;
  border-radius:14px;
  border:none;
  background:linear-gradient(135deg,#8f9bff,#6a5acd);
  color:white;
  font-weight:600;
  cursor:pointer;
  transition:0.25s;
}

.nav-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 18px rgba(0,0,0,0.2);
}
   /* ===== COMPACT PREVIEW CONTROLS ===== */

.compact-controls{
  margin-top:18px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:14px;
}

.icon-btn{
  width:42px;
  height:42px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,0.25);
  backdrop-filter:blur(8px);
  font-size:18px;
  cursor:pointer;
  transition:0.25s;
  display:flex;
  align-items:center;
  justify-content:center;
}

.icon-btn:hover{
  transform:translateY(-3px);
  background:rgba(255,255,255,0.4);
  box-shadow:0 6px 18px rgba(0,0,0,0.15);
}

/* Prev st√¢nga ‚Äì Next dreapta accent u»ôor */

.nav-left{
  margin-right:6px;
}

.nav-right{
  margin-left:6px;

}
  </style>
</head>
<body class="pastel-theme">
  <div class="app">

    <!-- HEADER -->
    <header class="rk-header">

  <div class="rk-header-row">
    
    <div class="rk-header-left">
      <h1>Raluca Korean</h1>
      <span class="rk-badge">Study App v2.0</span>
    </div>

    <div class="rk-header-actions">
      <button id="homeBtn" class="header-btn">üè†</button>
      <button id="refreshBtn" class="header-btn">üîÑ</button>
    </div>

  </div>

  <p id="subtitle">
    Builder propozi»õii + particule + audio + conjugƒÉri
  </p>

</header>
    <!-- SCREEN BUILDER -->
    <div class="screen active" id="screen-builder">

      <!-- MODE PANEL -->
      <div class="mode-panel">

        <div class="mode-row">
          <span class="section-label">Mod afi»ôare</span>
          <div>
            <button class="secondary small-mode-btn" data-mode="simple">Simplu</button>
            <button class="secondary small-mode-btn active" data-mode="topik">TOPIK</button>
          </div>
        </div>

        <div class="mode-row">
          <span class="section-label">Propozi»õia 1 ‚Äì ce pƒÉr»õi folose»ôte?</span>
          <div class="part-toggles" id="togglesP1"></div>
        </div>

        <div class="mode-row">
          <span class="section-label">Propozi»õia 2 ‚Äì ce pƒÉr»õi folose»ôte?</span>
          <div class="part-toggles" id="togglesP2"></div>
        </div>

      </div>

      <!-- TABLES -->
      <div class="table-block">

        <div class="table-title">
          <span>Propozi»õia 1</span>
        </div>
        <div class="table-horizontal" id="tableP1"></div>

        <div class="story-separator"><span></span></div>

        <div class="table-title hidden" id="titleP2">
          <span>Propozi»õia 2</span>
        </div>
        <div class="table-horizontal hidden" id="tableP2"></div>

      </div>

      <!-- EXTRA CLAUSES -->
      <div id="extra-clauses"></div>

      <!-- PREVIEW KO -->
      <div class="preview-card">

        <div class="preview-title">
          <span>Propozi»õia / fraza (coreeanƒÉ)</span>
        </div>

        <div class="preview-ko" id="previewKo">
          (alege cuvinte din tabel)
        </div>

        <div class="preview-ro" id="previewRo"></div>
        <div class="preview-hint" id="naturalHint"></div>
<div class="preview-buttons compact-controls">

  <button id="prevBtn" class="icon-btn nav-left">‚óÄ</button>

  <button id="randomBtn" class="icon-btn">üé≤</button>

  <button id="speakBtn" class="icon-btn">üîä</button>

  <button id="favBtn" class="icon-btn">üíæ</button>

  <button id="nextBtn" class="icon-btn nav-right">‚ñ∂</button>

</div>      
      </div>

     
      <!-- ENABLE P2 -->
 <div class="builder-enable-p2">
  <label>
    <input type="checkbox" id="enableP2">
    Propozi»õia 2
  </label>
</div>
      <!-- RO INPUT -->
<div class="card">
  <h2>Rom√¢nƒÉ ‚Üí CoreeanƒÉ</h2>

  <textarea id="roInput" rows="3"
    placeholder="Scrie propozi»õia √Æn rom√¢nƒÉ aici..."></textarea>

  <button id="roTranslateBtn">
    <span class="translate-icon">üá∑üá¥ ‚û° üá∞üá∑</span>
    Tradu √Æn coreeanƒÉ
  </button>
</div>
      <!-- LEGEND -->
      <div class="legend">
        ‚û§ Tap scurt pe coloanƒÉ = treci la urmƒÉtorul cuv√¢nt.  
        ‚û§ »öine apƒÉsat pe coloanƒÉ = lista completƒÉ.  
        ‚û§ ‚≠ê la CONJUGƒÇRI = gramaticƒÉ de legƒÉturƒÉ.  
        ‚û§ Sistem conjugare realƒÉ.
      </div>

    </div>
  </div>

  <!-- PANEL OVERLAY -->
  <div class="overlay hidden" id="overlay">
    <div class="panel">

      <div class="panel-header">
        <div>
          <div class="panel-title" id="panelTitle"></div>
          <div class="panel-sub" id="panelSub"></div>
        </div>
        <button class="panel-close" id="closePanelBtn">‚úï</button>
      </div>

      <div class="panel-input-row">
        <input type="text" id="panelSearchInput"
          placeholder="CautƒÉ √Æn listƒÉ..." />
      </div>

      <div class="panel-input-row">
        <input type="text" id="newWordInput"
          placeholder="Cuv√¢nt nou..." />
      </div>

      <div class="panel-input-row">
        <input type="text" id="newWordTransInput"
          placeholder="Traducere RO (op»õional)" />
        <button id="addWordBtn" class="secondary">+ Add</button>
      </div>

      <div class="panel-list" id="panelList"></div>

    </div>
  </div>
   <script>
/* ============================================================
   builder.js (UNIFIED, cap-coadƒÉ, robust, fƒÉrƒÉ duplicƒÉri)
   - ArhitecturƒÉ complet dinamicƒÉ: 1..N propozi»õii
   - Compatibil cu HTML-ul tƒÉu (id-uri existente) »ôi nu crapƒÉ dacƒÉ lipsesc
   - Panel (long press), chips, toggles, preview KO/RO, audio, favorites,
     custom words + localStorage, parser RO‚Üístate, linking conjugations
   ============================================================ */

/* =========================
   0) SAFE DOM HELPERS
   ========================= */
const $  = (sel, root = document) => root.querySelector(sel);
const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
const on = (el, ev, fn, opt) => el && el.addEventListener(ev, fn, opt);
const text = (el, v) => { if (el) el.textContent = v; };
const show = (el) => el && el.classList.remove("hidden");
const hide = (el) => el && el.classList.add("hidden");

/* =========================
   1) DATA: LISTE + TRADUCERI
   ========================= */

/* === LISTE DE CUVINTE (de bazƒÉ) === */
const subjects = [
  "Ï†Ä","ÎÇò","ÎÑà","Ïö∞Î¶¨","ÎÑàÌù¨","ÏÇ¨Îûå","ÌïôÏÉù","ÏÑ†ÏÉùÎãò","ÏßÅÏõê","Ï†ÑÎ¨∏Í∞Ä","ÏßÄÏõêÏûê","Í¥ÄÎ¶¨Ïûê",
  "Î∂ÄÎ™®Îãò","ÏïÑÏù¥","Ïñ¥Î•∏","ÏãúÎØº","Í≥†Í∞ù","ÏùòÏÇ¨","Í∞ÑÌò∏ÏÇ¨","Ïó∞Íµ¨Ïûê","Í¥ÄÍ≥ÑÏûê","ÎåÄÌëú","ÌöåÏû•",
  "ÏÇ¨Ïö©Ïûê","Ï∞∏Í∞ÄÏûê","Ïö¥Ï†ÑÏûê","Ï£ºÎØº","ÌôòÏûê"
];

const subjectAdjectives = [
  "ÏòàÏÅú", "Ï∞©Ìïú", "ÎòëÎòëÌïú", "ÌÇ§Í∞Ä ÌÅ∞", "Ï†äÏùÄ", "ÎäôÏùÄ"
];

const times = [
  "Ïò§Îäò","Ïñ¥Ï†ú","ÎÇ¥Ïùº","ÏßÄÍ∏à","Î∞©Í∏à","Ï°∞Í∏à ÌõÑÏóê","Í≥ß","ÏµúÍ∑ºÏóê","ÏöîÏ¶ò","ÎßàÏπ®ÎÇ¥","Í≤∞Íµ≠",
  "Ïù¥Ï†ÑÏóê","Ïù¥ÌõÑÏóê","ÎãπÏãúÏóê","ÌïúÎèôÏïà","Í≥ÑÏÜç","Í∞ÄÎÅî","Ìï≠ÏÉÅ","ÏûêÏ£º","Ï†êÏ†ê","Ï∞®Ï∏∞","ÏùºÏ∞ç","Îä¶Í≤å"
];

const places = [
  "Ïßë","ÌïôÍµê","ÌöåÏÇ¨","ÏãùÎãπ","Ïπ¥Ìéò","ÎèÑÏÑúÍ¥Ä","Î≥ëÏõê","ÏãúÏû•","Î∞±ÌôîÏ†ê","Í≥µÌï≠","Í∏∞Ï∞®Ïó≠",
  "Î≤ÑÏä§Ï†ïÎ•òÏû•","Ïó∞Íµ¨ÏÜå","Í∏∞Í¥Ä","ÏßÄÏó≠ÏÇ¨Ìöå","ÌôòÍ≤Ω","ÎåÄÍ∏∞ÏóÖ","ÌöåÏùòÏã§","Î≤ïÏõê","Í≤ΩÏ∞∞ÏÑú",
  "Ìï¥Î≥Ä","ÏÇ∞","Í≥µÏõê","ÏùÄÌñâ"
];

const mods = [
  "Ïûò","Ïó¥Ïã¨Ìûà","Ï°∞Ïö©Ìûà","Ï≤úÏ≤úÌûà","Îπ®Î¶¨","Ï†ïÎßê","ÏïÑÏ£º","ÎÑàÎ¨¥","ÎßéÏù¥","Ï°∞Í∏à","Í∞ëÏûêÍ∏∞","ÎØ∏Î¶¨",
  "Î≤åÏç®","ÏïÑÍπå","Î∞©Í∏à","Í∏àÎ∞©","Í≥ß","Ìï≠ÏÉÅ","ÏûêÏ£º","Í∞ÄÎÅî","ÎìúÎ¨ºÍ≤å","ÏÉÅÎãπÌûà","ÍΩ§","ÎèÑÎåÄÏ≤¥","Ï†àÎåÄÎ°ú",
  "Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú","Ï∂©Î∂ÑÌûà","ÌäπÌûà","Ïò§ÌûàÎ†§","Ï†êÏ†ê","Ï∞®Ï∏∞","Í≥ÑÏÜç"
];

const objectAdjectives = [
  "ÏòàÏÅú", "ÎßõÏûàÎäî", "ÌÅ∞", "ÏûëÏùÄ", "ÏÉàÎ°úÏö¥", "Ïò§ÎûòÎêú"
];

const objects = [
  "Ï±Ö","Ïª§Ìîº","Î¨º","ÏùåÏãù","ÏòÅÌôî","Í∞ÄÎ∞©","Ï†ÑÌôî","Ïò∑","ÏûêÎ£å","Îç∞Ïù¥ÌÑ∞","Í≥ÑÌöç","Ï°∞Í±¥","ÏÉÅÌô©","Î¨∏Ï†ú",
  "Ìï¥Í≤∞Ï±Ö","ÏöîÏïΩ","Î≥¥Í≥†ÏÑú","Î¨∏ÏÑú","Ïª¥Ìì®ÌÑ∞","ÎÖ∏Ìä∏Î∂Å","Ìé∏ÏßÄ","ÏÑ†Î¨º","ÏùòÍ≤¨","Ï†ïÎ≥¥","Í¥ÄÍ≥Ñ","Í≤∞Í≥º",
  "ÏõêÏù∏","Î∞©Î≤ï","Ï†úÌíà","ÏÑúÎπÑÏä§","Ï†ïÏ±Ö","Î¨∏Ìôî","Ï±ÑÏÜå","Í≤¨Í≥ºÎ•ò"
];

const numerals = new Array(60).fill("");
const counters = [
  "Í∞ú","Î™Ö","Í∂å","Ïû•","ÎåÄ","Î≥ë","Ïûî","ÎßàÎ¶¨","Î≤à","ÏÇ¥","ÏÜ°Ïù¥","Ï§Ñ","Ï†ê","Í±¥","Ìöå","Í∞ÄÏßÄ","Ï™Ω"
];

const verbs = [
  "Í∞ÄÎã§","Ïò§Îã§","Î®πÎã§","ÎßàÏãúÎã§","Î≥¥Îã§","ÏùΩÎã§","Ïì∞Îã§","Î∞∞Ïö∞Îã§","ÏÇ¨Îã§","Ï£ºÎã§","Î∞õÎã§","ÏùºÌïòÎã§",
  "Í≥µÎ∂ÄÌïòÎã§","ÏöîÎ¶¨ÌïòÎã§","Ï≤≠ÏÜåÌïòÎã§","Ï§ÄÎπÑÌïòÎã§","ÎèÑÏôÄÏ£ºÎã§","ÏÇ¨Ïö©ÌïòÎã§","ÌïÑÏöîÌïòÎã§","Ï¢ãÏïÑÌïòÎã§",
  "Ïã´Ïñ¥ÌïòÎã§","Í∏∞Îã§Î¶¨Îã§","Ïâ¨Îã§","ÎßåÎÇòÎã§","Í±∑Îã§","Îã¨Î¶¨Îã§","ÏïâÎã§","ÏÑúÎã§","Í≤∞Ï†ïÌïòÎã§","Ï†úÏïàÌïòÎã§",
  "Ï†ÑÎã¨ÌïòÎã§","Ïú†ÏßÄÌïòÎã§","Î∞úÏÉùÌïòÎã§","Ï¶ùÍ∞ÄÌïòÎã§","Í∞êÏÜåÌïòÎã§","Ïù∏Ï†ïÌïòÎã§","Î∂ÑÏÑùÌïòÎã§","Í¥ÄÏ∞∞ÌïòÎã§",
  "Ìï¥Í≤∞ÌïòÎã§","Ïó∞Íµ¨ÌïòÎã§","ÌòëÎ†•ÌïòÎã§","ÏöîÏ≤≠ÌïòÎã§","Ï∂©Ï°±ÌïòÎã§","ÎπÑÍµêÌïòÎã§","ÏÑ§Î™ÖÌïòÎã§","ÏòàÏÉÅÌïòÎã§"
];

const conjugations = [
  "-ÏïÑÏöî/Ïñ¥Ïöî","-ÏïòÏñ¥Ïöî/ÏóàÏñ¥Ïöî","-Í≥† ÏûàÏñ¥Ïöî","-Í≥† Ïã∂Ïñ¥Ïöî","-(Ïúº)ÏÑ∏Ïöî","-(Ïúº)„Ñπ Í±∞ÏòàÏöî",
  "-Í≥†","-ÏßÄ ÎßàÏÑ∏Ïöî","-ÏïÑ/Ïñ¥ Ï£ºÏÑ∏Ïöî","-ÏïÑ/Ïñ¥Ïïº ÎèºÏöî","-(Ïúº)„Ñπ Ïàò ÏûàÏñ¥Ïöî","-(Ïúº)„Ñπ Ïàò ÏóÜÏñ¥Ïöî",
  "-ÎçîÎùºÍ≥†Ïöî","-ÎÑ§Ïöî","-Íµ∞Ïöî","-Í≥† ÎÇòÏÑú","-Í∏∞ Ï†ÑÏóê","-(Ïúº)Î©¥ÏÑú","-(Ïúº)Î©∞",
  "-(Ïúº)„ÑπÏßÄÎèÑ Î™∞ÎùºÏöî","-(Ïúº)„ÑπÍ≤åÏöî","-(Ïúº)„ÑπÎûòÏöî?","-(Ïúº)„ÑπÍπåÏöî?","-Îäî Í≤å Ïñ¥ÎïåÏöî?",
  "-Îäî Ï§ëÏù¥ÏóêÏöî","-ÏïÑ/Ïñ¥ÎèÑ ÎèºÏöî","-(Ïúº)Î©¥ Ïïà ÎèºÏöî","-(Ïúº)ÎÇò","-(Ïúº)ÎØÄÎ°ú","-(Ïúº)„Ñ¥/Îäî ÎßåÌÅº",
  "-(Ïúº)„ÑπÏàòÎ°ù","-(Ïúº)„Ñ¥/ÎäîÎç∞ÎèÑ","-(Ïúº)„ÑπÏßÄÎùºÎèÑ","-(Ïúº)„Ñ¥/Îäî Î∞òÎ©¥Ïóê","-ÎèÑÎ°ù ÌïòÎã§",
  "-Í≤å ÎêòÎã§","-ÏïÑ/Ïñ¥ÏßÄÎã§","-Í∏∞ ÎßàÎ†®Ïù¥Îã§","-Í∏∞Ïóê","-Í∏∏Îûò","-Í≥† ÎßêÎã§","-Í≥†Ïûê ÌïòÎã§","-(Ïúº)„Ñπ ÎøêÏù¥Îã§"
];

/* === TRADUCERI (coreeanƒÉ ‚Üí rom√¢nƒÉ) === */
const translations = {
  subject:{ "Ï†Ä":"eu (formal)","ÎÇò":"eu (informal)","ÎÑà":"tu","Ïö∞Î¶¨":"noi","ÎÑàÌù¨":"voi",
    "ÏÇ¨Îûå":"persoanƒÉ","ÌïôÏÉù":"student/ƒÉ","ÏÑ†ÏÉùÎãò":"profesor","ÏßÅÏõê":"angajat",
    "Î∂ÄÎ™®Îãò":"pƒÉrin»õi","ÏïÑÏù¥":"copil","Ïñ¥Î•∏":"adult","Í≥†Í∞ù":"client","ÏùòÏÇ¨":"medic",
    "Í∞ÑÌò∏ÏÇ¨":"asistentƒÉ","Ïó∞Íµ¨Ïûê":"cercetƒÉtor","ÎåÄÌëú":"reprezentant","ÌôòÏûê":"pacient"
  },
  subjectAdj:{}, // optional
  time:{ "Ïò§Îäò":"astƒÉzi","Ïñ¥Ï†ú":"ieri","ÎÇ¥Ïùº":"m√¢ine","ÏßÄÍ∏à":"acum","Î∞©Í∏à":"tocmai acum",
    "Ï°∞Í∏à ÌõÑÏóê":"pu»õin mai t√¢rziu","Í≥ß":"√Æn cur√¢nd","ÏµúÍ∑ºÏóê":"recent","ÏöîÏ¶ò":"√Æn ultima vreme",
    "ÎßàÏπ®ÎÇ¥":"√Æn cele din urmƒÉ","Í≤∞Íµ≠":"p√¢nƒÉ la urmƒÉ","Ïù¥Ï†ÑÏóê":"√Ænainte","Ïù¥ÌõÑÏóê":"dupƒÉ",
    "ÎãπÏãúÏóê":"atunci","ÌïúÎèôÏïà":"o perioadƒÉ","Í≥ÑÏÜç":"continuƒÉ","Í∞ÄÎÅî":"din c√¢nd √Æn c√¢nd",
    "Ìï≠ÏÉÅ":"√Æntotdeauna","ÏûêÏ£º":"des","Ï†êÏ†ê":"din ce √Æn ce","Ï∞®Ï∏∞":"treptat",
    "ÏùºÏ∞ç":"devreme","Îä¶Í≤å":"t√¢rziu"
  },
  place:{ "Ïßë":"acasƒÉ","ÌïôÍµê":"»ôcoalƒÉ","ÌöåÏÇ¨":"firmƒÉ / companie","ÏãùÎãπ":"restaurant","Ïπ¥Ìéò":"cafenea",
    "ÎèÑÏÑúÍ¥Ä":"bibliotecƒÉ","Î≥ëÏõê":"spital","ÏãúÏû•":"pia»õƒÉ","Î∞±ÌôîÏ†ê":"magazin universal",
    "Í≥µÌï≠":"aeroport","Í∏∞Ï∞®Ïó≠":"garƒÉ","Î≤ÑÏä§Ï†ïÎ•òÏû•":"sta»õie de autobuz","Ïó∞Íµ¨ÏÜå":"laborator",
    "Í∏∞Í¥Ä":"institu»õie","ÏßÄÏó≠ÏÇ¨Ìöå":"comunitate","ÌôòÍ≤Ω":"mediu","ÎåÄÍ∏∞ÏóÖ":"corpora»õie mare",
    "ÌöåÏùòÏã§":"salƒÉ de »ôedin»õe","Î≤ïÏõê":"instan»õƒÉ","Í≤ΩÏ∞∞ÏÑú":"sec»õie de poli»õie",
    "Ìï¥Î≥Ä":"plajƒÉ","ÏÇ∞":"munte","Í≥µÏõê":"parc","ÏùÄÌñâ":"bancƒÉ"
  },
  mod:{ "Ïûò":"bine","Ïó¥Ïã¨Ìûà":"cu s√¢rguin»õƒÉ","Ï°∞Ïö©Ìûà":"√Æn lini»ôte","Ï≤úÏ≤úÌûà":"√Æncet",
    "Îπ®Î¶¨":"repede","Ï†ïÎßê":"cu adevƒÉrat","ÏïÑÏ£º":"foarte","ÎÑàÎ¨¥":"prea / foarte",
    "ÎßéÏù¥":"mult","Ï°∞Í∏à":"pu»õin","Í∞ëÏûêÍ∏∞":"brusc","ÎØ∏Î¶¨":"√Æn avans","Î≤åÏç®":"deja",
    "ÏïÑÍπå":"mai devreme","Î∞©Í∏à":"chiar acum","Í∏àÎ∞©":"imediat","Í≥ß":"√Æn cur√¢nd",
    "Ìï≠ÏÉÅ":"mereu","ÏûêÏ£º":"des","Í∞ÄÎÅî":"din c√¢nd √Æn c√¢nd","ÎìúÎ¨ºÍ≤å":"rar",
    "ÏÉÅÎãπÌûà":"destul de","ÍΩ§":"bini»ôor","ÎèÑÎåÄÏ≤¥":"(deloc / √Æn √ÆntrebƒÉri)",
    "Ï†àÎåÄÎ°ú":"niciodatƒÉ (interdic»õie)","Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú":"activ","Ï∂©Î∂ÑÌûà":"suficient",
    "ÌäπÌûà":"√Æn special","Ïò§ÌûàÎ†§":"mai degrabƒÉ","Ï†êÏ†ê":"din ce √Æn ce","Ï∞®Ï∏∞":"treptat",
    "Í≥ÑÏÜç":"√Æn mod continuu"
  },
  object:{
    "Ï±Ö":"carte","Ïª§Ìîº":"cafea","Î¨º":"apƒÉ","ÏùåÏãù":"m√¢ncare","ÏòÅÌôî":"film",
    "Í∞ÄÎ∞©":"geantƒÉ","Ï†ÑÌôî":"telefon","Ïò∑":"haine","ÏûêÎ£å":"materiale","Îç∞Ïù¥ÌÑ∞":"date",
    "Í≥ÑÌöç":"plan","Ï°∞Í±¥":"condi»õie","ÏÉÅÌô©":"situa»õie","Î¨∏Ï†ú":"problemƒÉ",
    "Ìï¥Í≤∞Ï±Ö":"solu»õie","ÏöîÏïΩ":"rezumat","Î≥¥Í≥†ÏÑú":"raport","Î¨∏ÏÑú":"document",
    "Ïª¥Ìì®ÌÑ∞":"calculator","ÎÖ∏Ìä∏Î∂Å":"laptop","Ìé∏ÏßÄ":"scrisoare","ÏÑ†Î¨º":"cadou",
    "ÏùòÍ≤¨":"opinie","Ï†ïÎ≥¥":"informa»õie","Í¥ÄÍ≥Ñ":"rela»õie","Í≤∞Í≥º":"rezultat",
    "ÏõêÏù∏":"cauzƒÉ","Î∞©Î≤ï":"metodƒÉ","Ï†úÌíà":"produs","ÏÑúÎπÑÏä§":"serviciu",
    "Ï†ïÏ±Ö":"politicƒÉ","Î¨∏Ìôî":"culturƒÉ","Ï±ÑÏÜå":"legume","Í≤¨Í≥ºÎ•ò":"alune / nuci"
  },
  objectAdj:{}, // optional
  numeral:{},
  counter:{ "Í∞ú":"bucatƒÉ","Î™Ö":"persoanƒÉ","Í∂å":"volum (carte)","Ïû•":"foaie / paginƒÉ",
    "ÎåÄ":"aparat / vehicul","Î≥ë":"sticlƒÉ","Ïûî":"canƒÉ / pahar",
    "ÎßàÎ¶¨":"animal","Î≤à":"datƒÉ","ÏÇ¥":"ani (v√¢rstƒÉ)","ÏÜ°Ïù¥":"buchet / ciorchine",
    "Ï§Ñ":"r√¢nd / »ôir","Ï†ê":"punct","Í±¥":"caz","Ìöå":"datƒÉ (ocazie)",
    "Í∞ÄÏßÄ":"fel / tip","Ï™Ω":"paginƒÉ / direc»õie"
  },
  verb:{
    "Í∞ÄÎã§":"a merge","Ïò§Îã§":"a veni","Î®πÎã§":"a m√¢nca","ÎßàÏãúÎã§":"a bea","Î≥¥Îã§":"a vedea / a se uita",
    "ÏùΩÎã§":"a citi","Ïì∞Îã§":"a scrie","Î∞∞Ïö∞Îã§":"a √ÆnvƒÉ»õa","ÏÇ¨Îã§":"a cumpƒÉra","Ï£ºÎã§":"a da",
    "Î∞õÎã§":"a primi","ÏùºÌïòÎã§":"a lucra","Í≥µÎ∂ÄÌïòÎã§":"a studia","ÏöîÎ¶¨ÌïòÎã§":"a gƒÉti",
    "Ï≤≠ÏÜåÌïòÎã§":"a face curat","Ï§ÄÎπÑÌïòÎã§":"a pregƒÉti","ÎèÑÏôÄÏ£ºÎã§":"a ajuta",
    "ÏÇ¨Ïö©ÌïòÎã§":"a folosi","ÌïÑÏöîÌïòÎã§":"a fi necesar","Ï¢ãÏïÑÌïòÎã§":"a plƒÉcea",
    "Ïã´Ïñ¥ÌïòÎã§":"a nu plƒÉcea / a ur√Æ","Í∏∞Îã§Î¶¨Îã§":"a a»ôtepta","Ïâ¨Îã§":"a se odihni",
    "ÎßåÎÇòÎã§":"a se √Ænt√¢lni","Í±∑Îã§":"a merge pe jos","Îã¨Î¶¨Îã§":"a alerga",
    "ÏïâÎã§":"a se a»ôeza","ÏÑúÎã§":"a sta √Æn picioare","Í≤∞Ï†ïÌïòÎã§":"a decide",
    "Ï†úÏïàÌïòÎã§":"a propune","Ï†ÑÎã¨ÌïòÎã§":"a transmite","Ïú†ÏßÄÌïòÎã§":"a men»õine",
    "Î∞úÏÉùÌïòÎã§":"a se produce","Ï¶ùÍ∞ÄÌïòÎã§":"a cre»ôte","Í∞êÏÜåÌïòÎã§":"a scƒÉdea",
    "Ïù∏Ï†ïÌïòÎã§":"a recunoa»ôte","Î∂ÑÏÑùÌïòÎã§":"a analiza","Í¥ÄÏ∞∞ÌïòÎã§":"a observa",
    "Ìï¥Í≤∞ÌïòÎã§":"a rezolva","Ïó∞Íµ¨ÌïòÎã§":"a cerceta","ÌòëÎ†•ÌïòÎã§":"a colabora",
    "ÏöîÏ≤≠ÌïòÎã§":"a solicita","Ï∂©Ï°±ÌïòÎã§":"a satisface","ÎπÑÍµêÌïòÎã§":"a compara",
    "ÏÑ§Î™ÖÌïòÎã§":"a explica","ÏòàÏÉÅÌïòÎã§":"a anticipa"
  },
  conjug:{
    "-ÏïÑÏöî/Ïñ¥Ïöî":"prezent politicos",
    "-ÏïòÏñ¥Ïöî/ÏóàÏñ¥Ïöî":"trecut politicos",
    "-Í≥† ÏûàÏñ¥Ïöî":"ac»õiune √Æn desfƒÉ»ôurare",
    "-Í≥† Ïã∂Ïñ¥Ïöî":"vreau sƒÉ...",
    "-Í≥†":"»ôi",
    "-(Ïúº)ÏÑ∏Ïöî":"imperativ / onorific",
    "-(Ïúº)„Ñπ Í±∞ÏòàÏöî":"viitor",
    "-ÏßÄ ÎßàÏÑ∏Ïöî":"nu face»õi..., vƒÉ rog",
    "-ÏïÑ/Ïñ¥ Ï£ºÏÑ∏Ïöî":"vƒÉ rog sƒÉ...",
    "-ÏïÑ/Ïñ¥Ïïº ÎèºÏöî":"trebuie sƒÉ...",
    "-(Ïúº)„Ñπ Ïàò ÏûàÏñ¥Ïöî":"pot sƒÉ...",
    "-(Ïúº)„Ñπ Ïàò ÏóÜÏñ¥Ïöî":"nu pot sƒÉ...",
    "-ÎçîÎùºÍ≥†Ïöî":"am observat cƒÉ...",
    "-ÎÑ§Ïöî":"exclamativ (observa»õie surprinsƒÉ)",
    "-Íµ∞Ïöî":"exclamativ (constatare)",
    "-Í≥† ÎÇòÏÑú":"dupƒÉ ce...",
    "-Í∏∞ Ï†ÑÏóê":"√Ænainte sƒÉ...",
    "-(Ïúº)Î©¥ÏÑú":"√Æn timp ce...",
    "-(Ïúº)Î©∞":"»ôi (√Æn timp ce)",
    "-(Ïúº)„ÑπÏßÄÎèÑ Î™∞ÎùºÏöî":"s-ar putea sƒÉ...",
    "-(Ïúº)„ÑπÍ≤åÏöî":"voi face (pentru tine)",
    "-(Ïúº)„ÑπÎûòÏöî?":"ai chef sƒÉ...? / vreau sƒÉ...",
    "-(Ïúº)„ÑπÍπåÏöî?":"sƒÉ facem...?",
    "-Îäî Í≤å Ïñ¥ÎïåÏöî?":"ce-ar fi sƒÉ...?",
    "-Îäî Ï§ëÏù¥ÏóêÏöî":"sunt √Æn mijlocul ac»õiunii",
    "-ÏïÑ/Ïñ¥ÎèÑ ÎèºÏöî":"po»õi sƒÉ..., e √Æn regulƒÉ",
    "-(Ïúº)Î©¥ Ïïà ÎèºÏöî":"nu ai voie sƒÉ...",
    "-ÎèÑÎ°ù ÌïòÎã§":"sƒÉ faci √Æn a»ôa fel √Ænc√¢t sƒÉ...",
    "-Í≤å ÎêòÎã§":"ajungi sƒÉ...",
    "-ÏïÑ/Ïñ¥ÏßÄÎã§":"a deveni...",
    "-Í∏∞Ïóê":"pentru cƒÉ..., fiindcƒÉ",
    "-Í∏∏Îûò":"pentru cƒÉ (am vƒÉzut / sim»õit eu)",
    "-Í≥† ÎßêÎã§":"√Æn cele din urmƒÉ ajunge sƒÉ...",
    "-Í≥†Ïûê ÌïòÎã§":"a inten»õiona sƒÉ...",
    "-(Ïúº)„Ñπ ÎøêÏù¥Îã§":"doar..., nimic altceva"
  }
};

/* =========================
   2) STORAGE: CUSTOM WORDS
   ========================= */
const STORAGE_KEY = "ralucaKoreanCustomWords_v3_dynamic";
const customData = {
  subject:[], subjectAdj:[],
  time:[], place:[], mod:[],
  object:[], objectAdj:[],
  numeral:[], counter:[],
  verb:[], conjug:[]
};

function loadCustomData(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return;
    const saved = JSON.parse(raw);
    Object.keys(customData).forEach(k=>{
      if(Array.isArray(saved[k])) customData[k] = saved[k];
    });

    const listMap = {
      subject: subjects,
      subjectAdj: subjectAdjectives,
      time: times,
      place: places,
      mod: mods,
      object: objects,
      objectAdj: objectAdjectives,
      numeral: numerals,
      counter: counters,
      verb: verbs,
      conjug: conjugations
    };

    Object.entries(customData).forEach(([key,arr])=>{
      arr.forEach(entry=>{
        if(!entry || !entry.word) return;
        const w = entry.word;
        const ro = entry.ro || "";

        const list = listMap[key];
        if(list && !list.includes(w)) list.push(w);

        if(!translations[key]) translations[key] = {};
        if(ro) translations[key][w] = ro;
      });
    });
  }catch(e){}
}

function saveCustomData(){
  try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(customData)); }catch(e){}
}

loadCustomData();

/* =========================
   3) COLUMNS CONFIG
   ========================= */
const columns = [
  {key:"subject",    title:"SUBJECT",      ko:"Ï£ºÏñ¥",     data:subjects,           hint:"Cine?", allowCustom:true},
  {key:"subjectAdj", title:"ADJ (SUBJECT)",ko:"ÌòïÏö©ÏÇ¨",   data:subjectAdjectives,  hint:"Cum este subiectul?", allowCustom:true},
  {key:"time",       title:"TIME",         ko:"ÏãúÍ∞Ñ",     data:times,              hint:"C√¢nd?", allowCustom:true},
  {key:"place",      title:"PLACE",        ko:"Ïû•ÏÜå",     data:places,             hint:"Unde?", allowCustom:true},
  {key:"mod",        title:"MOD",          ko:"Î∞©Î≤ï",     data:mods,               hint:"Cum?", allowCustom:true},
  {key:"object",     title:"OBJECT",       ko:"Î™©Ï†ÅÏñ¥",   data:objects,            hint:"Ce?", allowCustom:true},
  {key:"objectAdj",  title:"ADJ (OBJECT)", ko:"ÌòïÏö©ÏÇ¨",   data:objectAdjectives,   hint:"Cum este obiectul?", allowCustom:true},
  {key:"numeral",    title:"NUMERAL",      ko:"",         data:numerals,           hint:"NumƒÉr", allowCustom:true},
  {key:"counter",    title:"COUNTER",      ko:"ÏàòÎüâÏÇ¨",   data:counters,           hint:"Clasificator", allowCustom:true},
  {key:"verb",       title:"VERB",         ko:"ÎèôÏÇ¨",     data:verbs,              hint:"Ac»õiune", allowCustom:true},
  {key:"conjug",     title:"CONJUGƒÇRI",    ko:"",         data:conjugations,       hint:"FormƒÉ verbalƒÉ", allowCustom:true}
];

const maxLen = Math.max(...columns.map(c => (c.data?.length || 0)));

/* =========================
   4) DOM (id-uri dacƒÉ existƒÉ)
   ========================= */
const DOM = {
  tableP1: $("#tableP1"),
  tableP2: $("#tableP2"),
  titleP2: $("#titleP2"),
  enableP2: $("#enableP2"),

  togglesP1: $("#togglesP1"),
  togglesP2: $("#togglesP2"),

  prevBtn: $("#prevBtn"),
  nextBtn: $("#nextBtn"),
  resetBtn: $("#resetBtn"),
  pageInfoEl: $("#pageInfo"),

  previewKo: $("#previewKo"),
  previewRo: $("#previewRo"),
  naturalHint: $("#naturalHint"),
  toggleRoBtn: $("#toggleRoBtn"),

  randomBtn: $("#randomBtn"),
  speakBtn: $("#speakBtn"),
  favBtn: $("#favBtn"),
  favoritesListEl: $("#favoritesList"),

  overlay: $("#overlay"),
  panelTitle: $("#panelTitle"),
  panelSub: $("#panelSub"),
  panelList: $("#panelList"),
  extraClauses: $("#extra-clauses"),
  closePanelBtn: $("#closePanelBtn"),
  panelSearchInput: $("#panelSearchInput"),
  newWordInput: $("#newWordInput"),
  newWordTransInput: $("#newWordTransInput"),
  addWordBtn: $("#addWordBtn"),

  roInput: $("#roInput"),
  roTranslateBtn: $("#roTranslateBtn"),
  roToKoResult: $("#roToKoResult"),
  roCorrected: $("#roCorrected"),

  inputLangRadio: $$('input[name="inputLang"]'),

  modeButtons: $$(".small-mode-btn"),
  refreshBtn: $("#refreshBtn"),
  homeBtn: $("#homeBtn")
};
if(DOM.closePanelBtn){
  DOM.closePanelBtn.addEventListener("click", ()=>{
    closePanel();
  });
}

if(DOM.overlay){
  DOM.overlay.addEventListener("click", (e)=>{
    if(e.target === DOM.overlay){
      closePanel();
    }
  });
}
     /* =========================
   5) APP STATE (1..N)
   ========================= */
let indexModelRow = 0;

function createEmptySentence(){
  const s = {};
  // pƒÉstrƒÉm cheile clasice (pentru render / parser)
  columns.forEach(col => { s[col.key] = col.data?.[0] || ""; });

  // multi arrays pentru adjectives (»ôi pentru eventual viitor)
  s.subjectAdjs = [];
  s.objectAdjs  = [];

  return s;
}

function createAllActive(){
  const a = {};
  columns.forEach(col => a[col.key] = true);
  return a;
}

let sentences = [ createEmptySentence() ];
let actives   = [ createAllActive() ];

let showRo = true;
let currentMode = "topik";
const simpleColumnsSet = {subject:true,time:true,object:true,verb:true,conjug:true};

function isColumnVisible(key){
  if(currentMode === "topik") return true;
  return !!simpleColumnsSet[key];
}

/* =========================
   6) LINKING CONJUGATIONS
   ========================= */
const linkingConjugations = new Set([
  "-Í≥†","-Í≥† ÎÇòÏÑú","-Í∏∞ Ï†ÑÏóê","-(Ïúº)Î©¥ÏÑú","-(Ïúº)Î©∞",
  "-(Ïúº)ÎÇò","-(Ïúº)ÎØÄÎ°ú","-(Ïúº)„Ñ¥/Îäî ÎßåÌÅº",
  "-(Ïúº)„ÑπÏàòÎ°ù","-(Ïúº)„Ñ¥/ÎäîÎç∞ÎèÑ","-(Ïúº)„ÑπÏßÄÎùºÎèÑ",
  "-(Ïúº)„Ñ¥/Îäî Î∞òÎ©¥Ïóê","-ÎèÑÎ°ù ÌïòÎã§","-Í∏∞Ïóê","-Í∏∏Îûò","-Í≥† ÎßêÎã§","-Í≥†Ïûê ÌïòÎã§"
]);
const isLinkingConj = (v) => linkingConjugations.has(v);

function ensureClauseCount(n){
  while(sentences.length < n){
    sentences.push(createEmptySentence());
    actives.push(createAllActive());
  }
}

function trimClausesTo(n){
  if(n < 1) n = 1;
  sentences = sentences.slice(0, n);
  actives   = actives.slice(0, n);
}

/* dacƒÉ o propozi»õie are conjugare de linking -> trebuie sƒÉ existe urmƒÉtoarea */
function handleLinkingAt(index){
  const s = sentences[index];
  if(!s) return;

  const cj = s.conjug || "";
  if(isLinkingConj(cj)){
    ensureClauseCount(index + 2);
  }
  // dacƒÉ nu e linking, NU »ôtergem agresiv (pentru cƒÉ tu lucrezi cu N)
  // dar putem curƒÉ»õa o propozi»õie goalƒÉ imediat urmƒÉtoare dacƒÉ a fost auto-creatƒÉ
  if(!isLinkingConj(cj) && index < sentences.length - 1){
    const next = sentences[index + 1];
    if(next){
      const keys = Object.keys(next);
      const empty = keys.every(k => {
        const v = next[k];
        if(Array.isArray(v)) return v.length === 0;
        return (v === "" || v === null || typeof v === "undefined");
      });
      // dacƒÉ next e complet goalƒÉ »ôi a fost doar ‚Äûplaceholder‚Äù, o putem elimina
      // dar numai dacƒÉ nu existƒÉ alt linking anterior care o cere
      const prevNeeds = isLinkingConj(s.conjug || "");
      if(empty && !prevNeeds){
        // pƒÉstrƒÉm minim 1 propozi»õie
        if(sentences.length > 1) {
          sentences.splice(index+1, 1);
          actives.splice(index+1, 1);
        }
      }
    }
  }
}

function enforceFinalNotLinking(){
  // ultima propozi»õie nu trebuie sƒÉ rƒÉm√¢nƒÉ linking
  const last = sentences[sentences.length - 1];
  if(last && isLinkingConj(last.conjug || "")){
    last.conjug = "-ÏïÑÏöî/Ïñ¥Ïöî";
  }
}

function enforceNoDoubleLinking(){
  // linking dupƒÉ linking => anulƒÉm pe al doilea
  for(let i=1;i<sentences.length;i++){
    const prev = sentences[i-1]?.conjug || "";
    const cur  = sentences[i]?.conjug || "";
    if(isLinkingConj(prev) && isLinkingConj(cur)){
      sentences[i].conjug = "";
    }
  }
}
 /* =========================
   LONG PRESS (iOS SAFE) + CLICK
   - delegare pe container (nu pe fiecare .col)
   - bind o singurƒÉ datƒÉ per container (nu se dubleazƒÉ la re-render)
   - long-press -> openPanel()
   - tap/click -> cycleColumnValue()
   ========================= */

const _boundPressContainers = new WeakSet();
/* =========================
   LONG PRESS + CLICK (SAFE)
   ========================= */
function attachPressHandlers(container, clauseIndex){
  if(!container) return;

  // üî¥ PREVENIM ata»ôarea multiplƒÉ
  if(container.dataset.handlersAttached === "true") return;
  container.dataset.handlersAttached = "true";

  let pressTimer = null;
  let moved = false;

  container.addEventListener("touchstart", (e)=>{
    moved = false;
    pressTimer = setTimeout(()=>{
      const col = e.target.closest(".col");
      if(col){
        openPanel(clauseIndex, col.dataset.key);
      }
    }, 500);
  }, { passive:true });

  container.addEventListener("touchmove", ()=>{
    moved = true;
    clearTimeout(pressTimer);
  }, { passive:true });

  container.addEventListener("touchend", (e)=>{
    if(!moved){
      const col = e.target.closest(".col");
      if(col){
        cycleColumnValue(clauseIndex, col.dataset.key);
      }
    }
    clearTimeout(pressTimer);
  });

  container.addEventListener("click", (e)=>{
    const col = e.target.closest(".col");
    if(col){
      cycleColumnValue(clauseIndex, col.dataset.key);
    }
  });
}
     /* =========================
   7) HANGUL HELPERS (batchim, conjugare)
   ========================= */
const H_BASE = 0xAC00;
const JONG = ["","„Ñ±","„Ñ≤","„Ñ≥","„Ñ¥","„Ñµ","„Ñ∂","„Ñ∑","„Ñπ","„Ñ∫","„Ñª","„Ñº","„ÑΩ","„Ñæ","„Ñø","„ÖÄ",
              "„ÖÅ","„ÖÇ","„ÖÑ","„ÖÖ","„ÖÜ","„Öá","„Öà","„Öä","„Öã","„Öå","„Öç","„Öé"];
const JUNG = ["„Öè","„Öê","„Öë","„Öí","„Öì","„Öî","„Öï","„Öñ","„Öó","„Öò","„Öô","„Öö","„Öõ",
              "„Öú","„Öù","„Öû","„Öü","„Ö†","„Ö°","„Ö¢","„Ö£"];

function decomposeLastSyl(word){
  if(!word) return null;
  const ch = word.charCodeAt(word.length-1);
  const code = ch - H_BASE;
  if(code < 0 || code > 11171) return null;
  const jong = code % 28;
  const jung = ((code - jong)/28) % 21;
  const cho = Math.floor((code - jong)/28/21);
  return { cho, jung, jong, prefix: word.slice(0,-1) };
}
function hasBatchim(s){
  const d = decomposeLastSyl(s);
  return d ? d.jong !== 0 : false;
}
function getVerbStem(dict){
  if(!dict) return "";
  return dict.endsWith("Îã§") ? dict.slice(0,-1) : dict;
}

const specialVerbMap = {
  "Í∞ÄÎã§":{present:"Í∞ÄÏöî",past:"Í∞îÏñ¥Ïöî"},
  "Ïò§Îã§":{present:"ÏôÄÏöî",past:"ÏôîÏñ¥Ïöî"},
  "Î≥¥Îã§":{present:"Î¥êÏöî",past:"Î¥§Ïñ¥Ïöî"},
  "ÌïòÎã§":{present:"Ìï¥Ïöî",past:"ÌñàÏñ¥Ïöî"},
  "Î®πÎã§":{past:"Î®πÏóàÏñ¥Ïöî"},
  "ÏùΩÎã§":{past:"ÏùΩÏóàÏñ¥Ïöî"},
  "ÎßàÏãúÎã§":{past:"ÎßàÏÖ®Ïñ¥Ïöî"},
  "ÏÇ¥Îã§":{past:"ÏÇ¥ÏïòÏñ¥Ïöî"}
};

function presentPolite(dict){
  if(specialVerbMap[dict]?.present) return specialVerbMap[dict].present;
  if(dict === "ÌïòÎã§") return "Ìï¥Ïöî";
  const stem = getVerbStem(dict);
  const d = decomposeLastSyl(stem);
  if(!d) return stem + "Ïöî";
  const v = JUNG[d.jung];
  const aGroup = ["„Öè","„Öë","„Öó","„Öõ","„Öò","„Öô","„Öö"].includes(v);
  if(stem.length === 1 && aGroup) return stem + "Ïöî";
  return stem + (aGroup ? "ÏïÑÏöî" : "Ïñ¥Ïöî");
}
function pastPolite(dict){
  if(specialVerbMap[dict]?.past) return specialVerbMap[dict].past;
  if(dict === "ÌïòÎã§") return "ÌñàÏñ¥Ïöî";
  const stem = getVerbStem(dict);
  const d = decomposeLastSyl(stem);
  if(!d) return stem + "ÏóàÏñ¥Ïöî";
  const v = JUNG[d.jung];
  const aGroup = ["„Öè","„Öë","„Öó","„Öõ","„Öò","„Öô","„Öö"].includes(v);
  return stem + (aGroup ? "ÏïòÏñ¥Ïöî" : "ÏóàÏñ¥Ïöî");
}
function stemPlusAeo(dict){
  if(dict === "ÌïòÎã§") return "Ìï¥";
  const stem = getVerbStem(dict);
  const d = decomposeLastSyl(stem);
  if(!d) return stem;
  const v = JUNG[d.jung];
  const aGroup = ["„Öè","„Öë","„Öó","„Öõ","„Öò","„Öô","„Öö"].includes(v);
  if(stem.length === 1 && aGroup) return stem;
  return stem + (aGroup ? "ÏïÑ" : "Ïñ¥");
}
function futureL(dict){
  const stem = getVerbStem(dict);
  const d = decomposeLastSyl(stem);
  if(!d) return stem + "·ÜØ";
  if(d.jong === 0){
    const newCode = H_BASE + d.cho*21*28 + d.jung*28 + 8; // „Ñπ Î∞õÏπ®
    return d.prefix + String.fromCharCode(newCode);
  }
  return stem + "ÏùÑ";
}

function buildVerbPhrase(dictVerb, cj) {
  if(!dictVerb && !cj) return "";
  if(!dictVerb) return cj || "";
  if(!cj) return dictVerb;

  const stem = getVerbStem(dictVerb);

  if(cj === "-ÏïÑÏöî/Ïñ¥Ïöî") return presentPolite(dictVerb);
  if(cj === "-ÏïòÏñ¥Ïöî/ÏóàÏñ¥Ïöî") return pastPolite(dictVerb);

  if(cj === "-(Ïúº)„Ñπ Í±∞ÏòàÏöî") return futureL(dictVerb) + " Í±∞ÏòàÏöî";
  if(cj === "-(Ïúº)„ÑπÍ≤åÏöî")    return futureL(dictVerb) + "Í≤åÏöî";
  if(cj === "-(Ïúº)„ÑπÎûòÏöî?")   return futureL(dictVerb) + "ÎûòÏöî?";
  if(cj === "-(Ïúº)„ÑπÍπåÏöî?")   return futureL(dictVerb) + "ÍπåÏöî?";

  if(cj === "-(Ïúº)„Ñπ Ïàò ÏûàÏñ¥Ïöî") return futureL(dictVerb) + " Ïàò ÏûàÏñ¥Ïöî";
  if(cj === "-(Ïúº)„Ñπ Ïàò ÏóÜÏñ¥Ïöî") return futureL(dictVerb) + " Ïàò ÏóÜÏñ¥Ïöî";

  if(cj === "-Í≥† ÏûàÏñ¥Ïöî") return stem + "Í≥† ÏûàÏñ¥Ïöî";
  if(cj === "-Í≥† Ïã∂Ïñ¥Ïöî") return stem + "Í≥† Ïã∂Ïñ¥Ïöî";
  if(cj === "-ÏßÄ ÎßàÏÑ∏Ïöî") return stem + "ÏßÄ ÎßàÏÑ∏Ïöî";
  if(cj === "-ÏïÑ/Ïñ¥ Ï£ºÏÑ∏Ïöî") return stemPlusAeo(dictVerb) + " Ï£ºÏÑ∏Ïöî";
  if(cj === "-ÏïÑ/Ïñ¥Ïïº ÎèºÏöî") return stemPlusAeo(dictVerb) + "Ïïº ÎèºÏöî";
  if(cj === "-ÏïÑ/Ïñ¥ÎèÑ ÎèºÏöî") return stemPlusAeo(dictVerb) + "ÎèÑ ÎèºÏöî";
  if(cj === "-(Ïúº)ÏÑ∏Ïöî") return futureL(dictVerb) + "ÏÑ∏Ïöî";
  if(cj === "-(Ïúº)„ÑπÏßÄÎèÑ Î™∞ÎùºÏöî") return futureL(dictVerb) + "ÏßÄÎèÑ Î™∞ÎùºÏöî";
  if(cj === "-Îäî Ï§ëÏù¥ÏóêÏöî") return stem + "Îäî Ï§ëÏù¥ÏóêÏöî";

  if(isLinkingConj(cj)){
    if(cj === "-Í≥†") return stem + "Í≥†";
    if(cj === "-Í≥† ÎÇòÏÑú") return stem + "Í≥† ÎÇòÏÑú";
    if(cj === "-Í∏∞ Ï†ÑÏóê") return stem + "Í∏∞ Ï†ÑÏóê";
    if(cj.includes("Î©¥ÏÑú")) return stem + "Î©¥ÏÑú";
    if(cj.includes("Î©∞")) return stem + "Î©∞";
    if(cj === "-ÎèÑÎ°ù ÌïòÎã§") return stem + "ÎèÑÎ°ù Ìï¥Ïöî";
    if(cj === "-Í≥† ÎßêÎã§") return stem + "Í≥† ÎßêÏïòÏñ¥Ïöî";
    if(cj === "-Í≥†Ïûê ÌïòÎã§") return stem + "Í≥†Ïûê Ìï¥Ïöî";
    if(cj === "-Í∏∞Ïóê") return stem + "Í∏∞Ïóê";
    if(cj === "-Í∏∏Îûò") return stem + "Í∏∏Îûò";
  }

  return dictVerb;
}

/* =========================
   8) PARTICLE HELPERS
   ========================= */
const pronouns = new Set(["Ï†Ä","ÎÇò","ÎÑà","Ïö∞Î¶¨","ÎÑàÌù¨"]);
const timeAdverbsNoParticle = new Set(["Ïò§Îäò","Ïñ¥Ï†ú","ÎÇ¥Ïùº","ÏßÄÍ∏à","Î∞©Í∏à","ÏöîÏ¶ò","Ìï≠ÏÉÅ","ÏûêÏ£º","Í∞ÄÎÅî","Í≥ÑÏÜç","Ï†êÏ†ê","Ï∞®Ï∏∞"]);

function addSubjectWithParticle(subjectValue){
  if (!subjectValue) return "";

  // ARRAY SUBJECT
  if (Array.isArray(subjectValue)) {
    // simplu »ôi stabil: AÏôÄ BÎäî / AÏôÄ BÍ∞Ä (alegem 'Ïù¥'/'Í∞Ä' pe final generic)
    const joined = subjectValue.join("Í≥º ");
    return joined + (hasBatchim(joined) ? "Ïù¥" : "Í∞Ä");
  }

  const b = hasBatchim(subjectValue);
  if (pronouns.has(subjectValue)) {
    return subjectValue + (b ? "ÏùÄ" : "Îäî");
  }
  return subjectValue + (b ? "Ïù¥" : "Í∞Ä");
}

function addPlaceWithParticle(word, verbKo){
  if(!word) return "";
  const motionVerbs = new Set(["Í∞ÄÎã§","Ïò§Îã§","ÎÇòÍ∞ÄÎã§","Îì§Ïñ¥Í∞ÄÎã§","ÎèåÏïÑÍ∞ÄÎã§","ÎèåÏïÑÏò§Îã§"]);
  if(verbKo && motionVerbs.has(verbKo)) return word + "Ïóê";
  return word + "ÏóêÏÑú";
}

function addObjectWithParticle(word){
  if(!word) return "";
  return word + (hasBatchim(word) ? "ÏùÑ" : "Î•º");
}

/* =========================
   9) BUILD ONE CLAUSE (KO)
   ========================= */
function buildClauseSentence(state, activeMap, clauseIndex){
  const koParts = [];
  const v  = state.verb || "";
  const cj = state.conjug || "";

  const use = (key) => activeMap?.[key] !== false && isColumnVisible(key);

  // SUBJECT (doar la propozi»õia 1, sau dacƒÉ e explicit setat)
  if(clauseIndex === 0 && use("subject") && state.subject){
    let subjectWord = state.subject;

    // adjectives multiple
    if(Array.isArray(state.subjectAdjs) && state.subjectAdjs.length){
      if(Array.isArray(subjectWord)) {
        // ex: [Ï†Ä, Ïö∞Î¶¨] ‚Äî rare; lƒÉsƒÉm direct
        subjectWord = subjectWord;
      } else {
        subjectWord = state.subjectAdjs.join(" ") + " " + subjectWord;
      }
    }
    koParts.push(addSubjectWithParticle(subjectWord));
  }

  // TIME (nu punem particulƒÉ; ai avut a»ôa)
  if(use("time") && state.time) koParts.push(state.time);

  // PLACE
  if(use("place") && state.place) koParts.push(addPlaceWithParticle(state.place, v));

  // MOD
  if(use("mod") && state.mod) koParts.push(state.mod);

  // OBJECT (+ optional numeral/counter)
  if(use("object") && state.object){
    let objectWord = state.object;

    if(Array.isArray(state.objectAdjs) && state.objectAdjs.length){
      objectWord = state.objectAdjs.join(" ") + " " + objectWord;
    }

    if(use("numeral") && state.numeral){
      koParts.push(state.numeral);
      if(use("counter") && state.counter) koParts.push(state.counter);
    }
    koParts.push(addObjectWithParticle(objectWord));
  }

  // VERB
  if(use("verb") || use("conjug")){
    const vp = buildVerbPhrase(v, cj);
    if(vp) koParts.push(vp);
  }

  return koParts.join(" ").replace(/\s+/g," ").trim();
}

/* =========================
   10) NATURAL ROMANIAN (minimal stabil)
   ========================= */
const RO_FORMS = {
  "a merge":   { "1sg":"merg","2sg":"mergi","3sg":"merge","1pl":"mergem","2pl":"merge»õi","3pl":"merg" },
  "a veni":    { "1sg":"vin","2sg":"vii","3sg":"vine","1pl":"venim","2pl":"veni»õi","3pl":"vin" },
  "a m√¢nca":   { "1sg":"mƒÉn√¢nc","2sg":"mƒÉn√¢nci","3sg":"mƒÉn√¢ncƒÉ","1pl":"m√¢ncƒÉm","2pl":"m√¢nca»õi","3pl":"mƒÉn√¢ncƒÉ" },
  "a bea":     { "1sg":"beau","2sg":"bei","3sg":"bea","1pl":"bem","2pl":"be»õi","3pl":"beau" },
  "a citi":    { "1sg":"citesc","2sg":"cite»ôti","3sg":"cite»ôte","1pl":"citim","2pl":"citi»õi","3pl":"citesc" },
  "a scrie":   { "1sg":"scriu","2sg":"scrii","3sg":"scrie","1pl":"scriem","2pl":"scrie»õi","3pl":"scriu" },
  "a merge pe jos": {
    "1sg":"merg pe jos","2sg":"mergi pe jos","3sg":"merge pe jos",
    "1pl":"mergem pe jos","2pl":"merge»õi pe jos","3pl":"merg pe jos"
  }
};
function stripInfinitive(roVerb){ return (roVerb || "").replace(/^\s*a\s+/i, "").trim(); }
function roPersonFromSubjectKo(subjKo){
  if(subjKo==="Ï†Ä"||subjKo==="ÎÇò") return "1sg";
  if(subjKo==="ÎÑà") return "2sg";
  if(subjKo==="Ïö∞Î¶¨") return "1pl";
  if(subjKo==="ÎÑàÌù¨") return "2pl";
  return "3sg";
}
function roAgreeVerb(roVerbInf, subjKo){
  const inf = (roVerbInf || "").trim().toLowerCase();
  const person = roPersonFromSubjectKo(subjKo);
  const forms = RO_FORMS[inf];
  if(forms && forms[person]) return forms[person];
  return stripInfinitive(roVerbInf);
}
function buildRoVerbPhrase(roVerbInf, cj, subjKo){
  const v = roAgreeVerb(roVerbInf, subjKo);
  if(!cj) return v;

  const map = {
    "-ÏïÑÏöî/Ïñ¥Ïöî":         vv => `${vv}`,
    "-ÏïòÏñ¥Ïöî/ÏóàÏñ¥Ïöî":     vv => `${vv} (√Æn trecut)`,
    "-Í≥† ÏûàÏñ¥Ïöî":         vv => `${vv} acum`,
    "-Í≥† Ïã∂Ïñ¥Ïöî":         vv => `vreau sƒÉ ${vv}`,
    "-(Ïúº)„Ñπ Í±∞ÏòàÏöî":      vv => `voi ${vv}`,
    "-ÏßÄ ÎßàÏÑ∏Ïöî":         vv => `nu ${vv}, te rog`,
    "-ÏïÑ/Ïñ¥Ïïº ÎèºÏöî":       vv => `trebuie sƒÉ ${vv}`,
    "-(Ïúº)„Ñπ Ïàò ÏûàÏñ¥Ïöî":   vv => `pot sƒÉ ${vv}`,
    "-(Ïúº)„Ñπ Ïàò ÏóÜÏñ¥Ïöî":   vv => `nu pot sƒÉ ${vv}`,
    "-Í∏∞ Ï†ÑÏóê":           vv => `√Ænainte sƒÉ ${vv}`,
    "-Í≥† ÎÇòÏÑú":           vv => `dupƒÉ ce ${vv}`,
    "-(Ïúº)Î©¥ÏÑú":           vv => `√Æn timp ce ${vv}`,
    "-(Ïúº)„ÑπÍπåÏöî?":        vv => `sƒÉ ${vv}?`,
    "-Í≥†":                vv => `${vv} »ôi`
  };
  const fn = map[cj];
  if(fn) return fn(v || "(verbul)");
  const cjExp = translations.conjug?.[cj] || cj;
  return (v ? v + " " : "") + `(${cjExp})`;
}

function buildNaturalRomanian(state, activeMap, clauseIndex){
  const use = (key) => activeMap?.[key] !== false && isColumnVisible(key) && state[key];

  const getRo = (catKey, raw) => translations[catKey]?.[raw] || raw || "";

  const timeRo   = use("time")   ? getRo("time", state.time)   : "";
  const subjRo   = (clauseIndex===0 && use("subject")) ? getRo("subject", state.subject) : "";
  const placeRo  = use("place")  ? getRo("place", state.place) : "";
  const modRo    = use("mod")    ? getRo("mod", state.mod)     : "";
  const objRo    = use("object") ? getRo("object", state.object) : "";
  const numRo    = use("numeral") ? (state.numeral || "") : "";

  let objPhrase = "";
  if(objRo){
    const arr = [];
    if(numRo) arr.push(numRo);
    arr.push(objRo);
    objPhrase = arr.join(" ");
  }

  const verbKo   = state.verb || "";
  const verbRoInf = translations.verb?.[verbKo] || verbKo || "";
  const conjUsed = (activeMap?.conjug !== false && isColumnVisible("conjug")) ? (state.conjug || "") : "";
  const verbPhrase = (activeMap?.verb !== false && isColumnVisible("verb")) ? buildRoVerbPhrase(verbRoInf, conjUsed, state.subject) : "";

  const parts = [];
  if(timeRo) parts.push(timeRo);
  if(subjRo) parts.push(subjRo);
  if(placeRo) parts.push(placeRo);
  if(modRo) parts.push(modRo);
  if(objPhrase) parts.push(objPhrase);
  if(verbPhrase) parts.push(verbPhrase);

  if(!parts.length) return "";
  let sentence = parts.join(" ").replace(/\s+/g," ").trim();
  sentence = sentence.charAt(0).toUpperCase() + sentence.slice(1);

  // punctua»õie: dacƒÉ e linking, scoatem punctul mai t√¢rziu
  if(!/[.!?]$/.test(sentence)) sentence += ".";
  sentence = sentence.replace(/\.\s+\./g,".");
  return sentence;
}

/* =========================
   11) RENDER TABLES (P1, P2, + extra)
   ========================= */
function renderClauseRow(container, activeMap, state, clauseIndex){
  if(!container) return;
  container.innerHTML = "";

  columns.forEach(col=>{
    if(!isColumnVisible(col.key)) return;

    const colDiv = document.createElement("div");
    colDiv.className = "col";
    colDiv.dataset.key = col.key;
    colDiv.dataset.clauseIndex = String(clauseIndex);

    if(activeMap?.[col.key] === false) colDiv.classList.add("dimmed");

    const header = document.createElement("div");
    header.className = "col-header";

    const titleSpan = document.createElement("span");
    titleSpan.textContent = col.title + (col.ko ? ` (${col.ko})` : "");
    header.appendChild(titleSpan);

    const toggle = document.createElement("input");
    toggle.type = "checkbox";
    toggle.className = "col-toggle";
    toggle.checked = activeMap?.[col.key] !== false;
    toggle.addEventListener("change", ()=>{
      if(!actives[clauseIndex]) actives[clauseIndex] = createAllActive();
      actives[clauseIndex][col.key] = toggle.checked;
      renderAll();
    });
    header.appendChild(toggle);

    colDiv.appendChild(header);

    const label = document.createElement("div");
    label.className = "col-body-label";
    label.textContent = col.hint || "";
    colDiv.appendChild(label);

    const main = document.createElement("div");
    main.className = "col-body-main";

    if(col.key === "subjectAdj"){
      main.textContent = (state.subjectAdjs || []).join(" ") || "";
    } else if(col.key === "objectAdj"){
      main.textContent = (state.objectAdjs || []).join(" ") || "";
    } else {
      main.textContent = state[col.key] || "";
    }
    colDiv.appendChild(main);

    const extra = document.createElement("div");
    extra.className = "col-body-extra";
    if(col.key === "conjug" && state[col.key] && isLinkingConj(state[col.key])){
      extra.textContent = "‚≠ê cere propozi»õia urmƒÉtoare";
    }
    colDiv.appendChild(extra);

    container.appendChild(colDiv);
  });
}

function renderAll(){
  if(!DOM.tableP1) return;

  // housekeeping linking rules
  enforceNoDoubleLinking();
  enforceFinalNotLinking();

  // clear containers
  DOM.tableP1.innerHTML = "";
  if(DOM.tableP2) DOM.tableP2.innerHTML = "";
  if(DOM.extraClauses) DOM.extraClauses.innerHTML = "";

  // show/hide P2 wrapper depending on existence + sentence count
  if(DOM.tableP2){
    if(sentences.length >= 2) show(DOM.tableP2);
    else hide(DOM.tableP2);
  }
  if(DOM.titleP2){
    if(sentences.length >= 2) show(DOM.titleP2);
    else hide(DOM.titleP2);
  }
  if(DOM.enableP2){
    // reflect state; user toggling handled elsewhere
    DOM.enableP2.checked = (sentences.length >= 2);
  }

  for(let i=0;i<sentences.length;i++){
    let container = null;

    if(i === 0){
      container = DOM.tableP1;
    } else if(i === 1 && DOM.tableP2){
      container = DOM.tableP2;
    } else {
      if(!DOM.extraClauses) continue;

      const block = document.createElement("div");
      block.className = "table-block";

      const title = document.createElement("div");
      title.className = "table-title";
      title.textContent = `Propozi»õia ${i+1}`;

      const table = document.createElement("div");
      table.className = "table-horizontal";

      block.appendChild(title);
      block.appendChild(table);
      DOM.extraClauses.appendChild(block);

      container = table;
    }

    renderClauseRow(container, actives[i], sentences[i], i);
    attachPressHandlers(container, i);
  }

  updateModelNav();
  createToggleChips(); // chips reflectƒÉ actives + clauses
  updatePreview();
  renderFavorites();
}

/* =========================
   12) PREVIEW FULL (KO + RO)
   ========================= */
function buildFullKorean(){
  const parts = [];
  for(let i=0;i<sentences.length;i++){
    const s = sentences[i];
    if(!s) continue;
    const ko = buildClauseSentence(s, actives[i], i);
    if(ko) parts.push(ko);
  }
  return parts.join(" ").replace(/\s+/g," ").trim();
}

function buildFullRomanian(){
  const parts = [];
  for(let i=0;i<sentences.length;i++){
    const s = sentences[i];
    if(!s) continue;

    let ro = buildNaturalRomanian(s, actives[i], i);
    if(!ro) continue;

    // dacƒÉ e linking, scoatem punctul intermediar
    if(isLinkingConj(s.conjug || "")){
      ro = ro.replace(/[.]$/, "");
    }
    parts.push(ro);
  }

  let full = parts.join(" ").replace(/\s+/g," ").trim();
  full = full.replace(/»ôi\s+»ôi/gi, "»ôi");

  // asigurƒÉ punct final
  if(full && !/[.!?]$/.test(full)) full += ".";
  return full;
}

function updatePreview(){
  if(!DOM.previewKo) return;

  const fullKo = buildFullKorean();
  const fullRo = buildFullRomanian();

  DOM.previewKo.textContent = fullKo || "(alege cuvinte din tabel)";
  if(DOM.previewRo){
    DOM.previewRo.textContent = showRo ? (fullRo || "") : "";
  }

  // op»õional: »õinem roInput sincron
  if(DOM.roInput && showRo){
    DOM.roInput.value = fullRo || "";
  }
}

/* =========================
   13) MODEL ROW NAV
   ========================= */
function loadModelRow(i){
  const s = sentences[0] || createEmptySentence();
  // doar coloanele "clasice" (nu bƒÉgƒÉm arrays aici)
  columns.forEach(col => {
    if(col.key === "subjectAdj"){
      // model row: setƒÉm 1 adj ca default √Æn array (nu string)
      const w = col.data?.[i] || "";
      s.subjectAdjs = w ? [w] : [];
      s[col.key] = ""; // »õinem string gol
      return;
    }
    if(col.key === "objectAdj"){
      const w = col.data?.[i] || "";
      s.objectAdjs = w ? [w] : [];
      s[col.key] = "";
      return;
    }
    s[col.key] = col.data?.[i] || "";
  });
  sentences[0] = s;
  handleLinkingAt(0);
}

function updateModelNav(){
  if(DOM.pageInfoEl) DOM.pageInfoEl.textContent = `R√¢nd model: ${indexModelRow+1} / ${Math.max(1, maxLen)}`;
  if(DOM.prevBtn) DOM.prevBtn.disabled = (indexModelRow === 0);
  if(DOM.nextBtn) DOM.nextBtn.disabled = (indexModelRow >= maxLen-1);
}
/* =========================
   14) CHIPS (togglesP1/togglesP2)
   ========================= */
function createToggleChips(){
  if(!DOM.togglesP1 && !DOM.togglesP2) return;

  const buildFor = (wrapper, clauseIndex) => {
    if(!wrapper) return;
    wrapper.innerHTML = "";

    if(!actives[clauseIndex]) return;

    columns.forEach(col=>{
      if(!isColumnVisible(col.key)) return;

      const chip = document.createElement("label");
      chip.className = "chip";

      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = actives[clauseIndex]?.[col.key] !== false;
      cb.dataset.key = col.key;
      cb.dataset.clauseIndex = String(clauseIndex);

      chip.appendChild(cb);
      chip.append(col.title);

      chip.classList.toggle("chip-off", !cb.checked);

      cb.addEventListener("change", ()=>{
        const idx = Number(cb.dataset.clauseIndex);
        const key = cb.dataset.key;

        if(!actives[idx]) actives[idx] = createAllActive();
        actives[idx][key] = cb.checked;

        chip.classList.toggle("chip-off", !cb.checked);
        renderAll();
      });

      wrapper.appendChild(chip);
    });
  };

  buildFor(DOM.togglesP1, 0);
  buildFor(DOM.togglesP2, 1);
}
     

function openPanel(clauseIndex, key){
  panelClauseIndex = clauseIndex;
  panelKey = key;

  const col = columns.find(c => c.key === key);
  if(!col) return;

  if(DOM.panelTitle) DOM.panelTitle.textContent = `Propozi»õia ${clauseIndex + 1} ‚Äì ${col.title}`;
  if(DOM.panelSub) DOM.panelSub.textContent = col.hint || "";

  if(DOM.panelSearchInput) DOM.panelSearchInput.value = "";
  if(DOM.newWordInput) DOM.newWordInput.value = "";
  if(DOM.newWordTransInput) DOM.newWordTransInput.value = "";

  renderPanelList(col);

  // IMPORTANT: overlay poate fi null dacƒÉ lipse»ôte √Æn HTML
  if(DOM.overlay){
    DOM.overlay.classList.remove("hidden");
  }
}
function closePanel(){
  if(DOM.overlay){
    DOM.overlay.classList.add("hidden");
  }
  document.body.style.overflow = "";
}
     function renderPanelList(col){
  if(!DOM.panelList) return;

  DOM.panelList.innerHTML = "";

  const key = col.key;
  const map = translations[key] || {};
  const filter = (DOM.panelSearchInput?.value || "").trim().toLowerCase();

  const words = (col.data || []).filter(w=>{
    if(!w) return false;
    if(!filter) return true;
    return String(w).toLowerCase().includes(filter);
  });

  if(!words.length){
    const empty = document.createElement("div");
    empty.className = "panel-item";
    empty.textContent = "Nu existƒÉ cuvinte pentru filtrul introdus.";
    DOM.panelList.appendChild(empty);
    return;
  }

  words.forEach(word=>{
    const item = document.createElement("div");
    item.className = "panel-item";

    const main = document.createElement("div");
    main.className = "panel-item-main";
    main.textContent = word;
    item.appendChild(main);

    const extra = document.createElement("div");
    extra.className = "panel-item-extra";

    const ro = map[word];
    if(ro){
      const tag = document.createElement("div");
      tag.className = "panel-item-tag";
      tag.textContent = ro;
      extra.appendChild(tag);
    }

    if(key === "conjug" && isLinkingConj(word)){
      const star = document.createElement("div");
      star.className = "panel-item-tag";
      star.textContent = "‚≠ê linking";
      extra.appendChild(star);
    }

    item.appendChild(extra);

    // CLICK -> select (single)
    item.addEventListener("click", ()=>{
      if(!sentences[panelClauseIndex]){
        ensureClauseCount(panelClauseIndex + 1);
      }

      // ‚úÖ adjective columns sunt multi-array, nu string
      if(key === "subjectAdj"){
        const arr = sentences[panelClauseIndex].subjectAdjs || [];
        if(!arr.includes(word)) arr.push(word);
        sentences[panelClauseIndex].subjectAdjs = arr;
      } else if(key === "objectAdj"){
        const arr = sentences[panelClauseIndex].objectAdjs || [];
        if(!arr.includes(word)) arr.push(word);
        sentences[panelClauseIndex].objectAdjs = arr;
      } else if(key === "subject"){
        sentences[panelClauseIndex][key] = word;
      } else {
        sentences[panelClauseIndex][key] = word;
      }

      // linking -> asigurƒÉ propozi»õie urmƒÉtoare
      if(key === "conjug"){
        handleLinkingAt(panelClauseIndex);
        enforceNoDoubleLinking();
        enforceFinalNotLinking();
      }

      if(DOM.overlay) DOM.overlay.classList.add("hidden");
      renderAll();
    });

    DOM.panelList.appendChild(item);
  });
}
     
     /* =========================
   16) APPLY WORD TO STATE
   ========================= */

function applyWordToState(clauseIndex, key, word){
  if(!sentences[clauseIndex]) return;

  const s = sentences[clauseIndex];

  if(key === "subjectAdj"){
    if(!Array.isArray(s.subjectAdjs)) s.subjectAdjs = [];
    if(word){
      if(!s.subjectAdjs.includes(word)) s.subjectAdjs.push(word);
    }
  }
  else if(key === "objectAdj"){
    if(!Array.isArray(s.objectAdjs)) s.objectAdjs = [];
    if(word){
      if(!s.objectAdjs.includes(word)) s.objectAdjs.push(word);
    }
  }
  else{
    s[key] = word;
  }

  if(key === "conjug"){
    handleLinkingAt(clauseIndex);
  }

  renderAll();
}
/* =========================
   CYCLE COLUMN VALUE (tap scurt)
   ========================= */

function cycleColumnValue(clauseIndex, key){
  if(!sentences[clauseIndex]) return;

  const col = columns.find(c => c.key === key);
  if(!col || !Array.isArray(col.data)) return;

  const list = col.data;
  if(!list.length) return;

  const state = sentences[clauseIndex];

  // ADJECTIVE COLUMNS (multi-select arrays)
  if(key === "subjectAdj"){
    const current = state.subjectAdjs?.[0] || "";
    const idx = list.indexOf(current);
    const next = list[(idx + 1) % list.length];
    state.subjectAdjs = next ? [next] : [];
  }
  else if(key === "objectAdj"){
    const current = state.objectAdjs?.[0] || "";
    const idx = list.indexOf(current);
    const next = list[(idx + 1) % list.length];
    state.objectAdjs = next ? [next] : [];
  }
  else{
    const current = state[key] || "";
    const idx = list.indexOf(current);
    const next = list[(idx + 1) % list.length];
    state[key] = next;
  }

  if(key === "conjug"){
    handleLinkingAt(clauseIndex);
  }

  renderAll();
}
     /* =========================
   17) RO ‚Üí STATE PARSER (simplu, stabil)
   ========================= */

function translateRoToKo(roText){
  if(!roText) return;

  // reset complet
  sentences = [ createEmptySentence() ];
  actives   = [ createAllActive() ];

  const text = roText.toLowerCase();

  const s = sentences[0];

  // detect verb
  Object.entries(translations.verb).forEach(([ko, ro])=>{
    if(text.includes(ro.replace("a ",""))){
      s.verb = ko;
    }
  });

  // detect obiect
  Object.entries(translations.object).forEach(([ko, ro])=>{
    if(text.includes(ro)){
      s.object = ko;
    }
  });

  // detect time
  Object.entries(translations.time).forEach(([ko, ro])=>{
    if(text.includes(ro)){
      s.time = ko;
    }
  });

  renderAll();
}

/* =========================
   18) BUTTON EVENTS
   ========================= */

on(DOM.roTranslateBtn, "click", ()=>{
  const roText = DOM.roInput?.value || "";
  translateRoToKo(roText);

  if(DOM.roInput){
    DOM.roInput.value = buildFullRomanian();
  }
});

on(DOM.prevBtn, "click", ()=>{
  if(indexModelRow > 0){
    indexModelRow--;
    loadModelRow(indexModelRow);
    renderAll();
  }
});

on(DOM.nextBtn, "click", ()=>{
  if(indexModelRow < maxLen-1){
    indexModelRow++;
    loadModelRow(indexModelRow);
    renderAll();
  }
});

on(DOM.resetBtn, "click", ()=>{
  sentences = [ createEmptySentence() ];
  actives   = [ createAllActive() ];
  renderAll();
});

on(DOM.randomBtn, "click", ()=>{
  const rand = Math.floor(Math.random()*maxLen);
  indexModelRow = rand;
  loadModelRow(rand);
  renderAll();
});

on(DOM.speakBtn, "click", ()=>{
  const text = buildFullKorean();
  if(!text) return;
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = "ko-KR";
  speechSynthesis.speak(utter);
});

/* =========================
   19) FAVORITES
   ========================= */

let favorites = [];

function renderFavorites(){
  if(!DOM.favoritesListEl) return;
  DOM.favoritesListEl.innerHTML = "";
  favorites.forEach(f=>{
    const el = document.createElement("div");
    el.className = "fav-item";
    el.textContent = f;
    DOM.favoritesListEl.appendChild(el);
  });
}
/* =========================
   TOP BUTTONS (SAVE / HOME / REFRESH)
   ========================= */

on(DOM.favBtn, "click", ()=>{
  const full = buildFullKorean();
  if(!full) return;

  if(!favorites.includes(full)){
    favorites.push(full);
    renderFavorites();
  }
});

on(DOM.refreshBtn, "click", ()=>{
  // regenereazƒÉ preview fƒÉrƒÉ a reseta propozi»õiile
  renderAll();
});

on(DOM.homeBtn, "click", ()=>{
  // reset total arhitecturƒÉ 1..N
  sentences = [ createEmptySentence() ];
  actives   = [ createAllActive() ];
  indexModelRow = 0;
  loadModelRow(0);
  renderAll();
});

/* =========================
   20) INIT
   ========================= */

function init(){
  loadModelRow(0);
  renderAll();
}

document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html> 
