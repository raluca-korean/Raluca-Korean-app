<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Raluca Korean – Sentence Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:#f4f6fb;
  color:#2f343b;
}

.app{
  max-width:1100px;
  margin:0 auto;
  padding:20px 16px 80px;
}

h1{
  margin:0 0 10px;
  font-size:22px;
  font-weight:900;
}

.section-title{
  margin:24px 0 8px;
  font-size:13px;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#556;
}

/* ===== CLAUSE BLOCK ===== */

.clause-block{
  background:#ffffff;
  border-radius:18px;
  padding:12px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.clause-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  font-weight:900;
  color:#666;
  margin-bottom:6px;
}

.table{
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding-bottom:4px;
}

/* ===== COLUMN ===== */

.col{
  flex:0 0 auto;
  min-width:120px;
  max-width:150px;
  background:#faf8f4;
  border-radius:14px;
  padding:8px;
  border:1px solid #e3dccf;
}

.col-header{
  font-size:10px;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#7b5dff;
  border-bottom:1px solid #ddd;
  padding-bottom:3px;
  margin-bottom:4px;
}

.col-hint{
  font-size:10px;
  color:#999;
  margin-bottom:2px;
}

.cell{
  font-size:15px;
  font-weight:900;
  min-height:1.4em;
}

.cell[contenteditable]{
  outline:none;
  cursor:text;
}

.cell:focus{
  box-shadow:0 0 0 2px rgba(123,93,255,.35);
  border-radius:6px;
}

/* ===== PREVIEW ===== */

.preview{
  margin-top:20px;
  background:#fff;
  border-radius:18px;
  padding:14px;
  box-shadow:0 14px 30px rgba(0,0,0,.1);
}

.preview-title{
  font-size:12px;
  font-weight:900;
  color:#555;
  margin-bottom:6px;
}

.preview-ko{
  font-size:22px;
  font-weight:900;
  line-height:1.5;
}

</style>
</head>

<body>
<div class="app">

<h1>Raluca Korean – Builder</h1>

<div class="section-title">Builder (multi-clause)</div>

<!-- ===================== -->
<!-- CLAUSE 1 -->
<!-- ===================== -->
<section class="clause-block" data-clause="0">

  <div class="clause-header">
    <span>Propoziția 1</span>
    <span>VERB infinitiv + CONJ</span>
  </div>

  <div class="table">

    <div class="col" data-key="subject">
      <div class="col-header">Subject</div>
      <div class="col-hint">eu / tu / noi</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="time">
      <div class="col-header">Time</div>
      <div class="col-hint">azi / mâine</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="place">
      <div class="col-header">Place</div>
      <div class="col-hint">loc (bază)</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="mod">
      <div class="col-header">Mod</div>
      <div class="col-hint">bine / încet</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="object">
      <div class="col-header">Object</div>
      <div class="col-hint">ce?</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="numeral">
      <div class="col-header">Numeral</div>
      <div class="col-hint">un / doi</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="counter">
      <div class="col-header">Counter</div>
      <div class="col-hint">권 / 개</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="verb">
      <div class="col-header">Verb</div>
      <div class="col-hint">infinitiv (…다)</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="conj">
      <div class="col-header">Conj</div>
      <div class="col-hint">-고 / -지만</div>
      <div class="cell" contenteditable></div>
    </div>

  </div>
</section>

<!-- ===================== -->
<!-- CLAUSE 2 -->
<!-- ===================== -->
<section class="clause-block" data-clause="1">

  <div class="clause-header">
    <span>Propoziția 2</span>
    <span>continuare</span>
  </div>

  <div class="table">

    <div class="col" data-key="subject">
      <div class="col-header">Subject</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="time">
      <div class="col-header">Time</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="place">
      <div class="col-header">Place</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="mod">
      <div class="col-header">Mod</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="object">
      <div class="col-header">Object</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="numeral">
      <div class="col-header">Numeral</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="counter">
      <div class="col-header">Counter</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="verb">
      <div class="col-header">Verb</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="conj">
      <div class="col-header">Conj</div>
      <div class="cell" contenteditable></div>
    </div>

  </div>
</section>

<!-- ===== PREVIEW ===== -->

<div class="preview">
  <div class="preview-title">Propoziția finală</div>
  <label style="display:flex;align-items:center;gap:6px;">
  <input type="checkbox" id="topicToggle" checked />
  <span>은/는 (topic)</span>
</label>
  <div class="preview-ko" id="previewSentence">저 가요</div>
</div>

</div>
</body>
  <script>
(function () {
  "use strict";

  /* =========================
     UTILS
  ========================= */
  function lastChar(s){ return s ? s[s.length-1] : ""; }
  function hasBatchim(ch){
    const c = ch.charCodeAt(0);
    return c>=0xAC00 && c<=0xD7A3 && ((c-0xAC00)%28)!==0;
  }

  /* =========================
     PARTICLES
  ========================= */
  function subjParticle(n, topic){
    const b = hasBatchim(lastChar(n));
    if(topic) return b ? n+"은" : n+"는";
    return b ? n+"이" : n+"가";
  }

  function objParticle(n){
    return hasBatchim(lastChar(n)) ? n+"을" : n+"를";
  }

  function placeParticle(place, verb){
    if(!place) return "";
    if(["가다","오다","있다","없다"].includes(verb)) return place+"에";
    return place+"에서";
  }

  /* =========================
     PLURAL 들 (INTELIGENT)
  ========================= */
  function maybePlural(noun, numeral, counter){
    if(!noun) return "";
    if(counter) return noun; // coreean natural
    if(["물","커피","음식"].includes(noun)) return noun;
    if(numeral && numeral!=="한") return noun+"들";
    return noun;
  }

  /* =========================
     ENDINGS
  ========================= */
  function attachEnding(v,e){
    if(!v||!e||!v.endsWith("다")) return v;
    const s=v.slice(0,-1);
    const b=hasBatchim(lastChar(s));
    if(e==="-(으)면") return s+(b?"으면":"면");
    if(e==="-(으)ㄹ 때") return s+(b?"을 때":"ㄹ 때");
    if(e==="-(으)려고") return s+(b?"으려고":"려고");
    if(e==="-고") return s+"고";
    if(e==="-지만") return s+"지만";
    if(e==="-어서") return s+"어서";
    return s+e;
  }

  function polite(v){
    if(!v.endsWith("다")) return v;
    return v.slice(0,-1)+"요";
  }

  /* =========================
     UI HELPERS
  ========================= */
  const host=document.getElementById("clausesHost");
  function cell(i,k){
    return document.querySelector(`#t${i} .col[data-k="${k}"] .col-body-main`);
  }

  function highlight(){
    [...host.children].forEach((c,i)=>{
      c.style.outline="none";
      if(i===host.children.length-1)
        c.style.outline="3px solid rgba(123,93,255,.6)";
      else
        c.style.outline="2px dashed rgba(123,93,255,.35)";
    });
  }

  /* =========================
     BUILD CLAUSE
  ========================= */
  function buildClause(i,last){
    const s=cell(i,"subject")?.textContent.trim();
    const t=cell(i,"time")?.textContent.trim();
    const p=cell(i,"place")?.textContent.trim();
    const o=cell(i,"object")?.textContent.trim();
    const n=cell(i,"numeral")?.textContent.trim();
    const c=cell(i,"counter")?.textContent.trim();
    const v=cell(i,"verb")?.textContent.trim();
    const e=cell(i,"conj")?.textContent.trim();

    const topic = i>0 || (e && e.includes("지만"));
    const subj = s ? subjParticle(s,topic) : "";

    const noun = maybePlural(o,n,c);
    const obj = noun ? objParticle(
      c?`${noun} ${n} ${c}`:noun
    ) : "";

    let verbOut = attachEnding(v,e);
    if(last && !e && document.getElementById("politeToggle")?.checked)
      verbOut = polite(v);

    return [
      subj,
      t,
      placeParticle(p,v),
      obj,
      verbOut
    ].filter(Boolean).join(" ");
  }

  /* =========================
     PREVIEW
  ========================= */
  function rebuild(){
    const out=[];
    for(let i=0;i<host.children.length;i++){
      const c=buildClause(i,i===host.children.length-1);
      if(c) out.push(c);
    }
    document.getElementById("previewSentence").textContent =
      out.join(" ") || "저 가요";
    highlight();
  }

  /* =========================
     INIT
  ========================= */
  function init(){
    document.addEventListener("input",rebuild);
    rebuild();
  }

  window.addEventListener("DOMContentLoaded",init);
})();
</script>  
</body>
</html>
