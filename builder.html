<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Raluca Korean – Sentence Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:#f4f6fb;
  color:#2f343b;
}

.app{
  max-width:1100px;
  margin:0 auto;
  padding:20px 16px 80px;
}

h1{
  margin:0 0 10px;
  font-size:22px;
  font-weight:900;
}

.section-title{
  margin:24px 0 8px;
  font-size:13px;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#556;
}

/* ===== CLAUSE BLOCK ===== */

.clause-block{
  background:#ffffff;
  border-radius:18px;
  padding:12px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.clause-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  font-weight:900;
  color:#666;
  margin-bottom:6px;
}

.table{
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding-bottom:4px;
}

/* ===== COLUMN ===== */

.col{
  flex:0 0 auto;
  min-width:120px;
  max-width:150px;
  background:#faf8f4;
  border-radius:14px;
  padding:8px;
  border:1px solid #e3dccf;
}

.col-header{
  font-size:10px;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#7b5dff;
  border-bottom:1px solid #ddd;
  padding-bottom:3px;
  margin-bottom:4px;
}

.col-hint{
  font-size:10px;
  color:#999;
  margin-bottom:2px;
}

.cell{
  font-size:15px;
  font-weight:900;
  min-height:1.4em;
}

.cell[contenteditable]{
  outline:none;
  cursor:text;
}

.cell:focus{
  box-shadow:0 0 0 2px rgba(123,93,255,.35);
  border-radius:6px;
}

/* ===== PREVIEW ===== */

.preview{
  margin-top:20px;
  background:#fff;
  border-radius:18px;
  padding:14px;
  box-shadow:0 14px 30px rgba(0,0,0,.1);
}

.preview-title{
  font-size:12px;
  font-weight:900;
  color:#555;
  margin-bottom:6px;
}

.preview-ko{
  font-size:22px;
  font-weight:900;
  line-height:1.5;
}

</style>
</head>

<body>
<div class="app">

<h1>Raluca Korean – Builder</h1>

<div class="section-title">Builder (multi-clause)</div>

<!-- ===================== -->
<!-- CLAUSE 1 -->
<!-- ===================== -->
<section class="clause-block" data-clause="0">

  <div class="clause-header">
    <span>Propoziția 1</span>
    <span>VERB infinitiv + CONJ</span>
  </div>

  <div class="table">

    <div class="col" data-key="subject">
      <div class="col-header">Subject</div>
      <div class="col-hint">eu / tu / noi</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="time">
      <div class="col-header">Time</div>
      <div class="col-hint">azi / mâine</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="place">
      <div class="col-header">Place</div>
      <div class="col-hint">loc (bază)</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="mod">
      <div class="col-header">Mod</div>
      <div class="col-hint">bine / încet</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="object">
      <div class="col-header">Object</div>
      <div class="col-hint">ce?</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="numeral">
      <div class="col-header">Numeral</div>
      <div class="col-hint">un / doi</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="counter">
      <div class="col-header">Counter</div>
      <div class="col-hint">권 / 개</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="verb">
      <div class="col-header">Verb</div>
      <div class="col-hint">infinitiv (…다)</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="conj">
      <div class="col-header">Conj</div>
      <div class="col-hint">-고 / -지만</div>
      <div class="cell" contenteditable></div>
    </div>

  </div>
</section>

<!-- ===================== -->
<!-- CLAUSE 2 -->
<!-- ===================== -->
<section class="clause-block" data-clause="1">

  <div class="clause-header">
    <span>Propoziția 2</span>
    <span>continuare</span>
  </div>

  <div class="table">

    <div class="col" data-key="subject">
      <div class="col-header">Subject</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="time">
      <div class="col-header">Time</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="place">
      <div class="col-header">Place</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="mod">
      <div class="col-header">Mod</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="object">
      <div class="col-header">Object</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="numeral">
      <div class="col-header">Numeral</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="counter">
      <div class="col-header">Counter</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="verb">
      <div class="col-header">Verb</div>
      <div class="cell" contenteditable></div>
    </div>

    <div class="col" data-key="conj">
      <div class="col-header">Conj</div>
      <div class="cell" contenteditable></div>
    </div>

  </div>
</section>

<!-- ===== PREVIEW ===== -->

<div class="preview">
  <div class="preview-title">Propoziția finală</div>
  <div class="preview-ko" id="previewSentence">저 가요</div>
</div>

</div>
</body>

<script>
let clausesHost=document.getElementById("clauses");

function hasBatchim(ch){
  const c=ch.charCodeAt(ch.length-1);
  if(c<0xAC00||c>0xD7A3)return false;
  return (c-0xAC00)%28!==0;
}

function particleSubject(n){
  return hasBatchim(n)?"이":"가";
}
function particleObject(n){
  return hasBatchim(n)?"을":"를";
}

function placeParticle(p,v){
  return (v==="가다"||v==="오다")?"에":"에서";
}

function polite(v){
  if(!v.endsWith("다"))return v;
  const s=v.slice(0,-1);
  const last=s[s.length-1];
  if(last==="하")return s.slice(0,-1)+"해요";
  const code=last.charCodeAt(0)-0xAC00;
  const jung=Math.floor((code%(21*28))/28);
  return s+([0,2,8,9].includes(jung)?"아요":"어요");
}

function attach(v,e){
  if(!e||!v.endsWith("다"))return v;
  const s=v.slice(0,-1);
  if(e==="-(으)면")return s+(hasBatchim(s[s.length-1])?"으면":"면");
  if(e==="-(으)ㄹ 때")return s+(hasBatchim(s[s.length-1])?"을 때":"ㄹ 때");
  if(e==="-(으)려고")return s+(hasBatchim(s[s.length-1])?"으려고":"려고");
  if(e==="고")return s+"고";
  if(e==="지만")return s+"지만";
  if(e==="어서")return s+"어서";
  return s+e;
}

function addClause(){
  const idx=clausesHost.children.length+1;
  const div=document.createElement("div");
  div.className="table-block";
  div.innerHTML=`
  <div class="table-title">Propoziția ${idx}</div>
  <div class="table">
    ${col("subject","SUBJECT","저")}
    ${col("time","TIME","오늘")}
    ${col("place","PLACE","집")}
    ${col("mod","MOD","잘")}
    ${col("object","OBJECT","책")}
    ${col("numeral","NUM","한")}
    ${col("counter","COUNT","권")}
    ${col("verb","VERB","가다")}
    ${col("conj","CONJ","-고")}
  </div>`;
  clausesHost.appendChild(div);
  rebuild();
}

function col(k,l,ex){
  return `
  <div class="col" data-key="${k}">
    <h4>${l}</h4>
    <small>ex: ${ex}</small>
    <div contenteditable></div>
  </div>`;
}

function rebuild(){
  const rows=[...clausesHost.children];
  let out=[];
  rows.forEach((r,i)=>{
    const get=k=>r.querySelector(`[data-key="${k}"] div[contenteditable]`).innerText.trim();
    let s=get("subject");
    let t=get("time");
    let p=get("place");
    let m=get("mod");
    let o=get("object");
    let n=get("numeral");
    let c=get("counter");
    let v=get("verb");
    let cj=get("conj");

    if(s)s+=particleSubject(s);
    if(o)o+=particleObject(o);
    if(p)p+=placeParticle(p,v);
    if(o&&n&&c)o=`${n} ${c} ${o}`;

    let verb=attach(v,cj);
    if(i===rows.length-1)verb=polite(v);

    out.push([s,t,p,m,o,verb].filter(Boolean).join(" "));
  });
  document.getElementById("output").innerText=out.join(" ");
}

document.addEventListener("input",rebuild);
addClause();
</script>
</body>
</html>
