<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>Raluca Korean — Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg1:#dff3ff;
  --bg2:#ffe9ff;
  --bg3:#f4fffc;
  --bg4:#e8f0ff;
  --accent:#7b5dff;
  --card:#ffffffcc;
  --border:#e2d7c8;
  --text:#2f343b;
  --muted:#7a8088;
}
*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(120deg,var(--bg1),var(--bg2),var(--bg3),var(--bg4));
  background-size:400% 400%;
  animation:bg 25s ease infinite;
  color:var(--text);
}
@keyframes bg{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

.app{
  max-width:1100px;
  margin:0 auto;
  padding:18px 14px 120px;
}

header{
  padding:16px;
  border-radius:26px;
  background:linear-gradient(120deg,#6fb8ff,#a774ff,#ff7fd1);
  color:#fff;
  box-shadow:0 18px 45px rgba(0,0,0,.25);
}
header h1{
  margin:0;
  font-size:20px;
  font-weight:900;
  letter-spacing:.08em;
}
header .sub{
  font-size:12px;
  opacity:.95;
}

.card{
  margin-top:18px;
  padding:16px 18px;
  border-radius:22px;
  background:var(--card);
  border:1px solid rgba(255,255,255,.7);
  box-shadow:0 18px 40px rgba(0,0,0,.12);
}

.section-title{
  margin:20px 0 8px;
  font-size:13px;
  font-weight:900;
  letter-spacing:.1em;
  color:#4b607d;
  text-transform:uppercase;
}

/* TABLE */
.table-block{
  margin-top:14px;
  padding:12px;
  border-radius:22px;
  background:var(--card);
  border:1px solid rgba(255,255,255,.7);
  box-shadow:0 14px 32px rgba(0,0,0,.1);
}

.table-title{
  font-size:12px;
  font-weight:900;
  color:var(--muted);
  margin-bottom:6px;
}

.table-horizontal{
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding-bottom:6px;
}

.col{
  min-width:110px;
  flex:0 0 auto;
  padding:8px;
  border-radius:16px;
  background:radial-gradient(circle at top left,#fdfbf7,#f2ebde);
  border:1px solid var(--border);
  box-shadow:0 10px 22px rgba(0,0,0,.12);
}

.col-header{
  font-size:10px;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:#7b5dff;
  border-bottom:1px solid rgba(208,196,255,.8);
  margin-bottom:4px;
}

.col-main{
  font-size:15px;
  font-weight:900;
  min-height:1.4em;
}
.col-main[contenteditable]{
  outline:none;
  cursor:text;
}

.col-hint{
  font-size:10px;
  color:#9c8f7c;
  margin-top:2px;
}

/* PREVIEW */
.preview{
  margin-top:20px;
  padding:16px;
  border-radius:22px;
  background:var(--card);
  border:1px solid rgba(255,255,255,.7);
  box-shadow:0 18px 36px rgba(0,0,0,.12);
}
.preview-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  font-weight:900;
  color:#4b607d;
}
.preview-sentence{
  margin-top:8px;
  font-size:24px;
  font-weight:900;
  line-height:1.6;
}

/* BUTTONS */
.controls{
  margin-top:14px;
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}
button{
  border:none;
  border-radius:999px;
  padding:8px 18px;
  font-size:12px;
  font-weight:900;
  color:#fff;
  cursor:pointer;
  background:linear-gradient(135deg,#6b8cff,#9b6bff);
  box-shadow:0 10px 22px rgba(0,0,0,.25);
}
button.secondary{
  background:linear-gradient(135deg,#ff9a6c,#ff5f8c);
}
</style>
</head>

<body>
<div class="app">

<header>
  <h1>RALUCA KOREAN</h1>
  <div class="sub">Builder • propoziții multiple • conj lipit corect</div>
</header>

<div class="controls">
  <button onclick="addClause()">➕ Propoziție</button>
  <button onclick="removeClause()" class="secondary">➖ Șterge ultima</button>
</div>

<h3 class="section-title">Builder</h3>
<div id="builderHost"></div>

<div class="preview">
  <div class="preview-head">
    <span>Propoziția finală</span>
    <label>
      <input type="checkbox" id="politeToggle">
      politețe (ultima propoziție)
    </label>
  </div>
  <div id="previewSentence" class="preview-sentence">저 가요</div>
</div>

</div>

<script>
/* =========================
   BUILDER LOGIC
========================= */
const host = document.getElementById("builderHost");
const preview = document.getElementById("previewSentence");
let clauseCount = 0;

/* UTIL */
function hasBatchim(ch){
  const c = ch.charCodeAt(0);
  if(c < 0xAC00 || c > 0xD7A3) return false;
  return ((c - 0xAC00) % 28) !== 0;
}
function lastHangul(s){
  return s[s.length-1];
}

/* CLAUSE TEMPLATE */
function clauseHTML(i){
  return `
  <section class="table-block" data-index="${i}">
    <div class="table-title">Propoziția ${i+1}</div>
    <div class="table-horizontal">
      ${col("subject","SUBJECT","저")}
      ${col("time","TIME","오늘")}
      ${col("place","PLACE","집")}
      ${col("mod","MOD","잘")}
      ${col("object","OBJECT","책")}
      ${col("verb","VERB","가다")}
      ${col("conj","CONJ","-고 / -지만")}
    </div>
  </section>`;
}
function col(key,title,ex){
  return `
  <div class="col" data-key="${key}">
    <div class="col-header">${title}</div>
    <div class="col-main" contenteditable="true"></div>
    <div class="col-hint">${ex}</div>
  </div>`;
}

/* ADD / REMOVE */
function addClause(){
  host.insertAdjacentHTML("beforeend", clauseHTML(clauseCount));
  clauseCount++;
  rebuild();
}
function removeClause(){
  if(clauseCount<=1) return;
  host.lastElementChild.remove();
  clauseCount--;
  rebuild();
}

/* CORE BUILD */
function toPolite(v){
  if(!v.endsWith("다")) return v;
  if(v==="하다") return "해요";
  const stem=v.slice(0,-1);
  const last=lastHangul(stem);
  const jong=hasBatchim(last);
  const a=[0,2,8,9].includes(Math.floor(((last.charCodeAt(0)-0xAC00)%588)/28));
  return stem+(a?"아요":"어요");
}

function attachEnding(verb,conj){
  if(!verb.endsWith("다")) return verb;
  if(!conj) return verb;
  const stem=verb.slice(0,-1);
  if(conj==="-(으)면") return stem+(hasBatchim(lastHangul(stem))?"으면":"면");
  if(conj==="-(으)ㄹ 때") return stem+(hasBatchim(lastHangul(stem))?"을 때":"ㄹ 때");
  if(conj==="-고") return stem+"고";
  if(conj==="-지만") return stem+"지만";
  if(conj==="-아서"||conj==="-어서") return stem+conj.replace("-","");
  return stem+conj.replace("-","");
}

function placeParticle(place,verb){
  if(!place) return "";
  if(verb==="가다"||verb==="오다") return place+"에";
  return place+"에서";
}

function rebuild(){
  const polite=document.getElementById("politeToggle").checked;
  const parts=[];
  [...host.children].forEach((block,i)=>{
    const get=k=>block.querySelector(`[data-key="${k}"] .col-main`).textContent.trim();
    let verb=get("verb");
    const conj=get("conj");
    const place=placeParticle(get("place"),verb);
    let verbOut=attachEnding(verb,conj);
    if(polite && i===clauseCount-1 && !conj) verbOut=toPolite(verb);
    const chunk=[
      get("subject"),
      get("time"),
      place,
      get("mod"),
      get("object"),
      verbOut
    ].filter(Boolean).join(" ");
    if(chunk) parts.push(chunk);
  });
  preview.textContent=parts.join(" ")||"저 가요";
}

/* EVENTS */
document.addEventListener("input",e=>{
  if(e.target.classList.contains("col-main")) rebuild();
});
document.getElementById("politeToggle").addEventListener("change",rebuild);

/* INIT */
addClause();
document.querySelector('[data-key="subject"] .col-main').textContent="저";
document.querySelector('[data-key="verb"] .col-main').textContent="가다";
rebuild();
</script>
</body>
</html>
