<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Raluca Korean – Builder FINAL</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(120deg,#e8f0ff,#ffe9f7,#eafff6);
  color:#2f343b;
}
.app{max-width:1100px;margin:auto;padding:18px 14px 80px}

.header{
  padding:18px;
  border-radius:26px;
  background:linear-gradient(120deg,#6fb8ff,#a774ff,#ff7fd1);
  color:#fff;
  font-weight:900;
  font-size:20px;
  box-shadow:0 18px 40px rgba(0,0,0,.25);
}

.section-title{
  margin:20px 0 6px;
  font-size:13px;
  font-weight:900;
  letter-spacing:.08em;
  color:#4b607d;
  text-transform:uppercase;
}

.table-block{
  background:#ffffffcc;
  border-radius:22px;
  padding:12px;
  margin-bottom:14px;
  box-shadow:0 16px 30px rgba(0,0,0,.15);
}

.table-title{
  font-size:12px;
  font-weight:800;
  color:#6a6f77;
  margin-bottom:6px;
}

.table{
  display:flex;
  gap:8px;
  overflow-x:auto;
}

.col{
  min-width:120px;
  background:#fdfbf7;
  border-radius:16px;
  padding:6px 8px 8px;
  border:1px solid #e1d7c7;
}

.col h4{
  margin:0 0 2px;
  font-size:10px;
  letter-spacing:.08em;
  color:#7b5dff;
}

.col small{
  font-size:10px;
  color:#9a8f7d;
}

.col div[contenteditable]{
  margin-top:2px;
  font-size:15px;
  font-weight:900;
  outline:none;
  min-height:1.4em;
}

.preview{
  background:#ffffffcc;
  border-radius:22px;
  padding:14px;
  box-shadow:0 16px 30px rgba(0,0,0,.15);
}

.preview h3{
  margin:0 0 6px;
  font-size:13px;
  font-weight:900;
  color:#4b607d;
}

#output{
  font-size:24px;
  font-weight:900;
  line-height:1.6;
}

button{
  margin-top:10px;
  border:none;
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  color:#fff;
  cursor:pointer;
  background:linear-gradient(135deg,#6b8cff,#9b6bff);
  box-shadow:0 10px 20px rgba(0,0,0,.25);
}
</style>
</head>

<body>
<div class="app">

<div class="header">RALUCA KOREAN — BUILDER FINAL</div>

<div class="section-title">Builder (propoziții)</div>
<div id="clauses"></div>

<button onclick="addClause()">+ Propoziție</button>

<div class="preview">
  <h3>Propoziția finală</h3>
  <div id="output">저는 가요</div>
</div>

</div>

<script>
let clausesHost=document.getElementById("clauses");

function hasBatchim(ch){
  const c=ch.charCodeAt(ch.length-1);
  if(c<0xAC00||c>0xD7A3)return false;
  return (c-0xAC00)%28!==0;
}

function particleSubject(n){
  return hasBatchim(n)?"이":"가";
}
function particleObject(n){
  return hasBatchim(n)?"을":"를";
}

function placeParticle(p,v){
  return (v==="가다"||v==="오다")?"에":"에서";
}

function polite(v){
  if(!v.endsWith("다"))return v;
  const s=v.slice(0,-1);
  const last=s[s.length-1];
  if(last==="하")return s.slice(0,-1)+"해요";
  const code=last.charCodeAt(0)-0xAC00;
  const jung=Math.floor((code%(21*28))/28);
  return s+([0,2,8,9].includes(jung)?"아요":"어요");
}

function attach(v,e){
  if(!e||!v.endsWith("다"))return v;
  const s=v.slice(0,-1);
  if(e==="-(으)면")return s+(hasBatchim(s[s.length-1])?"으면":"면");
  if(e==="-(으)ㄹ 때")return s+(hasBatchim(s[s.length-1])?"을 때":"ㄹ 때");
  if(e==="-(으)려고")return s+(hasBatchim(s[s.length-1])?"으려고":"려고");
  if(e==="고")return s+"고";
  if(e==="지만")return s+"지만";
  if(e==="어서")return s+"어서";
  return s+e;
}

function addClause(){
  const idx=clausesHost.children.length+1;
  const div=document.createElement("div");
  div.className="table-block";
  div.innerHTML=`
  <div class="table-title">Propoziția ${idx}</div>
  <div class="table">
    ${col("subject","SUBJECT","저")}
    ${col("time","TIME","오늘")}
    ${col("place","PLACE","집")}
    ${col("mod","MOD","잘")}
    ${col("object","OBJECT","책")}
    ${col("numeral","NUM","한")}
    ${col("counter","COUNT","권")}
    ${col("verb","VERB","가다")}
    ${col("conj","CONJ","-고")}
  </div>`;
  clausesHost.appendChild(div);
  rebuild();
}

function col(k,l,ex){
  return `
  <div class="col" data-key="${k}">
    <h4>${l}</h4>
    <small>ex: ${ex}</small>
    <div contenteditable></div>
  </div>`;
}

function rebuild(){
  const rows=[...clausesHost.children];
  let out=[];
  rows.forEach((r,i)=>{
    const get=k=>r.querySelector(`[data-key="${k}"] div[contenteditable]`).innerText.trim();
    let s=get("subject");
    let t=get("time");
    let p=get("place");
    let m=get("mod");
    let o=get("object");
    let n=get("numeral");
    let c=get("counter");
    let v=get("verb");
    let cj=get("conj");

    if(s)s+=particleSubject(s);
    if(o)o+=particleObject(o);
    if(p)p+=placeParticle(p,v);
    if(o&&n&&c)o=`${n} ${c} ${o}`;

    let verb=attach(v,cj);
    if(i===rows.length-1)verb=polite(v);

    out.push([s,t,p,m,o,verb].filter(Boolean).join(" "));
  });
  document.getElementById("output").innerText=out.join(" ");
}

document.addEventListener("input",rebuild);
addClause();
</script>
</body>
</html>
